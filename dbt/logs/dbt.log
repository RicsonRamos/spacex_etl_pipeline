[0m15:07:08.426208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ebe46600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ebbd1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ed35eff0>]}


============================== 15:07:08.499013 | dcb132a8-ae38-403c-9b3c-9209eb06d2b0 ==============================
[0m15:07:08.499013 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:07:08.500191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'empty': 'False', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m15:07:08.816584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ee190d40>]}
[0m15:07:08.937971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141eb3bed50>]}
[0m15:07:08.939652 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:07:09.095209 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:07:09.360153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:09.361088 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:07:09.361804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:09.412668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141eb1f7380>]}
[0m15:07:09.537279 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:07:09.544326 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:07:09.823319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141eb03db50>]}
[0m15:07:09.824225 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:07:09.827660 [info ] [MainThread]: 
[0m15:07:09.828448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:09.829143 [info ] [MainThread]: 
[0m15:07:09.830176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:09.837918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:09.839017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:09.850568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:09.929130 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:09.929789 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:09.930313 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:09.930951 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:09.932234 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:09.933163 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:09.934086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:09.935186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:09.936345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:09.961312 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:07:09.962015 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:07:09.962559 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.026 seconds
[0m15:07:09.964279 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:09.966719 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:09.968994 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:09.975625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:07:09.976639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:07:09.982661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:07:09.985789 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:07:09.988903 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:07:09.991433 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:07:09.992207 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:07:09.993005 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:07:09.993757 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:07:09.994577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:09.995283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:09.996010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:10.029389 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.034 seconds
[0m15:07:10.030145 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m15:07:10.030676 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.036 seconds
[0m15:07:10.032481 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:07:10.034753 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:07:10.037108 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:07:10.038627 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:07:10.039229 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:07:10.040042 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:07:10.059565 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:10.060622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:07:10.061472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:10.098413 [debug] [MainThread]: SQL status: SELECT 13 in 0.037 seconds
[0m15:07:10.101037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ea320a70>]}
[0m15:07:10.102034 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:10.103088 [debug] [MainThread]: On master: COMMIT
[0m15:07:10.103694 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:10.104289 [debug] [MainThread]: On master: COMMIT
[0m15:07:10.105271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:10.105851 [debug] [MainThread]: On master: Close
[0m15:07:10.112572 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:07:10.113280 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:07:10.113871 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:07:10.114711 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:07:10.115707 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:07:10.116738 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:07:10.117612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:07:10.118401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:07:10.119235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:07:10.120289 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:07:10.121042 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:07:10.121846 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:07:10.136180 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:07:10.132876 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:07:10.140125 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:07:10.147106 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:07:10.147921 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:07:10.154251 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:07:10.253946 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:07:10.254729 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:07:10.257101 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:07:10.264821 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:07:10.265635 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:10.266247 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:07:10.267086 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:10.267680 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:07:10.268537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:10.269380 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:07:10.270212 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:10.271556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:10.293571 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:07:10.294773 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:07:10.296087 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:07:10.311651 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:10.312482 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m15:07:10.313103 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m15:07:10.316140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e843f3e0>]}
[0m15:07:10.338801 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:10.344132 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:10.345654 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.20s]
[0m15:07:10.346875 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:07:10.347901 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:07:10.349407 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:07:10.357873 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:07:10.359101 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:07:10.352166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.364385 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:10.374394 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:10.375976 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:07:10.377337 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:07:10.380027 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:07:10.381700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.433751 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:07:10.434716 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:07:10.435458 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:10.436461 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:10.437563 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:07:10.440363 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:07:10.443715 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:10.449897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m15:07:10.454856 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:07:10.459840 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:07:10.469905 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:10.471356 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:10.472171 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:07:10.472994 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:07:10.481299 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:07:10.485254 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:07:10.485909 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m15:07:10.486925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e8fb3050>]}
[0m15:07:10.491393 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:07:10.492792 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.37s]
[0m15:07:10.493957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e846de80>]}
[0m15:07:10.494961 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:07:10.496209 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.38s]
[0m15:07:10.497960 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:07:10.498605 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:07:10.500128 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:07:10.501551 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:07:10.500926 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:07:10.502658 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:07:10.503513 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:07:10.504635 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:07:10.505424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:07:10.506286 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:07:10.507261 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:07:10.508201 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:07:10.509059 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:07:10.512987 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:07:10.516796 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:07:10.523154 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:07:10.533201 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:07:10.582212 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:07:10.587028 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:07:10.593615 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:10.594853 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:07:10.595665 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:10.596207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:10.597079 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:07:10.598311 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:10.625194 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.027 seconds
[0m15:07:10.625903 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.030 seconds
[0m15:07:10.635285 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:10.639257 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:10.640177 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:07:10.641051 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:07:10.642978 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.647358 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:10.648006 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:07:10.648564 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:07:10.653406 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:10.654889 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:07:10.655624 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.658015 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:07:10.658613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:07:10.659197 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:10.661326 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:07:10.662150 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:07:10.662987 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:10.664418 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:07:10.667954 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:07:10.674252 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m15:07:10.673942 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:07:10.677736 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:07:10.683353 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:10.684670 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:10.685516 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:07:10.686401 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:07:10.693031 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:07:10.695409 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:07:10.696682 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e8586690>]}
[0m15:07:10.697335 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:07:10.699458 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.19s]
[0m15:07:10.702064 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:07:10.703413 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:07:10.704680 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb132a8-ae38-403c-9b3c-9209eb06d2b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e8484170>]}
[0m15:07:10.707945 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.20s]
[0m15:07:10.709242 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:07:10.710998 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:07:10.711810 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:07:10.712615 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:07:10.713428 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:07:10.716195 [debug] [MainThread]: On master: COMMIT
[0m15:07:10.716955 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:10.717614 [debug] [MainThread]: On master: COMMIT
[0m15:07:10.718243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:10.731924 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:07:10.733042 [debug] [MainThread]: On master: Close
[0m15:07:10.733991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:10.734700 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:07:10.735346 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:07:10.736005 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:07:10.736599 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:07:10.737455 [info ] [MainThread]: 
[0m15:07:10.738161 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m15:07:10.740416 [debug] [MainThread]: Command end result
[0m15:07:10.786776 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:07:10.793454 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:07:10.807166 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:07:10.807918 [info ] [MainThread]: 
[0m15:07:10.808677 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:10.809366 [info ] [MainThread]: 
[0m15:07:10.810171 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:07:10.811032 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:10.811747 [info ] [MainThread]: 
[0m15:07:10.812491 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:10.813179 [info ] [MainThread]: 
[0m15:07:10.813880 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:07:10.815477 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.514707, "process_in_blocks": "0", "process_kernel_time": 0.762137, "process_mem_max_rss": "164136", "process_out_blocks": "0", "process_user_time": 6.943475}
[0m15:07:10.816549 [debug] [MainThread]: Command `dbt build` failed at 15:07:10.816400 after 2.52 seconds
[0m15:07:10.817287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ec942bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141ec6b9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7141e85fdd30>]}
[0m15:07:10.818028 [debug] [MainThread]: Flushing usage events
[0m15:07:11.432380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:37.908544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce651221dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64f11ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64f11fc80>]}


============================== 15:07:38.053682 | e3701538-3b58-4d5a-9fa8-9a36ba741634 ==============================
[0m15:07:38.053682 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:07:38.058620 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/app/dbt', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'no_print': 'None', 'use_colors': 'True'}
[0m15:07:38.453359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64de5b230>]}
[0m15:07:38.579250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64f054470>]}
[0m15:07:38.581598 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:07:38.743089 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:07:39.056019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:39.059655 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:07:39.060456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:39.112164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64dcec140>]}
[0m15:07:39.241914 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:07:39.253357 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:07:39.571171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64d07df10>]}
[0m15:07:39.572209 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:07:39.575884 [info ] [MainThread]: 
[0m15:07:39.576795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:39.577534 [info ] [MainThread]: 
[0m15:07:39.578654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:39.587773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:39.589048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:39.595298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:07:39.708962 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:39.709654 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:39.710231 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:07:39.710730 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:39.711537 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:39.712413 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:39.713186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:39.713876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:39.714588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:39.737095 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.024 seconds
[0m15:07:39.739784 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:39.740418 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.026 seconds
[0m15:07:39.742984 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:39.752363 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.038 seconds
[0m15:07:39.754912 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:07:39.758481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:07:39.759573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:07:39.765868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:07:39.770572 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:07:39.774039 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:07:39.777373 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:07:39.778230 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:07:39.779068 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:07:39.779915 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:07:39.780753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:39.781483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:39.782977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:39.818349 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m15:07:39.818998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.036 seconds
[0m15:07:39.820969 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:07:39.822874 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:07:39.823465 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.042 seconds
[0m15:07:39.824160 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:07:39.824796 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:07:39.826329 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:07:39.828777 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:07:39.840812 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:39.841778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:07:39.842508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:39.867614 [debug] [MainThread]: SQL status: SELECT 13 in 0.025 seconds
[0m15:07:39.870156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64d090d70>]}
[0m15:07:39.870954 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:39.871845 [debug] [MainThread]: On master: COMMIT
[0m15:07:39.872445 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:39.873005 [debug] [MainThread]: On master: COMMIT
[0m15:07:39.873885 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:39.874451 [debug] [MainThread]: On master: Close
[0m15:07:39.880846 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:07:39.883776 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:07:39.885787 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:07:39.886680 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:07:39.887922 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:07:39.888820 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:07:39.889678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:07:39.890455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:07:39.891232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:07:39.892714 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:07:39.893495 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:07:39.894215 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:07:39.905691 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:07:39.909209 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:07:39.914280 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:07:39.922405 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:07:39.928770 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:07:39.940309 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:07:40.076068 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:07:40.077663 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:07:40.079763 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:07:40.154618 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:40.157803 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:07:40.158657 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:40.160892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:40.162452 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:07:40.168854 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:07:40.171858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:40.174415 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:07:40.186818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:40.192772 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:07:40.219023 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m15:07:40.230108 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:07:40.232055 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:07:40.234536 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:40.239095 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:40.240848 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:07:40.241604 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:07:40.242605 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:07:40.246373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.255734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m15:07:40.261921 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:40.264059 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:40.277582 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:40.278417 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:07:40.281974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64f146120>]}
[0m15:07:40.282733 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:07:40.285559 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.39s]
[0m15:07:40.286758 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:07:40.289180 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.291373 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:07:40.336204 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:07:40.360019 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:07:40.361208 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:07:40.363203 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:40.364806 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:40.365932 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:07:40.367595 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:07:40.374316 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:07:40.382572 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m15:07:40.396519 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:07:40.400716 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:07:40.413254 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:07:40.414545 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:07:40.419292 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:07:40.421378 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:07:40.428796 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:07:40.429754 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:07:40.433555 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:07:40.437128 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:07:40.439523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64d0f5d00>]}
[0m15:07:40.440642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64af814c0>]}
[0m15:07:40.444092 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.55s]
[0m15:07:40.445384 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.55s]
[0m15:07:40.447032 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:07:40.448389 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:07:40.449840 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:07:40.454491 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:07:40.455316 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:07:40.456160 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:07:40.457170 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:07:40.458016 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:07:40.459283 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:07:40.460324 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:07:40.461391 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:07:40.462361 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:07:40.463483 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:07:40.464667 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:07:40.469567 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:07:40.475052 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:07:40.481700 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:07:40.493229 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:07:40.540525 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:07:40.537755 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:07:40.559207 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:40.560134 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:40.560806 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:07:40.561711 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:07:40.562547 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:40.563375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:40.596261 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.034 seconds
[0m15:07:40.609028 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:40.609662 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.046 seconds
[0m15:07:40.610245 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:07:40.614972 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:40.617261 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.617990 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:07:40.624824 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:40.626242 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:07:40.626881 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.628411 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.632820 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:40.636151 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:07:40.637421 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:07:40.638654 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:40.640018 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:07:40.640704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:40.643588 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:07:40.644284 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:07:40.644874 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:40.648635 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:07:40.649666 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:07:40.655301 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:07:40.656714 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:07:40.658013 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:40.664767 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:07:40.665509 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:07:40.666547 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:07:40.668980 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:07:40.669919 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:07:40.671185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64af0c8c0>]}
[0m15:07:40.675364 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.21s]
[0m15:07:40.676760 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:07:40.680253 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:07:40.682791 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:07:40.684036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3701538-3b58-4d5a-9fa8-9a36ba741634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64af1dee0>]}
[0m15:07:40.685310 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.22s]
[0m15:07:40.686603 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:07:40.688331 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:07:40.689304 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:07:40.690238 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:07:40.692735 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:07:40.699482 [debug] [MainThread]: On master: COMMIT
[0m15:07:40.711359 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:40.712165 [debug] [MainThread]: On master: COMMIT
[0m15:07:40.712777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:40.733466 [debug] [MainThread]: SQL status: COMMIT in 0.020 seconds
[0m15:07:40.736238 [debug] [MainThread]: On master: Close
[0m15:07:40.738194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:40.739947 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:07:40.741025 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:07:40.741817 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:07:40.742505 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:07:40.743461 [info ] [MainThread]: 
[0m15:07:40.744353 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:07:40.746868 [debug] [MainThread]: Command end result
[0m15:07:40.818768 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:07:40.827435 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:07:40.856131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:07:40.857051 [info ] [MainThread]: 
[0m15:07:40.858056 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:40.859189 [info ] [MainThread]: 
[0m15:07:40.860202 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:07:40.861082 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:40.861970 [info ] [MainThread]: 
[0m15:07:40.863500 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:07:40.864513 [info ] [MainThread]: 
[0m15:07:40.865701 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:07:40.869009 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.2220123, "process_in_blocks": "0", "process_kernel_time": 1.278145, "process_mem_max_rss": "163288", "process_out_blocks": "0", "process_user_time": 9.891549}
[0m15:07:40.870438 [debug] [MainThread]: Command `dbt build` failed at 15:07:40.870189 after 3.22 seconds
[0m15:07:40.874848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64e5c0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64af39eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce64af8e0f0>]}
[0m15:07:40.877112 [debug] [MainThread]: Flushing usage events
[0m15:07:41.524201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:11.969219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3bcde420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3e5877a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3bcdf080>]}


============================== 15:08:12.040385 | 7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5 ==============================
[0m15:08:12.040385 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:08:12.041474 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'use_colors': 'True'}
[0m15:08:12.379300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3b4840e0>]}
[0m15:08:12.506784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3b483080>]}
[0m15:08:12.508341 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:08:12.673548 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:08:12.952140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:12.953175 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:08:12.954078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:13.008000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3b3a4bf0>]}
[0m15:08:13.130945 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:08:13.137836 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:08:13.428309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3a3c9b20>]}
[0m15:08:13.429242 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:08:13.432815 [info ] [MainThread]: 
[0m15:08:13.433770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:13.434527 [info ] [MainThread]: 
[0m15:08:13.435779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:13.442724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:13.444001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:13.450324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:13.529506 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:13.530218 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:13.530809 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:13.531414 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:13.532381 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:13.533204 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:13.534136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:13.534952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:13.535670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:13.558217 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:08:13.558923 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.025 seconds
[0m15:08:13.561301 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:13.562790 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:08:13.564373 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:13.567357 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:13.575474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:08:13.576681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:08:13.582990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:08:13.586495 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:08:13.590078 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:08:13.593210 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:08:13.594166 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:08:13.595123 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:08:13.595992 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:08:13.596751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:13.597513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:13.598228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:13.623672 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.025 seconds
[0m15:08:13.624483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m15:08:13.625074 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.028 seconds
[0m15:08:13.627132 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:08:13.629103 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:08:13.631329 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:08:13.632976 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:08:13.634016 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:08:13.634844 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:08:13.650638 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:13.651667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:08:13.652484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:13.677943 [debug] [MainThread]: SQL status: SELECT 13 in 0.025 seconds
[0m15:08:13.680332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e39b96810>]}
[0m15:08:13.681140 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:13.682052 [debug] [MainThread]: On master: COMMIT
[0m15:08:13.682642 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:13.683210 [debug] [MainThread]: On master: COMMIT
[0m15:08:13.684089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:08:13.684655 [debug] [MainThread]: On master: Close
[0m15:08:13.692464 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:08:13.693230 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:08:13.694147 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:08:13.694947 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:08:13.695927 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:08:13.696898 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:08:13.697948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:08:13.698792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:08:13.699636 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:08:13.700780 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:08:13.701640 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:08:13.702360 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:08:13.716763 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:08:13.717320 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:08:13.723428 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:08:13.735775 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:08:13.736625 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:08:13.747971 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:08:13.827988 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:08:13.829041 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:08:13.832678 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:08:13.839517 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:08:13.841137 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:08:13.841954 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:13.842604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:13.843487 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:08:13.844175 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:13.845195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:13.846024 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:08:13.847269 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:13.863133 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:08:13.865734 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:08:13.867861 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:08:13.868538 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m15:08:13.875825 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m15:08:13.889331 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:13.892478 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:13.893614 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:08:13.895220 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:08:13.899014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:08:13.901335 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:13.908459 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:08:13.911040 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:13.914547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e384d99d0>]}
[0m15:08:13.919212 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:13.920194 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:08:13.921503 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.21s]
[0m15:08:13.922395 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:08:13.923982 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:08:13.924732 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:13.928157 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:08:13.929155 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:08:13.955107 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:08:13.958080 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:08:13.959557 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:13.960909 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:13.961943 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:08:13.962819 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:08:13.965746 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:08:13.971821 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:08:13.983228 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:08:13.982732 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:08:13.992885 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:13.994075 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:13.995114 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:08:13.996019 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:08:14.001778 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:08:14.005649 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:08:14.006353 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:08:14.007438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e38337410>]}
[0m15:08:14.011456 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:08:14.012793 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.31s]
[0m15:08:14.014073 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e38336e40>]}
[0m15:08:14.014953 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:08:14.016215 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.31s]
[0m15:08:14.017847 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:08:14.018704 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:08:14.019664 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:08:14.021556 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:08:14.022539 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:08:14.023146 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:08:14.023749 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:08:14.024837 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:08:14.025710 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:08:14.030308 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:08:14.031279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:08:14.032217 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:08:14.033551 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:08:14.034548 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:08:14.038202 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:08:14.044151 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:08:14.050310 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:08:14.104813 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:08:14.104124 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:08:14.112263 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:14.113261 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:08:14.114136 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:08:14.114848 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:14.116011 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:08:14.116921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:14.137977 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.024 seconds
[0m15:08:14.146443 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.029 seconds
[0m15:08:14.149075 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:14.153568 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:14.154654 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:08:14.155772 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:08:14.158038 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:14.158723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:14.162971 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:14.169818 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:14.170824 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:08:14.171854 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:08:14.173994 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:14.174616 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:14.176822 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:08:14.179104 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:08:14.179926 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:14.180787 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:14.181720 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:08:14.182522 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:08:14.185261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:08:14.189752 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:08:14.190574 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:08:14.196371 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:14.200554 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:08:14.201597 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:08:14.202970 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:14.204298 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:08:14.210318 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:08:14.211188 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:08:14.213167 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:08:14.215372 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:08:14.216700 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e38363a70>]}
[0m15:08:14.217641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7044c8e6-a80f-4ac6-a3d7-6e861a6af4c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e384d8350>]}
[0m15:08:14.218697 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.20s]
[0m15:08:14.220317 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.19s]
[0m15:08:14.221864 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:08:14.223142 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:08:14.225618 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:08:14.226689 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:08:14.227816 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:08:14.228616 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:08:14.231502 [debug] [MainThread]: On master: COMMIT
[0m15:08:14.232268 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:14.232972 [debug] [MainThread]: On master: COMMIT
[0m15:08:14.233656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:14.249755 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m15:08:14.250673 [debug] [MainThread]: On master: Close
[0m15:08:14.251589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:14.252379 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:08:14.253117 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:08:14.253862 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:08:14.254463 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:08:14.255258 [info ] [MainThread]: 
[0m15:08:14.260681 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m15:08:14.266929 [debug] [MainThread]: Command end result
[0m15:08:14.328096 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:08:14.334248 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:08:14.347541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:08:14.348245 [info ] [MainThread]: 
[0m15:08:14.348965 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:08:14.349607 [info ] [MainThread]: 
[0m15:08:14.350350 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:08:14.351117 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:14.351767 [info ] [MainThread]: 
[0m15:08:14.352539 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:14.353163 [info ] [MainThread]: 
[0m15:08:14.353808 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:08:14.355410 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5160558, "process_in_blocks": "0", "process_kernel_time": 0.920887, "process_mem_max_rss": "163300", "process_out_blocks": "0", "process_user_time": 8.500169}
[0m15:08:14.356279 [debug] [MainThread]: Command `dbt build` failed at 15:08:14.356120 after 2.52 seconds
[0m15:08:14.356988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3ba03470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3c5927b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6e3b8b8590>]}
[0m15:08:14.357752 [debug] [MainThread]: Flushing usage events
[0m15:08:15.011797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:38.539696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ef3f9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eeb58860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eea17020>]}


============================== 15:08:38.611800 | bd4efbe3-3340-4b96-bbe3-26662eaed691 ==============================
[0m15:08:38.611800 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:08:38.612949 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None'}
[0m15:08:38.952504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eeb52420>]}
[0m15:08:39.078489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eefbe570>]}
[0m15:08:39.080124 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:08:39.252645 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:08:39.560897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:39.561788 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:08:39.562408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:39.615734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ee68f2c0>]}
[0m15:08:39.757146 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:08:39.766573 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:08:40.054571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ed31ddc0>]}
[0m15:08:40.055568 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:08:40.059199 [info ] [MainThread]: 
[0m15:08:40.060043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:40.060769 [info ] [MainThread]: 
[0m15:08:40.061972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:40.068684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:40.077332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:40.078492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:08:40.177138 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:40.178051 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:40.178807 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:08:40.179923 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:40.180784 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:40.181646 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:08:40.182491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:40.183384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:40.184074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:40.203516 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m15:08:40.204145 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m15:08:40.206294 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:40.207110 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.025 seconds
[0m15:08:40.209842 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:40.216150 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:08:40.223659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:08:40.224855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:08:40.225930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:08:40.235925 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:08:40.238879 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:08:40.242099 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:08:40.243145 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:08:40.243966 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:08:40.244830 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:08:40.245601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:40.246324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:40.247111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:40.271686 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m15:08:40.273867 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:08:40.279410 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:08:40.280066 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m15:08:40.274497 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:08:40.289108 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:08:40.292259 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:08:40.294977 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:08:40.295641 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:08:40.304723 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.305835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:08:40.306695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:40.344052 [debug] [MainThread]: SQL status: SELECT 13 in 0.037 seconds
[0m15:08:40.346784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ed31d5b0>]}
[0m15:08:40.347957 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:40.349415 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.350373 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.351147 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.352342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:08:40.353267 [debug] [MainThread]: On master: Close
[0m15:08:40.361358 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:08:40.362120 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:08:40.363601 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:08:40.362988 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:08:40.364901 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:08:40.366003 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:08:40.367015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:08:40.367952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:08:40.369147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:08:40.370590 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:08:40.371554 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:08:40.372430 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:08:40.388922 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:08:40.390921 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:08:40.397495 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:08:40.405223 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:08:40.406044 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:08:40.423040 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:08:40.532377 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:08:40.529692 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:08:40.535396 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:08:40.540290 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:40.541045 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:40.541715 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:08:40.542640 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:08:40.543386 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:08:40.543922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:40.544703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:40.545556 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:08:40.547744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:40.564010 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m15:08:40.565048 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:08:40.571522 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:08:40.577832 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:08:40.578658 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:08:40.586225 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:40.592999 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:40.597106 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:08:40.598664 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:08:40.601787 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:40.602557 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:08:40.607753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eb473b60>]}
[0m15:08:40.604442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:40.613088 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:40.614449 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.24s]
[0m15:08:40.619458 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:40.620684 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:08:40.622347 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:08:40.623518 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:08:40.626258 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:40.627449 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:08:40.633972 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:08:40.657450 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:08:40.659758 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:08:40.660675 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:40.661413 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:40.662185 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:08:40.662897 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:08:40.665714 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:08:40.673955 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m15:08:40.676737 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:08:40.680212 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:08:40.692473 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:08:40.691542 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:08:40.693435 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:08:40.694236 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:08:40.700520 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:08:40.704693 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:08:40.705448 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:08:40.706443 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eb41ef60>]}
[0m15:08:40.708941 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:08:40.710297 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.34s]
[0m15:08:40.711608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eb43fa10>]}
[0m15:08:40.712476 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:08:40.713646 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.34s]
[0m15:08:40.715092 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:08:40.715948 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:08:40.716848 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:08:40.718222 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:08:40.719000 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:08:40.719596 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:08:40.720857 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:08:40.721749 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:08:40.722648 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:08:40.723521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:08:40.727701 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:08:40.728586 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:08:40.729382 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:08:40.730644 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:08:40.734099 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:08:40.740189 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:08:40.740925 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:08:40.798968 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:08:40.799787 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:08:40.808535 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:40.809412 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:08:40.810084 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:40.810621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:08:40.811480 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:08:40.813105 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:40.836562 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.026 seconds
[0m15:08:40.837366 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.024 seconds
[0m15:08:40.848107 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:40.853013 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:40.854223 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:08:40.855299 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:08:40.857523 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:40.865290 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:08:40.867662 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:40.873524 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:40.874793 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:08:40.875886 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:08:40.877785 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:08:40.880343 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:08:40.880945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:08:40.881524 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:40.883804 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:08:40.885090 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:08:40.887128 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:40.889418 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:08:40.891035 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:08:40.894698 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:08:40.895406 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m15:08:40.899995 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:08:40.903914 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:08:40.905878 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:08:40.907777 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:08:40.912761 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:08:40.915514 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:08:40.918246 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:08:40.919617 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eb465280>]}
[0m15:08:40.920410 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:08:40.923587 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.20s]
[0m15:08:40.926423 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:08:40.927935 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:08:40.929446 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4efbe3-3340-4b96-bbe3-26662eaed691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ebb58740>]}
[0m15:08:40.931900 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.21s]
[0m15:08:40.932752 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:08:40.933752 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:08:40.934688 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:08:40.936007 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:08:40.936819 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:08:40.939845 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.940727 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:40.941355 [debug] [MainThread]: On master: COMMIT
[0m15:08:40.941969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:40.956563 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:08:40.957496 [debug] [MainThread]: On master: Close
[0m15:08:40.958410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:40.959069 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:08:40.959682 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:08:40.960269 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:08:40.960847 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:08:40.961625 [info ] [MainThread]: 
[0m15:08:40.962327 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m15:08:40.964678 [debug] [MainThread]: Command end result
[0m15:08:41.012435 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:08:41.018946 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:08:41.032066 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:08:41.032951 [info ] [MainThread]: 
[0m15:08:41.033711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:08:41.034432 [info ] [MainThread]: 
[0m15:08:41.035321 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:08:41.036139 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:41.036993 [info ] [MainThread]: 
[0m15:08:41.038133 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:08:41.039012 [info ] [MainThread]: 
[0m15:08:41.039761 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:08:41.041363 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.631244, "process_in_blocks": "0", "process_kernel_time": 0.742974, "process_mem_max_rss": "163652", "process_out_blocks": "0", "process_user_time": 7.372906}
[0m15:08:41.042181 [debug] [MainThread]: Command `dbt build` failed at 15:08:41.042041 after 2.63 seconds
[0m15:08:41.042942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5eeecdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ef0d02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee5ebfeffb0>]}
[0m15:08:41.043636 [debug] [MainThread]: Flushing usage events
[0m15:08:41.803509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:03.117101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de9f503e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de6805bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de5e560f0>]}


============================== 15:09:03.194634 | 2e2f08f2-855e-4da2-8e84-c5d0d2c359e4 ==============================
[0m15:09:03.194634 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:09:03.195935 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'profiles_dir': '/app/dbt'}
[0m15:09:03.517778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de57feb40>]}
[0m15:09:03.642760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de66f0ad0>]}
[0m15:09:03.644349 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:09:03.797927 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:09:04.056018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:04.057049 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:09:04.057905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:04.109893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de5695340>]}
[0m15:09:04.235253 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:04.242250 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:04.524152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de4721c40>]}
[0m15:09:04.525101 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:09:04.528643 [info ] [MainThread]: 
[0m15:09:04.529836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:04.530719 [info ] [MainThread]: 
[0m15:09:04.531719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:04.538130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:04.546648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:04.547868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:04.632069 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:04.632962 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:04.633518 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:04.634026 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:04.634983 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:04.635851 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:04.636896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:04.637858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:04.638697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:04.659592 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:09:04.660647 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:09:04.661305 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:09:04.663245 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:04.665567 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:04.667710 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:04.674176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:09:04.675270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:09:04.681440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:09:04.684615 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:09:04.687214 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:09:04.689796 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:09:04.690636 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:09:04.691470 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:09:04.692293 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:09:04.693082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:04.693751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:04.694424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:04.719524 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m15:09:04.720233 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:09:04.720886 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:09:04.722565 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:09:04.724630 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:09:04.726747 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:09:04.728977 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:09:04.729876 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:09:04.730744 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:09:04.742267 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:04.743262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:09:04.744063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:04.771207 [debug] [MainThread]: SQL status: SELECT 13 in 0.027 seconds
[0m15:09:04.773781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de43f8cb0>]}
[0m15:09:04.774636 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:04.775565 [debug] [MainThread]: On master: COMMIT
[0m15:09:04.776194 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:04.776897 [debug] [MainThread]: On master: COMMIT
[0m15:09:04.777904 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:09:04.778555 [debug] [MainThread]: On master: Close
[0m15:09:04.785226 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:09:04.785938 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:09:04.786523 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:09:04.787274 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:09:04.788313 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:09:04.789455 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:09:04.790292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:09:04.791113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:09:04.791911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:09:04.793140 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:09:04.794023 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:09:04.794928 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:09:04.809389 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:09:04.805850 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:09:04.816139 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:09:04.822887 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:09:04.823703 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:09:04.845700 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:09:04.931361 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:09:04.934662 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:09:04.937462 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:09:04.944984 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:04.945765 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:04.946434 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:09:04.947540 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:09:04.948522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:04.949300 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:09:04.949881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:04.951640 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:09:04.953148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:04.969803 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:09:04.970912 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:09:04.977010 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m15:09:04.983202 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:09:04.982647 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:04.988446 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:04.990181 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:09:04.990864 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:09:04.991739 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:09:04.994383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:09:04.995085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.000724 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:05.008025 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:09:05.008715 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:05.010354 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:09:05.012815 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:05.013629 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:09:05.014350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.018335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b14ce0>]}
[0m15:09:05.059478 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:05.057373 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.23s]
[0m15:09:05.061819 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:05.062418 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:05.063517 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:09:05.064796 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:05.065823 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:05.067347 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:05.068564 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:09:05.071069 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:09:05.077200 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:09:05.086657 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:09:05.087235 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:09:05.096081 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:05.097079 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:05.098017 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:09:05.098924 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:09:05.104858 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:09:05.108745 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:09:05.109384 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:09:05.110301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b7fad0>]}
[0m15:09:05.114199 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:09:05.115652 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.32s]
[0m15:09:05.117036 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b7f9e0>]}
[0m15:09:05.118001 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:09:05.120214 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.33s]
[0m15:09:05.122113 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:09:05.123062 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:09:05.124074 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:09:05.125633 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:09:05.126300 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:09:05.126852 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:09:05.127380 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:09:05.128334 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:09:05.129241 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:09:05.134057 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:09:05.135152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:09:05.136025 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:09:05.137384 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:09:05.138473 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:09:05.141980 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:09:05.147384 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:09:05.153745 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:09:05.206032 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:09:05.206925 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:09:05.212928 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:05.213778 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:09:05.214422 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:05.215006 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:05.215826 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:09:05.217094 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:09:05.239842 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.023 seconds
[0m15:09:05.247634 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.033 seconds
[0m15:09:05.250662 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:05.254741 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:05.255682 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:09:05.256694 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:09:05.258644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.259205 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.263250 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:05.270269 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:05.270874 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:09:05.271712 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:09:05.273541 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.274133 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:05.276254 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:05.278626 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:05.279788 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:05.280767 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:05.281751 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:05.282591 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:05.285545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:09:05.289484 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:09:05.290165 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m15:09:05.295599 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:05.299861 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:09:05.301296 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:09:05.303594 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:05.306244 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:09:05.312702 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:09:05.313639 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:09:05.315879 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:09:05.319138 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:09:05.320683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b349b0>]}
[0m15:09:05.321639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e2f08f2-855e-4da2-8e84-c5d0d2c359e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b50da0>]}
[0m15:09:05.323107 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.20s]
[0m15:09:05.324622 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.19s]
[0m15:09:05.326342 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:09:05.327584 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:09:05.329168 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:09:05.330332 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:09:05.331262 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:09:05.332333 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:09:05.335318 [debug] [MainThread]: On master: COMMIT
[0m15:09:05.336415 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:05.337278 [debug] [MainThread]: On master: COMMIT
[0m15:09:05.337943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:05.352591 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:09:05.353694 [debug] [MainThread]: On master: Close
[0m15:09:05.354681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:05.355424 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:09:05.356103 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:09:05.356754 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:09:05.357334 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:09:05.358280 [info ] [MainThread]: 
[0m15:09:05.359084 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:09:05.361736 [debug] [MainThread]: Command end result
[0m15:09:05.411378 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:05.417761 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:05.429707 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:09:05.430356 [info ] [MainThread]: 
[0m15:09:05.431083 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:05.431878 [info ] [MainThread]: 
[0m15:09:05.432800 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:09:05.433735 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:05.434517 [info ] [MainThread]: 
[0m15:09:05.435395 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:05.436314 [info ] [MainThread]: 
[0m15:09:05.437262 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:09:05.439152 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4488263, "process_in_blocks": "0", "process_kernel_time": 0.785085, "process_mem_max_rss": "163904", "process_out_blocks": "0", "process_user_time": 6.621681}
[0m15:09:05.440112 [debug] [MainThread]: Command `dbt build` failed at 15:09:05.439960 after 2.45 seconds
[0m15:09:05.440865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de5c273e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de6dd7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763de2b12690>]}
[0m15:09:05.441595 [debug] [MainThread]: Flushing usage events
[0m15:09:06.063570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:27.477276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c532b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c5826b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c53283e0>]}


============================== 15:09:27.550250 | 3373b6b4-412e-43a6-8004-82fbb6cd02bf ==============================
[0m15:09:27.550250 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:09:27.551362 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'write_json': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'profiles_dir': '/app/dbt'}
[0m15:09:27.867354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c4ecdd00>]}
[0m15:09:27.989444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c77a2600>]}
[0m15:09:27.991035 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:09:28.165617 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:09:28.428669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:28.429729 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:09:28.430559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:28.480896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c4ecdd60>]}
[0m15:09:28.608392 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:28.615456 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:28.916394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c3912150>]}
[0m15:09:28.917258 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:09:28.920783 [info ] [MainThread]: 
[0m15:09:28.921461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:28.922142 [info ] [MainThread]: 
[0m15:09:28.923028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:28.929380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:28.930653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:28.936794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:29.022402 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:29.023161 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:29.023834 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:29.024458 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:29.025626 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:29.026487 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:29.027271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:29.028101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:29.028911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:29.049570 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m15:09:29.050306 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m15:09:29.050870 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.024 seconds
[0m15:09:29.052739 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:29.054774 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:29.056556 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:29.064380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:09:29.065674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:09:29.074422 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:09:29.075139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:09:29.077672 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:09:29.078808 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:09:29.081495 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:09:29.082346 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:09:29.083260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:29.084007 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:09:29.084739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:29.086013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:29.109673 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.025 seconds
[0m15:09:29.110326 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m15:09:29.110821 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.025 seconds
[0m15:09:29.112903 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:09:29.114988 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:09:29.116930 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:09:29.118104 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:09:29.118685 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:09:29.119486 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:09:29.130694 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:29.131640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:09:29.132413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:29.160618 [debug] [MainThread]: SQL status: SELECT 13 in 0.028 seconds
[0m15:09:29.163127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c39f50d0>]}
[0m15:09:29.163992 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:29.164888 [debug] [MainThread]: On master: COMMIT
[0m15:09:29.165654 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:29.166276 [debug] [MainThread]: On master: COMMIT
[0m15:09:29.167282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:09:29.167900 [debug] [MainThread]: On master: Close
[0m15:09:29.174776 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:09:29.175539 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:09:29.176145 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:09:29.176888 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:09:29.178016 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:09:29.178915 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:09:29.179932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:09:29.180857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:09:29.181725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:09:29.182911 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:09:29.183819 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:09:29.184636 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:09:29.206787 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:09:29.208906 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:09:29.215327 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:09:29.221769 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:09:29.222414 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:09:29.253177 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:09:29.327095 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:09:29.328071 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:09:29.328784 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:09:29.334778 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:29.336247 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:29.336928 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:09:29.337691 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:09:29.338275 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:09:29.339059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:29.339822 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:09:29.340689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:29.342345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:29.357043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:09:29.359231 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m15:09:29.359863 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m15:09:29.360589 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:09:29.370930 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:29.376086 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:29.377829 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:09:29.378879 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:09:29.379736 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:09:29.386782 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:29.387636 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:09:29.390609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c1d30500>]}
[0m15:09:29.391806 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:09:29.396797 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:29.398303 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.21s]
[0m15:09:29.403102 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:29.404090 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:09:29.405243 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:09:29.406069 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:09:29.407659 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:09:29.408262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.410074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.448040 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:29.448608 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:29.449198 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:29.450061 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:29.450814 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:29.451548 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:29.455698 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:09:29.462254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m15:09:29.471252 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:09:29.468000 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:09:29.483727 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:29.484756 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:29.485753 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:09:29.486596 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:09:29.492843 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:09:29.496775 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:09:29.497430 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:09:29.498420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c1d36ff0>]}
[0m15:09:29.502740 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:09:29.503991 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.32s]
[0m15:09:29.505125 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c1d87410>]}
[0m15:09:29.505997 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:09:29.507260 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.32s]
[0m15:09:29.508724 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:09:29.509813 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:09:29.510917 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:09:29.512543 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:09:29.513162 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:09:29.513766 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:09:29.514286 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:09:29.515282 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:09:29.516250 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:09:29.520288 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:09:29.521163 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:09:29.522148 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:09:29.523386 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:09:29.524469 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:09:29.528995 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:09:29.534872 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:09:29.540982 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:09:29.592733 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:09:29.593722 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:09:29.599923 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:29.600730 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:09:29.601360 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:29.601981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:29.602806 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:09:29.604139 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:09:29.627139 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.023 seconds
[0m15:09:29.627878 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.026 seconds
[0m15:09:29.637461 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:29.641667 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:29.642815 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:09:29.643749 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:09:29.645663 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.646323 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.650477 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:29.655918 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:29.657057 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:09:29.658218 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:09:29.660367 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.661336 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:29.663668 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:29.666081 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:29.667097 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:29.667947 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:29.668789 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:29.669588 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:29.672711 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:09:29.676933 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:09:29.677678 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m15:09:29.682531 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:29.686154 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:09:29.687243 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:09:29.688660 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:29.689829 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:09:29.695838 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:09:29.696794 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:09:29.698848 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:09:29.700800 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:09:29.702076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c293d4f0>]}
[0m15:09:29.703078 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3373b6b4-412e-43a6-8004-82fbb6cd02bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c1d5dcd0>]}
[0m15:09:29.704036 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.19s]
[0m15:09:29.705254 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.18s]
[0m15:09:29.706610 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:09:29.707712 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:09:29.709395 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:09:29.710369 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:09:29.711267 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:09:29.712019 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:09:29.714670 [debug] [MainThread]: On master: COMMIT
[0m15:09:29.715405 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:29.716084 [debug] [MainThread]: On master: COMMIT
[0m15:09:29.716715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:29.729884 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:09:29.730798 [debug] [MainThread]: On master: Close
[0m15:09:29.731682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:29.732367 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:09:29.732936 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:09:29.733645 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:09:29.734308 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:09:29.735182 [info ] [MainThread]: 
[0m15:09:29.736562 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m15:09:29.739465 [debug] [MainThread]: Command end result
[0m15:09:29.803168 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:29.810102 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:29.826972 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:09:29.827873 [info ] [MainThread]: 
[0m15:09:29.828774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:29.829647 [info ] [MainThread]: 
[0m15:09:29.830542 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:09:29.831412 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:29.832238 [info ] [MainThread]: 
[0m15:09:29.833130 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:29.833911 [info ] [MainThread]: 
[0m15:09:29.834692 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:09:29.836495 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4911025, "process_in_blocks": "0", "process_kernel_time": 0.748985, "process_mem_max_rss": "162696", "process_out_blocks": "0", "process_user_time": 6.832993}
[0m15:09:29.837661 [debug] [MainThread]: Command `dbt build` failed at 15:09:29.837415 after 2.49 seconds
[0m15:09:29.840156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c55b3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c7fbfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7807c1d85df0>]}
[0m15:09:29.842315 [debug] [MainThread]: Flushing usage events
[0m15:09:30.503629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:51.856910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b60cda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b39957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b3841430>]}


============================== 15:09:51.929694 | 7ad6c9af-af06-4394-8377-088b11c5fa5b ==============================
[0m15:09:51.929694 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:09:51.930710 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app/dbt', 'introspect': 'True'}
[0m15:09:52.256395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b5fe8350>]}
[0m15:09:52.388121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b3cacc80>]}
[0m15:09:52.389715 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:09:52.546685 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:09:52.812708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:52.813771 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:09:52.814543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:52.866087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b2fcb080>]}
[0m15:09:52.991360 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:52.998443 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:53.278303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b2121f40>]}
[0m15:09:53.279268 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:09:53.283061 [info ] [MainThread]: 
[0m15:09:53.283849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:53.284516 [info ] [MainThread]: 
[0m15:09:53.285488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:53.293358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:53.301932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:53.318688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:09:53.389061 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:53.389787 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:53.390460 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:09:53.392070 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:53.393496 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:53.394765 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:53.395697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:53.396555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:53.397397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:53.419261 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m15:09:53.419885 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:09:53.422019 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:53.422674 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:09:53.424223 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:53.426529 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:09:53.433958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:09:53.434905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:09:53.441096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:09:53.444781 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:09:53.447511 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:09:53.450236 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:09:53.451129 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:09:53.452023 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:09:53.452869 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:09:53.453721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:53.454543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:53.455464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:53.478554 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.024 seconds
[0m15:09:53.479267 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.024 seconds
[0m15:09:53.481204 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:09:53.481805 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m15:09:53.483701 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:09:53.484703 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:09:53.486460 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:09:53.487541 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:09:53.489756 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:09:53.500417 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:53.501394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:09:53.502272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:53.528627 [debug] [MainThread]: SQL status: SELECT 13 in 0.026 seconds
[0m15:09:53.531118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b2f0fa40>]}
[0m15:09:53.531969 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:53.532874 [debug] [MainThread]: On master: COMMIT
[0m15:09:53.533626 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:53.534258 [debug] [MainThread]: On master: COMMIT
[0m15:09:53.535342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:09:53.536023 [debug] [MainThread]: On master: Close
[0m15:09:53.544026 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:09:53.544777 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:09:53.545374 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:09:53.546299 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:09:53.547494 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:09:53.548380 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:09:53.549387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:09:53.550275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:09:53.551072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:09:53.552141 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:09:53.553021 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:09:53.553932 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:09:53.564591 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:09:53.567912 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:09:53.574315 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:09:53.581639 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:09:53.582304 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:09:53.594962 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:09:53.684241 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:09:53.681152 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:09:53.686227 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:09:53.694468 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:53.695285 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:53.695906 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:09:53.696690 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:09:53.697267 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:09:53.698193 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:09:53.699035 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:09:53.699911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:53.701866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:53.717557 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:09:53.718429 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m15:09:53.719459 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:09:53.720330 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m15:09:53.730432 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:53.735836 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:53.736741 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:09:53.737339 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:09:53.738997 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:09:53.743498 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:53.746975 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:53.749682 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:09:53.756940 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:53.760106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b451d4f0>]}
[0m15:09:53.765404 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:53.766501 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:09:53.767788 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.21s]
[0m15:09:53.768786 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:09:53.770737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:53.771803 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:09:53.778603 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:09:53.785380 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:09:53.819356 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:53.823390 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:53.824034 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:53.824961 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:53.825850 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:09:53.827670 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:09:53.830625 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:09:53.836735 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m15:09:53.846154 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:09:53.846710 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:09:53.855656 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:09:53.856825 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:09:53.857762 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:09:53.858600 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:09:53.864606 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:09:53.868367 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:09:53.869019 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m15:09:53.870036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b02870e0>]}
[0m15:09:53.872168 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:09:53.873960 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.32s]
[0m15:09:53.875460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b0286ea0>]}
[0m15:09:53.876376 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:09:53.877579 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.33s]
[0m15:09:53.879110 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:09:53.880030 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:09:53.881769 [debug] [Thread-1 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:09:53.882379 [debug] [Thread-3 (]: Began running node model.spacex_dbt.fct_launches
[0m15:09:53.881160 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:09:53.883212 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:09:53.884147 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:09:53.884939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:09:53.885747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launches, now model.spacex_dbt.dim_launchpads)
[0m15:09:53.886555 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:09:53.887373 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:09:53.888173 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:09:53.889190 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:09:53.894031 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:09:53.897828 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:09:53.905198 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:09:53.911675 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:09:53.962350 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:09:53.962902 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:09:53.969496 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:53.970291 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:53.970857 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:09:53.971682 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:09:53.972499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:53.973247 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:53.997557 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.024 seconds
[0m15:09:53.998273 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.026 seconds
[0m15:09:54.007754 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:54.011794 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:54.012822 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:09:54.013829 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:09:54.015682 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:54.016257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:54.020249 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:54.028490 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:54.029166 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:09:54.030063 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:09:54.031937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:54.032494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:54.034678 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:54.036819 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:54.037884 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:54.039311 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:54.040617 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:09:54.041757 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:09:54.044865 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:09:54.048523 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:09:54.049101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:09:54.054011 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:09:54.057783 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:09:54.058754 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:09:54.060189 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:09:54.061349 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:09:54.066769 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:09:54.069067 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:09:54.069842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:09:54.070810 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b02385f0>]}
[0m15:09:54.072730 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:09:54.074248 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.19s]
[0m15:09:54.075446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6c9af-af06-4394-8377-088b11c5fa5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b15f7ce0>]}
[0m15:09:54.078189 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:09:54.079527 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.19s]
[0m15:09:54.081387 [debug] [Thread-4 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:09:54.082318 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:09:54.083223 [info ] [Thread-4 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:09:54.084528 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:09:54.085316 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:09:54.088173 [debug] [MainThread]: On master: COMMIT
[0m15:09:54.088988 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:54.089776 [debug] [MainThread]: On master: COMMIT
[0m15:09:54.090518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:54.104074 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:09:54.105116 [debug] [MainThread]: On master: Close
[0m15:09:54.106358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:54.109190 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:09:54.109954 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:09:54.110525 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:09:54.111286 [info ] [MainThread]: 
[0m15:09:54.111961 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:09:54.114194 [debug] [MainThread]: Command end result
[0m15:09:54.160069 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:09:54.166678 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:09:54.179825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:09:54.180572 [info ] [MainThread]: 
[0m15:09:54.181300 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:09:54.182028 [info ] [MainThread]: 
[0m15:09:54.182802 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:09:54.183566 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:54.184214 [info ] [MainThread]: 
[0m15:09:54.184949 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:09:54.185768 [info ] [MainThread]: 
[0m15:09:54.186465 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:09:54.188018 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4731796, "process_in_blocks": "0", "process_kernel_time": 0.7495, "process_mem_max_rss": "163072", "process_out_blocks": "0", "process_user_time": 6.661788}
[0m15:09:54.188817 [debug] [MainThread]: Command `dbt build` failed at 15:09:54.188678 after 2.47 seconds
[0m15:09:54.189792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b333d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b3cad3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7643b02138f0>]}
[0m15:09:54.190871 [debug] [MainThread]: Flushing usage events
[0m15:09:54.940638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:16.432357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54cc89fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54cc8a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54cc8a120>]}


============================== 15:10:16.502266 | e037a803-2d4a-4f40-a311-76200fdbf65c ==============================
[0m15:10:16.502266 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:10:16.503418 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'empty': 'False'}
[0m15:10:16.819671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54f9589b0>]}
[0m15:10:16.943228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f55150ac90>]}
[0m15:10:16.944864 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:10:17.104043 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:10:17.370522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:17.371696 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:10:17.372487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:17.425193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54cb442c0>]}
[0m15:10:17.548131 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:10:17.555574 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:10:17.860842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54c7d2750>]}
[0m15:10:17.862124 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:10:17.866498 [info ] [MainThread]: 
[0m15:10:17.867592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:17.868323 [info ] [MainThread]: 
[0m15:10:17.869357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:17.876873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:17.878839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:17.885549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:18.010651 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:18.011451 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:18.012179 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:18.012699 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:18.013624 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:18.014425 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:18.015255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:18.016271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:18.019294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:18.042556 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:10:18.044942 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:18.045575 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.029 seconds
[0m15:10:18.046310 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m15:10:18.048885 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:18.052079 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:18.058778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:10:18.060036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:10:18.069790 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:10:18.070740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:10:18.074090 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:10:18.075288 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:10:18.081196 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:10:18.082357 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:10:18.084159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:18.085239 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:10:18.086298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:18.095511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:18.121392 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m15:10:18.124871 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:10:18.132257 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:10:18.144033 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.058 seconds
[0m15:10:18.146722 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:10:18.148719 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.053 seconds
[0m15:10:18.153134 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:10:18.157896 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:10:18.211852 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:10:18.227601 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:18.239268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:10:18.240773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:18.280439 [debug] [MainThread]: SQL status: SELECT 13 in 0.040 seconds
[0m15:10:18.288968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54a3714f0>]}
[0m15:10:18.290327 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:18.295442 [debug] [MainThread]: On master: COMMIT
[0m15:10:18.296904 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:18.298130 [debug] [MainThread]: On master: COMMIT
[0m15:10:18.300199 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:10:18.304185 [debug] [MainThread]: On master: Close
[0m15:10:18.314447 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:10:18.315430 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:10:18.316415 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:10:18.318344 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:10:18.319583 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:10:18.320307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:10:18.321664 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:10:18.322854 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:10:18.324018 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:10:18.325594 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:10:18.330611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:10:18.357276 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:10:18.345864 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:10:18.355000 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:10:18.373642 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:10:18.382838 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:10:18.390301 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:10:18.414774 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:10:18.496376 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:10:18.498774 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:10:18.492092 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:10:18.508066 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:18.510268 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:10:18.511331 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:18.511925 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:10:18.512487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:18.513298 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:10:18.514120 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:10:18.515301 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:18.516234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:18.536871 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:10:18.538088 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:10:18.544261 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:10:18.553028 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:10:18.555140 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:18.560824 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:18.562409 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:10:18.563086 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:10:18.564013 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:10:18.577350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:18.578332 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:10:18.582915 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:18.584295 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:18.593260 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:18.594101 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:10:18.597392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54b7ebbf0>]}
[0m15:10:18.598133 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:10:18.600301 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:18.601605 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.28s]
[0m15:10:18.605022 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:18.623617 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:10:18.654198 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:10:18.655817 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:10:18.656857 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:10:18.657681 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:18.659141 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:18.661328 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:10:18.662163 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:10:18.664842 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:10:18.671045 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:10:18.683874 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:10:18.684606 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:10:18.696139 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:18.697182 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:18.697987 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:10:18.698803 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:10:18.705461 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:10:18.710323 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:10:18.711017 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m15:10:18.712041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54f96e150>]}
[0m15:10:18.714078 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:10:18.715462 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.38s]
[0m15:10:18.716731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f549b5ab40>]}
[0m15:10:18.721627 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:10:18.723184 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.40s]
[0m15:10:18.725311 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:10:18.726551 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:10:18.727744 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:10:18.729230 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:10:18.729814 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:10:18.730391 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:10:18.730943 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:10:18.731940 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:10:18.732771 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:10:18.737948 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:10:18.739253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:10:18.740395 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:10:18.742048 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:10:18.743277 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:10:18.747206 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:10:18.760200 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:10:18.769136 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:10:18.825005 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:10:18.829223 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:10:18.838405 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:18.839349 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:18.840268 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:10:18.841543 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:10:18.842514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:18.843309 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:10:18.868091 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.025 seconds
[0m15:10:18.877252 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.035 seconds
[0m15:10:18.879947 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:18.883855 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:18.886264 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:10:18.887349 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:10:18.889417 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:18.894413 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:18.895031 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:10:18.895659 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:10:18.902238 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:18.905379 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:10:18.906407 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:10:18.910338 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:10:18.911030 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:10:18.911622 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:18.913785 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:10:18.914546 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:10:18.915305 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:18.916494 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:10:18.918715 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:10:18.924130 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:10:18.925058 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:10:18.930569 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:18.934366 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:10:18.936255 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:10:18.937978 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:18.943249 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:10:18.945189 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:10:18.947681 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:10:18.948984 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f549b136e0>]}
[0m15:10:18.950496 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:10:18.952508 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.22s]
[0m15:10:18.956500 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:10:18.958317 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:10:18.959884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e037a803-2d4a-4f40-a311-76200fdbf65c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f549c9be90>]}
[0m15:10:18.963326 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.22s]
[0m15:10:18.964328 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:10:18.965248 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:10:18.966086 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:10:18.967294 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:10:18.969405 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:10:18.973014 [debug] [MainThread]: On master: COMMIT
[0m15:10:18.974054 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:18.974895 [debug] [MainThread]: On master: COMMIT
[0m15:10:18.975608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:18.989679 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:10:18.990654 [debug] [MainThread]: On master: Close
[0m15:10:18.992139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:18.993700 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:10:18.994665 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:10:18.995256 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:10:18.995873 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:10:18.996612 [info ] [MainThread]: 
[0m15:10:18.997271 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m15:10:18.999562 [debug] [MainThread]: Command end result
[0m15:10:19.043103 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:10:19.048482 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:10:19.060806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:10:19.061528 [info ] [MainThread]: 
[0m15:10:19.062332 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:19.063010 [info ] [MainThread]: 
[0m15:10:19.063839 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:10:19.064586 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:19.065268 [info ] [MainThread]: 
[0m15:10:19.065985 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:19.066674 [info ] [MainThread]: 
[0m15:10:19.067346 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:10:19.070237 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.7660894, "process_in_blocks": "0", "process_kernel_time": 0.795091, "process_mem_max_rss": "164156", "process_out_blocks": "0", "process_user_time": 6.86815}
[0m15:10:19.071224 [debug] [MainThread]: Command `dbt build` failed at 15:10:19.071077 after 2.77 seconds
[0m15:10:19.071972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54cc87a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54ce3f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f54de7a600>]}
[0m15:10:19.072663 [debug] [MainThread]: Flushing usage events
[0m15:10:19.689839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:44.010638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abc5ed0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abc5ec170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abc5ed340>]}


============================== 15:10:44.089244 | 9377bfc9-eeba-4406-a60e-1fdf59a85896 ==============================
[0m15:10:44.089244 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:10:44.090309 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'False'}
[0m15:10:44.420749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abed9c530>]}
[0m15:10:44.545969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abd18f710>]}
[0m15:10:44.547761 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:10:44.755544 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:10:45.047080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:45.048703 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:10:45.049683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:45.107267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abbd618b0>]}
[0m15:10:45.243664 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:10:45.252229 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:10:45.562433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abaf11d60>]}
[0m15:10:45.563404 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:10:45.568809 [info ] [MainThread]: 
[0m15:10:45.570478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:45.571503 [info ] [MainThread]: 
[0m15:10:45.572620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:45.579687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:45.580851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:45.587469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:10:45.678286 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:45.678989 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:45.679590 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:10:45.680172 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:45.681201 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:45.682232 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:45.683406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:45.684560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:45.685520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:45.706350 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m15:10:45.707383 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.024 seconds
[0m15:10:45.707850 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m15:10:45.709781 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:45.711774 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:45.713654 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:10:45.720490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:10:45.721477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:10:45.730993 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:10:45.732193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:10:45.735416 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:10:45.737083 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:10:45.740557 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:10:45.741776 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:10:45.743191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:45.744096 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:10:45.744875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:45.746109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:45.770603 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:10:45.772827 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:10:45.774364 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:10:45.776050 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.030 seconds
[0m15:10:45.777511 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.033 seconds
[0m15:10:45.779340 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:10:45.781357 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:10:45.782808 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:10:45.783360 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:10:45.792284 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:45.793309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:10:45.794076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:45.833230 [debug] [MainThread]: SQL status: SELECT 13 in 0.039 seconds
[0m15:10:46.081885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abc19de20>]}
[0m15:10:46.230361 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:46.257944 [debug] [MainThread]: On master: COMMIT
[0m15:10:46.302306 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:46.330215 [debug] [MainThread]: On master: COMMIT
[0m15:10:46.341895 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:10:46.428301 [debug] [MainThread]: On master: Close
[0m15:10:46.480387 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:10:46.481348 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:10:46.481989 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:10:46.483669 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:10:46.485551 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:10:46.488127 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:10:46.507916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:10:46.509208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:10:46.510423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:10:46.511785 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:10:46.514075 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:10:46.515011 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:10:46.538439 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:10:46.542750 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:10:46.551311 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:10:46.578676 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:10:46.581066 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:10:46.595281 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:10:46.741366 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:10:46.743476 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:10:46.744066 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:10:46.760003 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:46.760865 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:46.761680 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:10:46.763645 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:10:46.764519 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:10:46.765214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:46.768448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:46.771548 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:10:46.780658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:46.798592 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:10:46.808630 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:46.809588 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m15:10:46.810196 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:10:46.810964 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:10:46.815436 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:46.817802 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:10:46.819453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:10:46.820142 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:10:46.825347 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:46.826167 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:10:46.827486 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:10:46.828188 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:46.832371 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:10:46.837584 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:46.851544 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:10:46.863626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:10:46.883818 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:10:46.886681 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:10:46.890463 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:46.891382 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:46.892353 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:46.895484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab9032d20>]}
[0m15:10:46.896198 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:10:46.897138 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:10:46.899675 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.39s]
[0m15:10:46.906208 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:10:46.906987 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m15:10:46.907929 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:10:46.908907 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:10:46.929188 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:10:46.930307 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:10:46.946578 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:10:46.947833 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:10:46.948879 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:10:46.949865 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:10:46.957323 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:10:46.958121 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:10:46.961865 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:10:46.964600 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:10:46.966252 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab9005700>]}
[0m15:10:46.967923 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab90079b0>]}
[0m15:10:46.971481 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.46s]
[0m15:10:46.972759 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.46s]
[0m15:10:46.974046 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:10:46.975179 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:10:46.976791 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:10:46.978689 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:10:46.979349 [debug] [Thread-4 (]: Began running node model.spacex_dbt.fct_launches
[0m15:10:46.978102 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:10:46.980259 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:10:46.981185 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:10:46.982016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:10:46.982963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:10:46.984023 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:10:46.985265 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:10:46.986229 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:10:46.987238 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:10:46.991264 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:10:46.995756 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:10:47.003337 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:10:47.004197 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:10:47.075917 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:10:47.086145 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:10:47.094716 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:47.095705 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:10:47.096422 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:47.096994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:10:47.097786 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:10:47.099157 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:10:47.122937 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.026 seconds
[0m15:10:47.132570 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.033 seconds
[0m15:10:47.135513 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:47.140562 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:47.141907 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:10:47.143045 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:10:47.145023 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:47.145782 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:47.150595 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:47.156273 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:47.157420 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:10:47.158230 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:10:47.160002 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:47.160681 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:10:47.162880 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:10:47.165174 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:10:47.166044 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:47.167004 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:47.167890 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:10:47.168828 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:10:47.171895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:10:47.178127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:10:47.178800 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:10:47.182498 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:10:47.190590 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:10:47.191874 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:10:47.192939 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:10:47.194503 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:10:47.201886 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:10:47.204651 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:10:47.205419 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:10:47.206676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab90aa000>]}
[0m15:10:47.214305 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:10:47.216236 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 6[0m in 0.22s]
[0m15:10:47.217596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9377bfc9-eeba-4406-a60e-1fdf59a85896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab90aa120>]}
[0m15:10:47.218719 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:10:47.220749 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.24s]
[0m15:10:47.222666 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:10:47.224598 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:10:47.225791 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:10:47.226817 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:10:47.227643 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:10:47.230722 [debug] [MainThread]: On master: COMMIT
[0m15:10:47.231483 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:47.232082 [debug] [MainThread]: On master: COMMIT
[0m15:10:47.232676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:47.247994 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:10:47.248876 [debug] [MainThread]: On master: Close
[0m15:10:47.249943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:47.251435 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:10:47.252153 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:10:47.253201 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:10:47.256125 [info ] [MainThread]: 
[0m15:10:47.257240 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m15:10:47.259974 [debug] [MainThread]: Command end result
[0m15:10:47.304549 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:10:47.310830 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:10:47.323073 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:10:47.323785 [info ] [MainThread]: 
[0m15:10:47.324550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:47.325265 [info ] [MainThread]: 
[0m15:10:47.326085 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:10:47.326882 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:47.327544 [info ] [MainThread]: 
[0m15:10:47.328345 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:10:47.329013 [info ] [MainThread]: 
[0m15:10:47.329689 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:10:47.331363 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.4581268, "process_in_blocks": "0", "process_kernel_time": 1.046207, "process_mem_max_rss": "162172", "process_out_blocks": "0", "process_user_time": 8.106018}
[0m15:10:47.332154 [debug] [MainThread]: Command `dbt build` failed at 15:10:47.332005 after 3.46 seconds
[0m15:10:47.332937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abd327f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712ab900ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712abddfae70>]}
[0m15:10:47.333765 [debug] [MainThread]: Flushing usage events
[0m15:10:47.962163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:14.041798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317ce71b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317d581340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317d581af0>]}


============================== 15:17:14.118006 | 3f54e16f-698e-4445-b537-877a018d1e86 ==============================
[0m15:17:14.118006 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:17:14.119262 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'partial_parse': 'True', 'target_path': 'None', 'debug': 'False'}
[0m15:17:14.492965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317cafb500>]}
[0m15:17:14.852913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317cd23fb0>]}
[0m15:17:14.881205 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:17:15.157876 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:17:15.482483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:15.483406 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:17:15.484062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:15.547490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317c690f50>]}
[0m15:17:15.683694 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:17:15.690865 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:17:16.058116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317c7820c0>]}
[0m15:17:16.059314 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:17:16.063325 [info ] [MainThread]: 
[0m15:17:16.064187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:16.064899 [info ] [MainThread]: 
[0m15:17:16.065976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:16.074149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:17:16.082961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:17:16.084139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:17:16.178374 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:17:16.179114 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:17:16.179604 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:17:16.180208 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:17:16.181012 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:17:16.181807 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:17:16.182617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:16.183339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:16.184041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:16.204887 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m15:17:16.207386 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:17:16.208049 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m15:17:16.208601 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m15:17:16.210829 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:17:16.214179 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:17:16.216710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_marts)
[0m15:17:16.219339 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_marts"
"
[0m15:17:16.218035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_gold)
[0m15:17:16.217338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_staging)
[0m15:17:16.227763 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:17:16.228477 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_gold"
"
[0m15:17:16.229333 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_staging"
"
[0m15:17:16.230780 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_marts"} */
create schema if not exists "analytics_analytics_marts"
[0m15:17:16.234221 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:17:16.237242 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:17:16.238077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.238827 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_gold"} */
create schema if not exists "analytics_analytics_gold"
[0m15:17:16.239672 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m15:17:16.240822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.241529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.256785 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m15:17:16.257441 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.016 seconds
[0m15:17:16.258973 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:17:16.260461 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:17:16.261025 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.020 seconds
[0m15:17:16.261582 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:17:16.262305 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:17:16.263896 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:17:16.264701 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:17:16.265385 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:17:16.266175 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:17:16.267471 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:17:16.268775 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:17:16.269559 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: Close
[0m15:17:16.270074 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:17:16.270510 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:17:16.271519 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: Close
[0m15:17:16.272233 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: Close
[0m15:17:16.278894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_staging, now list_spacex_db_analytics_analytics_marts)
[0m15:17:16.285531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_gold, now list_spacex_db_analytics_analytics_staging)
[0m15:17:16.289244 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:17:16.290063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_marts, now list_spacex_db_analytics_analytics_gold)
[0m15:17:16.293088 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:17:16.294183 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:17:16.296856 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:17:16.297687 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:17:16.298443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.299144 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:17:16.299929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.301079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:16.326377 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m15:17:16.327030 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.026 seconds
[0m15:17:16.327508 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m15:17:16.329263 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:17:16.331084 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:17:16.332894 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:17:16.334223 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:17:16.334975 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:17:16.335695 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:17:16.349383 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:16.350417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:17:16.351628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:16.379543 [debug] [MainThread]: SQL status: SELECT 2 in 0.028 seconds
[0m15:17:16.381815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317c667dd0>]}
[0m15:17:16.382736 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:16.383762 [debug] [MainThread]: On master: COMMIT
[0m15:17:16.384525 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:16.385209 [debug] [MainThread]: On master: COMMIT
[0m15:17:16.386391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:17:16.387084 [debug] [MainThread]: On master: Close
[0m15:17:16.395079 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:17:16.395787 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:17:16.396340 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:17:16.397124 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:17:16.398326 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:17:16.399479 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:17:16.400381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:17:16.401232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:17:16.402105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:17:16.402951 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:17:16.403742 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:17:16.404551 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:17:16.419430 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:17:16.421719 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:17:16.425910 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:17:16.435430 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:17:16.436273 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:17:16.447808 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:17:16.546904 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:17:16.547522 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:17:16.549009 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:17:16.556465 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:17:16.557427 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:17:16.558426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:17:16.559154 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:17:16.560539 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:17:16.561670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:17:16.562407 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:17:16.566315 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:17:16.567237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:16.581767 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m15:17:16.594970 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:17:16.598728 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:17:16.605318 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:17:16.607382 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:17:16.608140 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:17:16.609210 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:17:16.610188 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:17:16.611952 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:17:16.612937 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:17:16.614962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:17:16.630127 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:17:16.666596 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:17:16.673139 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:17:16.673827 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:17:16.674511 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:17:16.675375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317de315e0>]}
[0m15:17:16.675953 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:17:16.677513 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.25s]
[0m15:17:16.678331 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:17:16.679569 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:17:16.680209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m15:17:16.681502 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:17:16.682124 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:17:16.692500 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:17:16.696885 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:17:16.706754 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:17:16.707947 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:17:16.708811 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:17:16.709656 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:17:16.710993 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:17:16.711560 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:17:16.714878 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:17:16.716865 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:17:16.718547 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713179b636b0>]}
[0m15:17:16.720252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713179b61010>]}
[0m15:17:16.721908 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.32s]
[0m15:17:16.723323 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.32s]
[0m15:17:16.724420 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:17:16.726014 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:17:16.728078 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:17:16.729575 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:17:16.730452 [debug] [Thread-1 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:17:16.731072 [debug] [Thread-3 (]: Began running node model.spacex_dbt.fct_launches
[0m15:17:16.731705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:17:16.732716 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:17:16.733583 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:17:16.734332 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:17:16.735181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launches, now model.spacex_dbt.dim_launchpads)
[0m15:17:16.736072 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:17:16.740503 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:17:16.741393 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:17:16.742275 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:17:16.746547 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:17:16.751552 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:17:16.753294 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:17:16.807485 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:17:16.812699 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:17:16.819756 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:17:16.820792 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:17:16.821674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:17:16.822360 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:17:16.823411 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:17:16.824253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:16.847894 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m15:17:16.848715 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.027 seconds
[0m15:17:16.858232 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:17:16.863964 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:17:16.864694 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:17:16.865609 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:17:16.867292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:17:16.869985 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:17:16.870650 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:17:16.871225 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:17:16.873295 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:17:16.874193 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:17:16.874985 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:17:16.876351 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:17:16.878396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:17:16.882206 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:17:16.882861 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m15:17:16.887994 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:17:16.891760 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:17:16.892785 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:17:16.894271 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:17:16.895548 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:17:16.896207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:17:16.898556 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:17:16.899157 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:17:16.900894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713179c4a8a0>]}
[0m15:17:16.904960 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:17:16.906606 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.17s]
[0m15:17:16.908147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f54e16f-698e-4445-b537-877a018d1e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713179c5b0e0>]}
[0m15:17:16.911220 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:17:16.913055 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 4[0m in 0.18s]
[0m15:17:16.915049 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:17:16.919172 [debug] [Thread-4 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:17:16.920371 [info ] [Thread-4 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:17:16.921408 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:17:16.922366 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:17:16.925328 [debug] [MainThread]: On master: COMMIT
[0m15:17:16.926177 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:16.926894 [debug] [MainThread]: On master: COMMIT
[0m15:17:16.927509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:16.945700 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m15:17:16.946626 [debug] [MainThread]: On master: Close
[0m15:17:16.947647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:16.948373 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:17:16.949037 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:17:16.949825 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:17:16.950965 [info ] [MainThread]: 
[0m15:17:16.952172 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m15:17:16.960624 [debug] [MainThread]: Command end result
[0m15:17:17.024252 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:17:17.046389 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:17:17.064736 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:17:17.065618 [info ] [MainThread]: 
[0m15:17:17.066445 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:17.067199 [info ] [MainThread]: 
[0m15:17:17.068112 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:17:17.069848 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:17:17.070850 [info ] [MainThread]: 
[0m15:17:17.072241 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:17:17.074183 [info ] [MainThread]: 
[0m15:17:17.075145 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:17:17.076991 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.170254, "process_in_blocks": "0", "process_kernel_time": 1.045933, "process_mem_max_rss": "163108", "process_out_blocks": "0", "process_user_time": 8.061042}
[0m15:17:17.078214 [debug] [MainThread]: Command `dbt build` failed at 15:17:17.078016 after 3.17 seconds
[0m15:17:17.079057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317cc446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71317d216f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713179b0dee0>]}
[0m15:17:17.079908 [debug] [MainThread]: Flushing usage events
[0m15:17:17.716474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:13.134190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6db65250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6dfc6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6e3be0f0>]}


============================== 15:34:13.228821 | 80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3 ==============================
[0m15:34:13.228821 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:34:13.233625 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'profiles_dir': '/app/dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m15:34:13.653242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6dfe0b60>]}
[0m15:34:13.824275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6df96960>]}
[0m15:34:13.826059 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:34:14.062552 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:34:14.486288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:14.490013 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:34:14.490962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:14.552626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6e939070>]}
[0m15:34:14.710480 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:14.720601 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:15.133167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6c5c6360>]}
[0m15:34:15.135299 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:34:15.139577 [info ] [MainThread]: 
[0m15:34:15.140737 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:15.141980 [info ] [MainThread]: 
[0m15:34:15.143994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:34:15.154351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:15.155930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:15.157347 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:15.341380 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:15.342195 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:15.342713 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:15.343241 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:15.343949 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:15.344675 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:15.345504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:15.346352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:15.347061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:15.379352 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m15:34:15.380250 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m15:34:15.380712 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m15:34:15.385450 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:15.387866 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:15.390133 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:15.394945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_marts)
[0m15:34:15.395722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_gold)
[0m15:34:15.396321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_staging)
[0m15:34:15.397071 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_marts"
"
[0m15:34:15.398030 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_gold"
"
[0m15:34:15.399485 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_staging"
"
[0m15:34:15.408902 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:34:15.412108 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:34:15.415813 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:34:15.417087 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_marts"} */
create schema if not exists "analytics_analytics_marts"
[0m15:34:15.418498 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_gold"} */
create schema if not exists "analytics_analytics_gold"
[0m15:34:15.419629 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m15:34:15.420489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.421488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.422279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.441782 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m15:34:15.444977 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:34:15.445671 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.024 seconds
[0m15:34:15.446224 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.026 seconds
[0m15:34:15.446728 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:34:15.448249 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:34:15.450172 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:34:15.452115 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:34:15.453134 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:34:15.453926 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:34:15.454955 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:34:15.455695 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:34:15.458095 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:34:15.458934 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: Close
[0m15:34:15.459461 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:34:15.459916 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m15:34:15.461052 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: Close
[0m15:34:15.462132 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: Close
[0m15:34:15.466782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_gold, now list_spacex_db_analytics_analytics_marts)
[0m15:34:15.467953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_marts, now list_spacex_db_analytics_analytics_gold)
[0m15:34:15.469116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_staging, now list_spacex_db_analytics_analytics_staging)
[0m15:34:15.480663 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:34:15.484642 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:34:15.488616 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:34:15.489716 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:34:15.490514 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:34:15.491411 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:34:15.492168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.492881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.493667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:15.534205 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.042 seconds
[0m15:34:15.537205 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:34:15.537980 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.045 seconds
[0m15:34:15.538967 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:34:15.540703 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:34:15.545824 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:34:15.547581 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.054 seconds
[0m15:34:15.551703 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:34:15.553128 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:34:15.561645 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:15.562596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:34:15.563399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:15.603739 [debug] [MainThread]: SQL status: SELECT 2 in 0.040 seconds
[0m15:34:15.606128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6c5c4980>]}
[0m15:34:15.607140 [debug] [MainThread]: On master: ROLLBACK
[0m15:34:15.608559 [debug] [MainThread]: On master: COMMIT
[0m15:34:15.609345 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:15.609984 [debug] [MainThread]: On master: COMMIT
[0m15:34:15.611291 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:34:15.611973 [debug] [MainThread]: On master: Close
[0m15:34:15.623860 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:34:15.624715 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:34:15.625493 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:34:15.626358 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:34:15.627422 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:34:15.628408 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:34:15.629423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:34:15.630285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:34:15.631234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:34:15.632796 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:34:15.635503 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:34:15.637147 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:34:15.653885 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:34:15.658384 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:34:15.661429 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:34:15.670123 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:34:15.682673 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:34:15.727505 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:34:15.767235 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:34:15.764553 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:34:15.768359 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:34:15.777120 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:15.777979 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:15.778719 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:34:15.779673 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:34:15.780570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:15.781391 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:34:15.782070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:15.783608 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:34:15.788084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:15.809915 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:34:15.811032 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:34:15.812695 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:34:15.817317 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m15:34:15.828170 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m15:34:15.830623 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:15.840987 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:15.836200 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:15.844854 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:34:15.845767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6a53be00>]}
[0m15:34:15.846421 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:34:15.848374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:15.850603 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.21s]
[0m15:34:15.853296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:15.865977 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:34:15.892626 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:34:15.900732 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:34:15.907520 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:34:15.909317 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:15.910354 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:15.911310 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:34:15.912184 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:34:15.915216 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:15.922175 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m15:34:15.935011 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:34:15.936895 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:34:15.949332 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:15.947978 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:15.950366 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:34:15.954387 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:34:15.956470 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:34:15.957294 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:34:15.960875 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:34:15.963440 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:34:15.967963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6a6c1880>]}
[0m15:34:15.964875 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6a543710>]}
[0m15:34:15.970415 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.34s]
[0m15:34:15.972988 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.33s]
[0m15:34:15.974466 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:34:15.975663 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:34:15.977338 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:34:15.978538 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:34:15.979399 [debug] [Thread-1 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:34:15.979972 [debug] [Thread-3 (]: Began running node model.spacex_dbt.fct_launches
[0m15:34:15.980629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:34:15.981709 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:34:15.982870 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:34:15.984035 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:34:15.985146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launches, now model.spacex_dbt.dim_launchpads)
[0m15:34:15.986401 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:34:15.991205 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:34:15.992269 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:34:15.993384 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:34:16.000670 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:34:16.008122 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:34:16.014533 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:34:16.078140 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:34:16.089417 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:34:16.099033 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:16.100535 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:34:16.101938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:16.103452 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:16.104471 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:34:16.105432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:16.137800 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m15:34:16.144756 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.043 seconds
[0m15:34:16.148316 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:16.153677 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:16.154843 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:34:16.155783 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:34:16.158020 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:16.158760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:34:16.160849 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:34:16.163485 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:34:16.164483 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:16.165564 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:16.166502 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:34:16.167751 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:34:16.315415 [debug] [Thread-2 (]: SQL status: COMMIT in 0.146 seconds
[0m15:34:16.316690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.145 seconds
[0m15:34:16.321434 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:34:16.328117 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:34:16.335759 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:16.337371 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:16.338454 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:34:16.339414 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:34:16.341074 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:34:16.341715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:34:16.343926 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:34:16.346591 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:34:16.347938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6b58faa0>]}
[0m15:34:16.349052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a7be1b-671a-4f0e-b0d6-6d94b57f1fe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6a5577a0>]}
[0m15:34:16.350108 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.37s]
[0m15:34:16.352903 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.36s]
[0m15:34:16.357034 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:34:16.358477 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:34:16.360173 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:34:16.361159 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:34:16.362096 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:34:16.362881 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:34:16.365867 [debug] [MainThread]: On master: COMMIT
[0m15:34:16.366855 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:16.367744 [debug] [MainThread]: On master: COMMIT
[0m15:34:16.368476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:16.389783 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m15:34:16.390779 [debug] [MainThread]: On master: Close
[0m15:34:16.391868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:16.395515 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:34:16.396660 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:34:16.397446 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:34:16.398456 [info ] [MainThread]: 
[0m15:34:16.399262 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m15:34:16.406202 [debug] [MainThread]: Command end result
[0m15:34:16.461636 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:16.470835 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:16.489386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:34:16.490213 [info ] [MainThread]: 
[0m15:34:16.491039 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:34:16.491823 [info ] [MainThread]: 
[0m15:34:16.492727 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:34:16.493587 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:16.494297 [info ] [MainThread]: 
[0m15:34:16.495112 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:16.495819 [info ] [MainThread]: 
[0m15:34:16.497445 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:34:16.506102 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.5504153, "process_in_blocks": "0", "process_kernel_time": 1.202302, "process_mem_max_rss": "162952", "process_out_blocks": "0", "process_user_time": 9.519603}
[0m15:34:16.507697 [debug] [MainThread]: Command `dbt build` failed at 15:34:16.507403 after 3.55 seconds
[0m15:34:16.508656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6d87fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6d3a0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e6e0bda00>]}
[0m15:34:16.509546 [debug] [MainThread]: Flushing usage events
[0m15:34:17.387197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:53.884959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c6744fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c62902c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c66e4800>]}


============================== 15:34:53.958817 | 3f2fcd89-58f0-4dda-b236-d8df8e3d2269 ==============================
[0m15:34:53.958817 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:34:53.960070 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_cache_events': 'False'}
[0m15:34:54.292336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c5c6ec60>]}
[0m15:34:54.411978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c66a6e40>]}
[0m15:34:54.413524 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:34:54.580006 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:34:54.860818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:54.861763 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:34:54.862596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:54.917805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c5af1d60>]}
[0m15:34:55.039520 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:55.046168 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:55.321672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c4e817c0>]}
[0m15:34:55.322612 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:34:55.326246 [info ] [MainThread]: 
[0m15:34:55.327023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:55.327732 [info ] [MainThread]: 
[0m15:34:55.328825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:34:55.335409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:55.336534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:55.337452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:34:55.431059 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:55.431761 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:55.432294 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:34:55.432808 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:55.433704 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:55.434666 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:55.435507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:55.436249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:55.437120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:55.458557 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:34:55.459288 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:34:55.461180 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:55.461782 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m15:34:55.463399 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:55.468760 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:34:55.475290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:34:55.476454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:34:55.477343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:34:55.486052 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:34:55.489255 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:34:55.492276 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:34:55.493360 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:34:55.494341 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:34:55.495147 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:34:55.496261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:55.497146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:55.497956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:55.526355 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m15:34:55.528570 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:34:55.529125 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.031 seconds
[0m15:34:55.530279 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:34:55.531014 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m15:34:55.533053 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:34:55.536949 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:34:55.538361 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:34:55.539121 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:34:55.550947 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:55.552072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:34:55.552888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:55.579270 [debug] [MainThread]: SQL status: SELECT 4 in 0.026 seconds
[0m15:34:55.581755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c4e82870>]}
[0m15:34:55.583046 [debug] [MainThread]: On master: ROLLBACK
[0m15:34:55.584059 [debug] [MainThread]: On master: COMMIT
[0m15:34:55.584745 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:55.585394 [debug] [MainThread]: On master: COMMIT
[0m15:34:55.586416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:34:55.587086 [debug] [MainThread]: On master: Close
[0m15:34:55.594998 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:34:55.595813 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:34:55.596450 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:34:55.597216 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:34:55.598123 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:34:55.599288 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:34:55.600184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:34:55.601094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:34:55.601884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:34:55.602935 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:34:55.603747 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:34:55.604480 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:34:55.616258 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:34:55.620379 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:34:55.626193 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:34:55.634079 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:34:55.645593 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:34:55.716053 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:34:55.716893 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:34:55.717579 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:34:55.723581 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:34:55.734016 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:34:55.734847 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:55.737168 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:34:55.738230 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:34:55.739373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:55.740100 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:55.740649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:55.741948 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:34:55.743773 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:55.762016 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:34:55.763221 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:34:55.767578 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:34:55.772550 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:34:55.774925 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m15:34:55.797684 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:55.802954 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:34:55.804025 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:55.806047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:55.806743 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:34:55.809441 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:55.814865 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:55.818547 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:34:55.819385 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:34:55.825566 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:55.826593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c2d67020>]}
[0m15:34:55.829251 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:55.830661 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:34:55.832359 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.22s]
[0m15:34:55.845784 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:55.857339 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:34:55.874593 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:34:55.875382 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:34:55.876809 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:34:55.877424 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:55.878211 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:55.879728 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:34:55.880544 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:34:55.884781 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:55.891627 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:34:55.904482 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:34:55.906126 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:34:55.916440 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:34:55.918296 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:34:55.919598 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:34:55.920495 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:34:55.926795 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:34:55.931274 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:34:55.932014 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m15:34:55.933007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c2d7ea50>]}
[0m15:34:55.937101 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:34:55.938482 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.33s]
[0m15:34:55.939919 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c2d7c440>]}
[0m15:34:55.940882 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:34:55.942486 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.34s]
[0m15:34:55.944184 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:34:55.945067 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:34:55.946795 [debug] [Thread-1 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:34:55.947457 [debug] [Thread-2 (]: Began running node model.spacex_dbt.fct_launches
[0m15:34:55.946200 [info ] [Thread-3 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:34:55.948425 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:34:55.949307 [info ] [Thread-2 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:34:55.950145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:34:55.950961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launches, now model.spacex_dbt.dim_rockets)
[0m15:34:55.951905 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:34:55.952681 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:34:55.953435 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:34:55.954303 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:34:55.958485 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:34:55.962612 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:34:55.969368 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:34:55.975474 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:34:56.029631 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:34:56.030195 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:34:56.037052 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:56.037974 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:56.038557 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:34:56.039384 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:34:56.040162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:56.040917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:56.065901 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:34:56.066681 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:34:56.075912 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:56.079708 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:56.080917 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:34:56.081829 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:34:56.083803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:56.084450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:56.088295 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:56.093784 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:56.094708 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:34:56.095895 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:34:56.097688 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:56.098293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:56.100412 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:34:56.102586 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:34:56.103541 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:56.104354 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:56.105182 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:34:56.105955 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:34:56.108673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:56.112633 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:34:56.113362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:34:56.118596 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:34:56.122375 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:34:56.123346 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:34:56.124683 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:34:56.125855 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:34:56.132043 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:34:56.132931 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:34:56.135259 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:34:56.137906 [debug] [Thread-1 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:34:56.139374 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c2d336e0>]}
[0m15:34:56.140393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f2fcd89-58f0-4dda-b236-d8df8e3d2269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c2d5ce90>]}
[0m15:34:56.141368 [info ] [Thread-3 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.19s]
[0m15:34:56.142806 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.19s]
[0m15:34:56.144186 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:34:56.145291 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:34:56.147748 [debug] [Thread-4 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:34:56.148973 [info ] [Thread-4 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:34:56.150117 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:34:56.151101 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:34:56.154076 [debug] [MainThread]: On master: COMMIT
[0m15:34:56.154949 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:56.155731 [debug] [MainThread]: On master: COMMIT
[0m15:34:56.156371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:56.170535 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:34:56.171826 [debug] [MainThread]: On master: Close
[0m15:34:56.173263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:56.175456 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:34:56.176162 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:34:56.176806 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:34:56.177625 [info ] [MainThread]: 
[0m15:34:56.178403 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:34:56.180802 [debug] [MainThread]: Command end result
[0m15:34:56.233098 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:56.240564 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:56.255522 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:34:56.256323 [info ] [MainThread]: 
[0m15:34:56.257120 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:34:56.257854 [info ] [MainThread]: 
[0m15:34:56.258674 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:34:56.259513 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:56.260256 [info ] [MainThread]: 
[0m15:34:56.261038 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:34:56.261739 [info ] [MainThread]: 
[0m15:34:56.262460 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:34:56.264114 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5102756, "process_in_blocks": "0", "process_kernel_time": 0.804395, "process_mem_max_rss": "162084", "process_out_blocks": "0", "process_user_time": 7.251621}
[0m15:34:56.265143 [debug] [MainThread]: Command `dbt build` failed at 15:34:56.264981 after 2.51 seconds
[0m15:34:56.266097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c63cfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c3b9cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7725c5bc1820>]}
[0m15:34:56.267225 [debug] [MainThread]: Flushing usage events
[0m15:34:56.907388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:34.911282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72ff731b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fcff11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fd7209e0>]}


============================== 15:35:34.993333 | d337b393-e8a5-41de-b710-c20f0cdb10e0 ==============================
[0m15:35:34.993333 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:35:34.994938 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False'}
[0m15:35:35.362535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fd58be90>]}
[0m15:35:35.499061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fc7b0b90>]}
[0m15:35:35.500600 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:35:35.669835 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:35:35.947582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:35.948563 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:35:35.949342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:35.997480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fc56cce0>]}
[0m15:35:36.116752 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:35:36.123912 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:35:36.391687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fbab1c40>]}
[0m15:35:36.392870 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:35:36.397161 [info ] [MainThread]: 
[0m15:35:36.398060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:36.398794 [info ] [MainThread]: 
[0m15:35:36.399924 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:36.407006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:35:36.416183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:35:36.417369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:35:36.505396 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:35:36.506266 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:35:36.506860 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:35:36.507367 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:35:36.508152 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:35:36.508978 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:35:36.509875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:36.510684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:36.511468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:36.536458 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m15:35:36.537094 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m15:35:36.539105 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:35:36.539818 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m15:35:36.541554 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:35:36.544673 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:35:36.548607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:35:36.549585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:35:36.564123 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:35:36.565024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:35:36.565547 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:35:36.566241 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:35:36.569697 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:35:36.570919 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:35:36.571936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:36.573306 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:35:36.574344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:36.576040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:36.602368 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.030 seconds
[0m15:35:36.603159 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:35:36.605077 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:35:36.605613 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.031 seconds
[0m15:35:36.607272 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:35:36.608500 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:35:36.610312 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:35:36.611586 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:35:36.613283 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:35:36.622247 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:36.623204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:35:36.623945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:36.650883 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m15:35:36.653020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fc99a090>]}
[0m15:35:36.653773 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:36.654565 [debug] [MainThread]: On master: COMMIT
[0m15:35:36.655202 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:36.655786 [debug] [MainThread]: On master: COMMIT
[0m15:35:36.656871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:35:36.657538 [debug] [MainThread]: On master: Close
[0m15:35:36.664818 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:35:36.665581 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:35:36.666277 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:35:36.667055 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:35:36.668094 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:35:36.668979 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:35:36.669774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:35:36.670677 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:35:36.671517 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:35:36.672394 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:35:36.673560 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:35:36.674592 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:35:36.689382 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:35:36.690171 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:35:36.696416 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:35:36.703450 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:35:36.704246 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:35:36.715752 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:35:36.818441 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:35:36.819188 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:35:36.821381 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:35:36.830149 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:35:36.831002 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:35:36.831727 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:35:36.832732 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:35:36.833761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:36.834554 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:35:36.835154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:36.836633 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:35:36.839565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:36.856897 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:35:36.864106 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m15:35:36.865370 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:35:36.866130 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:35:36.873451 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:35:36.891704 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:35:36.892969 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:35:36.898472 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:35:36.900645 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:35:36.901688 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:35:36.904746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f994b800>]}
[0m15:35:36.906886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:36.908677 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:35:36.908004 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.23s]
[0m15:35:36.915958 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:35:36.921467 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:35:36.922932 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:35:36.923781 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:35:36.924774 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:35:36.926116 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:35:36.928410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:36.929212 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:35:36.968590 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:35:36.969772 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:35:36.970341 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:35:36.971144 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:35:36.971910 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:35:36.972617 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:35:36.975379 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:35:36.981692 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:35:36.996103 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:35:36.999275 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:35:37.008590 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:35:37.010058 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:35:37.011103 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:35:37.011923 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:35:37.017830 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:35:37.018694 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:35:37.022171 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:35:37.024634 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:35:37.026058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f998a930>]}
[0m15:35:37.027613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f9987230>]}
[0m15:35:37.028679 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.36s]
[0m15:35:37.030056 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.36s]
[0m15:35:37.031297 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:35:37.032362 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:35:37.033928 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:35:37.034943 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:35:37.036143 [debug] [Thread-4 (]: Began running node model.spacex_dbt.fct_launches
[0m15:35:37.035620 [info ] [Thread-3 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:35:37.037089 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:35:37.037835 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:35:37.038645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:35:37.039403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:35:37.040154 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:35:37.040900 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:35:37.041635 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:35:37.042434 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:35:37.046525 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:35:37.050239 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:35:37.056729 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:35:37.062797 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:35:37.109324 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:35:37.113607 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:35:37.119962 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:35:37.120739 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:35:37.121375 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:35:37.121924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:37.122733 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:35:37.124019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:37.148562 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.024 seconds
[0m15:35:37.149304 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.027 seconds
[0m15:35:37.158779 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:35:37.162818 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:35:37.163839 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:35:37.164770 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:35:37.166876 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:37.167499 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:37.171564 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:35:37.177260 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:35:37.178077 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:35:37.178978 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:35:37.180751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:37.181360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:37.183738 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:35:37.185974 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:35:37.186934 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:35:37.187755 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:35:37.188525 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:35:37.189338 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:35:37.192139 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:35:37.195842 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:35:37.196423 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m15:35:37.201333 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:35:37.205262 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:35:37.206117 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:35:37.207441 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:35:37.208690 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:35:37.218359 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:35:37.221233 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:35:37.221927 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:35:37.223274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f99431d0>]}
[0m15:35:37.225459 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:35:37.226983 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.18s]
[0m15:35:37.228335 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd337b393-e8a5-41de-b710-c20f0cdb10e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f9968e60>]}
[0m15:35:37.229280 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:35:37.230578 [info ] [Thread-3 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.19s]
[0m15:35:37.232207 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:35:37.233088 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:35:37.234075 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:35:37.235388 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:35:37.236131 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:35:37.239250 [debug] [MainThread]: On master: COMMIT
[0m15:35:37.240036 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:37.240684 [debug] [MainThread]: On master: COMMIT
[0m15:35:37.241356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:37.256842 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:35:37.257818 [debug] [MainThread]: On master: Close
[0m15:35:37.258916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:37.262083 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:35:37.263097 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:35:37.263872 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:35:37.264772 [info ] [MainThread]: 
[0m15:35:37.265663 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m15:35:37.268121 [debug] [MainThread]: Command end result
[0m15:35:37.317313 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:35:37.324498 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:35:37.337319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:35:37.338012 [info ] [MainThread]: 
[0m15:35:37.338774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:37.339601 [info ] [MainThread]: 
[0m15:35:37.340407 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:35:37.341268 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:35:37.341962 [info ] [MainThread]: 
[0m15:35:37.342801 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:35:37.343455 [info ] [MainThread]: 
[0m15:35:37.344167 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:35:37.345686 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.580681, "process_in_blocks": "0", "process_kernel_time": 1.044904, "process_mem_max_rss": "162816", "process_out_blocks": "0", "process_user_time": 8.622549}
[0m15:35:37.346500 [debug] [MainThread]: Command `dbt build` failed at 15:35:37.346360 after 2.58 seconds
[0m15:35:37.347242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fd368ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72fdb82ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c72f994a3f0>]}
[0m15:35:37.347956 [debug] [MainThread]: Flushing usage events
[0m15:35:38.141596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:05.775945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f6ac3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f740dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f6ac3650>]}


============================== 15:36:05.897969 | c054bff4-ac85-4586-b6de-80ed334141a5 ==============================
[0m15:36:05.897969 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:36:05.899558 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'version_check': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True'}
[0m15:36:06.588403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f6e909e0>]}
[0m15:36:06.906771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f6b9f830>]}
[0m15:36:06.908612 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:36:07.289456 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:36:07.857355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:07.884690 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:36:07.886185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:07.993819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f5b903e0>]}
[0m15:36:08.247200 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:36:08.255762 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:36:08.736912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f5cb9c70>]}
[0m15:36:08.738037 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:36:08.742223 [info ] [MainThread]: 
[0m15:36:08.743197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:08.744143 [info ] [MainThread]: 
[0m15:36:08.752838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:08.760477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:08.761800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:08.763007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:08.903262 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:08.904203 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:08.904737 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:08.905265 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:08.906493 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:08.907484 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:08.908381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:08.909083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:08.909814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:08.941928 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.033 seconds
[0m15:36:08.952869 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.044 seconds
[0m15:36:08.985802 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.076 seconds
[0m15:36:08.988353 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:09.011252 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:09.030058 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:09.065713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:36:09.066744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:36:09.068201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:36:09.077740 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:36:09.080689 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:36:09.085457 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:36:09.102921 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:36:09.113372 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:36:09.115666 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:36:09.116649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:09.117325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:09.117993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:09.153429 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m15:36:09.156003 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:36:09.156820 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.039 seconds
[0m15:36:09.157764 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.040 seconds
[0m15:36:09.158224 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:36:09.160619 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:36:09.162755 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:36:09.165643 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:36:09.168069 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:36:09.180615 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:09.182223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:36:09.184064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:09.215503 [debug] [MainThread]: SQL status: SELECT 4 in 0.031 seconds
[0m15:36:09.218605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f4bbae70>]}
[0m15:36:09.219698 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:09.220856 [debug] [MainThread]: On master: COMMIT
[0m15:36:09.221712 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:09.222409 [debug] [MainThread]: On master: COMMIT
[0m15:36:09.223582 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:36:09.224326 [debug] [MainThread]: On master: Close
[0m15:36:09.237608 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:36:09.238412 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:36:09.239050 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:36:09.239827 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:36:09.241038 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:36:09.242036 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:36:09.243203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:36:09.244071 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:36:09.245001 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:36:09.246346 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:36:09.247565 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:36:09.248871 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:36:09.265570 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:36:09.268945 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:36:09.275404 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:36:09.284993 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:36:09.285949 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:36:09.298292 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:36:09.434227 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:36:09.443221 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:36:09.445642 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:36:09.563616 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:36:09.564597 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:09.566097 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_rockets" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:36:09.567506 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:36:09.568873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:09.569993 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:09.571065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:09.573481 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:36:09.575484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:09.592918 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_id" does not exist
LINE 9:     launch_id,
            ^

[0m15:36:09.597092 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:36:09.601142 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:36:09.604980 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m15:36:09.608379 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:09.622298 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m15:36:09.623630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f302e660>]}
[0m15:36:09.632642 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:09.635921 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:09.637886 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.38s]
[0m15:36:09.638957 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:36:09.639936 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:36:09.642498 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:36:09.644997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:09.645918 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:36:09.646621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:36:09.653780 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:09.664962 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:09.667621 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:36:09.668981 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:36:09.671272 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:09.672035 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:09.730414 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:36:09.734303 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:36:09.735913 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:09.737364 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:09.738444 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:36:09.739599 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:36:09.743633 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:36:09.749986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m15:36:09.763054 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:36:09.763855 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:36:09.777372 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:09.780315 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:09.782974 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:36:09.784312 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:36:09.793057 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:36:09.797284 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:36:09.798122 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m15:36:09.799503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f3bb4d10>]}
[0m15:36:09.810714 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:36:09.812179 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.55s]
[0m15:36:09.813682 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f3bb4e90>]}
[0m15:36:09.816028 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:36:09.817596 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.57s]
[0m15:36:09.821920 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:36:09.823208 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:36:09.826190 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:36:09.828683 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:36:09.829600 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:36:09.830440 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:36:09.831127 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:36:09.832568 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:36:09.834825 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:36:09.840221 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:36:09.841355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:36:09.842428 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:36:09.843930 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:36:09.845265 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:36:09.849642 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:36:09.859608 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:36:09.875237 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:36:09.939508 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:36:09.945638 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:36:09.956027 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:09.957129 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:36:09.958028 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:36:09.959112 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:09.960111 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:36:09.960973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:09.988611 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:36:09.995711 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m15:36:10.008903 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:10.009450 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:10.010106 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:36:10.010963 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:36:10.013086 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:10.013753 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:36:10.021591 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:10.026134 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:10.027127 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:36:10.028455 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:36:10.030352 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:10.030958 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:10.033345 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:36:10.036761 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:36:10.037923 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:10.038792 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:10.039597 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:36:10.040357 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:36:10.047199 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m15:36:10.048150 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m15:36:10.052745 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:36:10.056763 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:36:10.062365 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:10.063611 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:10.064475 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:36:10.066218 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:36:10.073947 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:36:10.074809 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:36:10.076875 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:36:10.079007 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:36:10.080525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f3bbcb60>]}
[0m15:36:10.085203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c054bff4-ac85-4586-b6de-80ed334141a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f3033ad0>]}
[0m15:36:10.086726 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.24s]
[0m15:36:10.089093 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.26s]
[0m15:36:10.090366 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:36:10.091515 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:36:10.093620 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:36:10.094705 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:36:10.095604 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:36:10.096462 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:36:10.099381 [debug] [MainThread]: On master: COMMIT
[0m15:36:10.100501 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:10.101897 [debug] [MainThread]: On master: COMMIT
[0m15:36:10.102829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:10.121680 [debug] [MainThread]: SQL status: COMMIT in 0.019 seconds
[0m15:36:10.122770 [debug] [MainThread]: On master: Close
[0m15:36:10.123702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:10.124372 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:36:10.124979 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:36:10.125579 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:36:10.126179 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:36:10.127578 [info ] [MainThread]: 
[0m15:36:10.128542 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m15:36:10.131079 [debug] [MainThread]: Command end result
[0m15:36:10.192499 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:36:10.201098 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:36:10.221595 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:36:10.222533 [info ] [MainThread]: 
[0m15:36:10.223371 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:36:10.224310 [info ] [MainThread]: 
[0m15:36:10.225238 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:36:10.226290 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_id" does not exist
  LINE 9:     launch_id,
              ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:10.227089 [info ] [MainThread]: 
[0m15:36:10.227992 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:10.228807 [info ] [MainThread]: 
[0m15:36:10.229570 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:36:10.231305 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.6993012, "process_in_blocks": "0", "process_kernel_time": 1.600889, "process_mem_max_rss": "163892", "process_out_blocks": "0", "process_user_time": 12.121024}
[0m15:36:10.232406 [debug] [MainThread]: Command `dbt build` failed at 15:36:10.232210 after 4.70 seconds
[0m15:36:10.233257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f740dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f6ac3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef0f306f9e0>]}
[0m15:36:10.234816 [debug] [MainThread]: Flushing usage events
[0m15:36:10.873088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:48.281474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74f81c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74f81c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74eecaf00>]}


============================== 15:36:48.359672 | d506d4b0-8c06-47bb-bea3-264659d6d199 ==============================
[0m15:36:48.359672 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:36:48.361114 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True'}
[0m15:36:48.711933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74edb8500>]}
[0m15:36:48.837782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74f09d430>]}
[0m15:36:48.839498 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:36:49.007978 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:36:49.273186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:49.274446 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:36:49.855162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74d3f6c60>]}
[0m15:36:50.005019 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:36:50.011969 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:36:50.279937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74d3fa3c0>]}
[0m15:36:50.280924 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:36:50.284630 [info ] [MainThread]: 
[0m15:36:50.285465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:50.286268 [info ] [MainThread]: 
[0m15:36:50.287292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:50.293727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:50.294823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:50.312296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:36:50.386869 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:50.387549 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:50.388077 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:36:50.388613 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:50.389645 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:50.390366 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:36:50.391082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:50.391779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:50.392422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:50.423757 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m15:36:50.428064 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.037 seconds
[0m15:36:50.432938 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:50.436132 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:50.448725 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.057 seconds
[0m15:36:50.498503 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:36:50.501795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:36:50.502872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:36:50.503848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:36:50.514655 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:36:50.517853 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:36:50.520908 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:36:50.522007 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:36:50.522867 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:36:50.523731 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:36:50.524546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:50.525598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:50.526360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:50.556760 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.032 seconds
[0m15:36:50.559125 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:36:50.559802 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.034 seconds
[0m15:36:50.561540 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:36:50.563611 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:36:50.564216 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.038 seconds
[0m15:36:50.566011 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:36:50.567926 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:36:50.569575 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:36:50.577190 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:50.578129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:36:50.578855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:50.604464 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m15:36:50.606764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74e46d040>]}
[0m15:36:50.607564 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:50.608387 [debug] [MainThread]: On master: COMMIT
[0m15:36:50.608992 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:50.609607 [debug] [MainThread]: On master: COMMIT
[0m15:36:50.610502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:36:50.611093 [debug] [MainThread]: On master: Close
[0m15:36:50.617819 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:36:50.618597 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:36:50.619213 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:36:50.620007 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:36:50.620944 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:36:50.622375 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:36:50.623212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:36:50.623981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:36:50.624780 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:36:50.625936 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:36:50.626713 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:36:50.627553 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:36:50.638245 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:36:50.643535 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:36:50.647539 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:36:50.655574 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:36:50.656369 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:36:50.662427 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:36:50.795607 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:36:50.793017 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:36:50.800831 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:36:50.810793 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:36:50.811717 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:50.812515 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launches.sql
select
    launch_id,
    rocket_id,
    launch_date,
    mission
from "spacex_db"."public"."silver_launches" -- A tabela silver_rockets, agora no schema correto
  );
[0m15:36:50.814941 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:36:50.816160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:50.817048 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:50.817826 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:36:50.825890 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:36:50.833384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:50.843556 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_date" does not exist
LINE 11:     launch_date,
             ^

[0m15:36:50.848723 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:36:50.859789 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:36:50.863650 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m15:36:50.877094 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_date" does not exist
  LINE 11:     launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:50.906543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74ab3f950>]}
[0m15:36:50.903455 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:50.920651 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:36:50.911711 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.28s]
[0m15:36:50.884290 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m15:36:50.938726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:36:50.955057 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:36:50.975441 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:50.990687 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:50.994728 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_date" does not exist
  LINE 11:     launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:36:51.000630 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:36:51.002237 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:36:51.009229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.011103 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.016313 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:51.032341 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:36:51.044875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:36:51.065852 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:36:51.066952 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:36:51.067595 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:51.068416 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:51.069203 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:36:51.070004 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:36:51.073787 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:36:51.154285 [debug] [Thread-3 (]: SQL status: COMMIT in 0.083 seconds
[0m15:36:51.167898 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:36:51.168565 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:36:51.177599 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:36:51.178600 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:36:51.179589 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:36:51.181176 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:36:51.187206 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:36:51.190894 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:36:51.191509 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:36:51.192495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74cb48dd0>]}
[0m15:36:51.197105 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:36:51.198839 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.57s]
[0m15:36:51.200841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74cfe5580>]}
[0m15:36:51.201859 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:36:51.203141 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.58s]
[0m15:36:51.204917 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:36:51.205624 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:36:51.206938 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:36:51.207742 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:36:51.208330 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:36:51.209075 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:36:51.210135 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:36:51.211059 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:36:51.212007 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:36:51.212971 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:36:51.214022 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:36:51.218368 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:36:51.219286 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:36:51.220229 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:36:51.224745 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:36:51.232507 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:36:51.239086 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:36:51.291550 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:36:51.292573 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:36:51.301555 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:51.302695 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:51.303302 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:36:51.304159 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:36:51.305007 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:36:51.305844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:36:51.330641 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.025 seconds
[0m15:36:51.331492 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:36:51.341142 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:51.345231 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:51.346751 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:36:51.347828 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:36:51.349800 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.350582 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.357307 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:51.361548 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:51.362462 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:36:51.363546 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:36:51.365396 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.365960 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:51.368111 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:36:51.370413 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:36:51.371333 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:51.372318 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:51.373200 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:36:51.374072 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:36:51.376897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:36:51.382184 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:36:51.383003 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m15:36:51.388116 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:36:51.391807 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:36:51.392782 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:36:51.394250 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:36:51.395465 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:36:51.401918 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:36:51.402816 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:36:51.404968 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:36:51.407158 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:36:51.408473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74d68b8c0>]}
[0m15:36:51.409356 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd506d4b0-8c06-47bb-bea3-264659d6d199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74cfe5280>]}
[0m15:36:51.410425 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.20s]
[0m15:36:51.411857 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.20s]
[0m15:36:51.413207 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:36:51.417404 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:36:51.419379 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:36:51.420587 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:36:51.421569 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:36:51.422389 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:36:51.425306 [debug] [MainThread]: On master: COMMIT
[0m15:36:51.426127 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:51.426806 [debug] [MainThread]: On master: COMMIT
[0m15:36:51.427441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:51.440871 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:36:51.441959 [debug] [MainThread]: On master: Close
[0m15:36:51.443001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:51.443707 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:36:51.444369 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:36:51.445142 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:36:51.446107 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:36:51.447175 [info ] [MainThread]: 
[0m15:36:51.448283 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:36:51.451556 [debug] [MainThread]: Command end result
[0m15:36:51.518565 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:36:51.526132 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:36:51.540582 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:36:51.541361 [info ] [MainThread]: 
[0m15:36:51.542140 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:36:51.542857 [info ] [MainThread]: 
[0m15:36:51.543713 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:36:51.544565 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_date" does not exist
  LINE 11:     launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:51.545278 [info ] [MainThread]: 
[0m15:36:51.546161 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:36:51.546925 [info ] [MainThread]: 
[0m15:36:51.547779 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:36:51.549468 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.3938673, "process_in_blocks": "0", "process_kernel_time": 0.998921, "process_mem_max_rss": "168668", "process_out_blocks": "0", "process_user_time": 8.627812}
[0m15:36:51.550368 [debug] [MainThread]: Command `dbt build` failed at 15:36:51.550229 after 3.40 seconds
[0m15:36:51.551112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74f034bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74ea8c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce74ab64140>]}
[0m15:36:51.551791 [debug] [MainThread]: Flushing usage events
[0m15:36:52.390207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:28.826379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8246f7d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c824761e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8247557230>]}


============================== 15:37:28.895978 | dec34be6-776a-4039-96de-2133695259e6 ==============================
[0m15:37:28.895978 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:37:28.897228 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True'}
[0m15:37:29.264702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8246dd7470>]}
[0m15:37:29.400596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8246f84b90>]}
[0m15:37:29.402147 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:37:29.553958 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:37:29.814142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:29.815411 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:37:30.312969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8245dfade0>]}
[0m15:37:30.460108 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:37:30.468613 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:37:30.725163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8245df6210>]}
[0m15:37:30.726128 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:37:30.729652 [info ] [MainThread]: 
[0m15:37:30.730435 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:30.731137 [info ] [MainThread]: 
[0m15:37:30.732056 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:30.738015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:37:30.744540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:37:30.745777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:37:30.848665 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:37:30.849476 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:37:30.849945 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:37:30.850486 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:37:30.851015 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:37:30.851797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.852505 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:37:30.853264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.854437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.877444 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m15:37:30.880868 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:37:30.888867 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.037 seconds
[0m15:37:30.891006 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:37:30.891525 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.037 seconds
[0m15:37:30.893814 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:37:30.898656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:37:30.899627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:37:30.905845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:37:30.909126 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:37:30.912127 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:37:30.914789 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:37:30.915553 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:37:30.916460 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:37:30.917282 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:37:30.917949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:30.918608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:30.919275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:30.943118 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.025 seconds
[0m15:37:30.943789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m15:37:30.944343 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:37:30.946096 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:37:30.947855 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:37:30.949809 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:37:30.951140 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:37:30.951678 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:37:30.952410 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:37:30.963035 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.963963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:37:30.964672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:30.989065 [debug] [MainThread]: SQL status: SELECT 4 in 0.024 seconds
[0m15:37:30.991255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c824591fad0>]}
[0m15:37:30.992329 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:30.993265 [debug] [MainThread]: On master: COMMIT
[0m15:37:30.993865 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:30.994435 [debug] [MainThread]: On master: COMMIT
[0m15:37:30.995376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:30.995961 [debug] [MainThread]: On master: Close
[0m15:37:31.003761 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:37:31.004974 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:37:31.005573 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:37:31.006383 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:37:31.007612 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:37:31.008614 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:37:31.009605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:37:31.010405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:37:31.011208 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:37:31.012021 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:37:31.013128 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:37:31.013982 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:37:31.025185 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:37:31.031367 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:37:31.035550 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:37:31.043405 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:37:31.044139 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:37:31.050202 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:37:31.162391 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:37:31.163342 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:37:31.164179 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:37:31.170605 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:37:31.171273 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:37:31.171960 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:37:31.172957 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:37:31.173777 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:31.174464 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:37:31.175008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:31.176297 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:37:31.177656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:37:31.191399 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:37:31.192796 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:37:31.194796 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:37:31.197593 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m15:37:31.208502 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m15:37:31.223811 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:37:31.222159 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:37:31.225188 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:37:31.228313 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:37:31.229204 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:37:31.233307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c824613b7a0>]}
[0m15:37:31.234145 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:37:31.235406 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.22s]
[0m15:37:31.240628 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:37:31.242481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m15:37:31.243543 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:37:31.244958 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:37:31.251568 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:37:31.252741 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:37:31.253780 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:37:31.254455 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.257046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.446979 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:37:31.449282 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:37:31.449902 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:37:31.450716 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:37:31.451448 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:37:31.452207 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:37:31.454874 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:37:31.465134 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:37:31.465872 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m15:37:31.474765 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:37:31.478049 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:37:31.478948 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:37:31.480130 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:37:31.481400 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:37:31.485881 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:37:31.489523 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:37:31.490165 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:37:31.491098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8249d436e0>]}
[0m15:37:31.493040 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:37:31.494334 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.48s]
[0m15:37:31.495655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8243560650>]}
[0m15:37:31.496587 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:37:31.497833 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.49s]
[0m15:37:31.499180 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:37:31.500021 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:37:31.501099 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:37:31.502533 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:37:31.503231 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:37:31.503846 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:37:31.504419 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:37:31.505424 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:37:31.506398 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:37:31.510633 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:37:31.511518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:37:31.512382 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:37:31.513760 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:37:31.514993 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:37:31.518492 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:37:31.524462 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:37:31.525348 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:37:31.586006 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:37:31.586962 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:37:31.594293 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:37:31.595207 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:37:31.595858 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:37:31.596409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:37:31.597281 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:37:31.598548 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:37:31.621798 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.025 seconds
[0m15:37:31.628763 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:37:31.632172 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:37:31.636571 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:37:31.637612 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:37:31.638465 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:37:31.640272 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.646930 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:37:31.647468 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:37:31.652316 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:37:31.653417 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:37:31.654261 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:37:31.656019 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:37:31.658608 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:37:31.659266 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:37:31.659907 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:37:31.662626 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:37:31.663717 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:37:31.664749 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:37:31.666360 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:37:31.668275 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:37:31.671993 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:37:31.672593 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m15:37:31.677263 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:37:31.680813 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:37:31.681925 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:37:31.683170 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:37:31.688060 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:37:31.689757 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:37:31.692232 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:37:31.693525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c824702c710>]}
[0m15:37:31.695014 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:37:31.697323 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.18s]
[0m15:37:31.699671 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:37:31.700885 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:37:31.702172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dec34be6-776a-4039-96de-2133695259e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8243561a60>]}
[0m15:37:31.703587 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.20s]
[0m15:37:31.704800 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:37:31.706623 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:37:31.707472 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:37:31.708370 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:37:31.709201 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:37:31.713200 [debug] [MainThread]: On master: COMMIT
[0m15:37:31.714010 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:31.714650 [debug] [MainThread]: On master: COMMIT
[0m15:37:31.715292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:31.728570 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:37:31.729525 [debug] [MainThread]: On master: Close
[0m15:37:31.730477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:31.731280 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:37:31.732012 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:37:31.732699 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:37:31.733335 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:37:31.734175 [info ] [MainThread]: 
[0m15:37:31.734905 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m15:37:31.737288 [debug] [MainThread]: Command end result
[0m15:37:31.786040 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:37:31.793319 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:37:31.806752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:37:31.807495 [info ] [MainThread]: 
[0m15:37:31.808264 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:31.809014 [info ] [MainThread]: 
[0m15:37:31.809834 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:37:31.810665 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:37:31.811358 [info ] [MainThread]: 
[0m15:37:31.812125 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:37:31.812812 [info ] [MainThread]: 
[0m15:37:31.813815 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:37:31.815373 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.1228645, "process_in_blocks": "0", "process_kernel_time": 0.80562, "process_mem_max_rss": "167460", "process_out_blocks": "0", "process_user_time": 7.854795}
[0m15:37:31.816208 [debug] [MainThread]: Command `dbt build` failed at 15:37:31.816069 after 3.12 seconds
[0m15:37:31.816971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c824b7dec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82480a6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82469caf90>]}
[0m15:37:31.817677 [debug] [MainThread]: Flushing usage events
[0m15:37:32.453411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:54.358722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe2943530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe2004a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe2983260>]}


============================== 15:38:54.433680 | 4cccbe8a-91d3-426f-8678-115b710257f3 ==============================
[0m15:38:54.433680 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:38:54.434841 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'fail_fast': 'False'}
[0m15:38:54.930073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe1ecfe60>]}
[0m15:38:55.181569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe2a64770>]}
[0m15:38:55.185186 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:38:55.431266 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:38:55.771089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:55.772005 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:38:55.772698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:55.840681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe1d4df40>]}
[0m15:38:56.002871 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:38:56.013217 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:38:56.363882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe1b45b80>]}
[0m15:38:56.365127 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:38:56.369042 [info ] [MainThread]: 
[0m15:38:56.369947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:38:56.370740 [info ] [MainThread]: 
[0m15:38:56.371774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:38:56.383741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:38:56.393076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:38:56.394455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:38:56.514397 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:38:56.515156 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:38:56.515821 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:38:56.516435 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:38:56.517281 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:38:56.518060 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:38:56.518786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:56.519546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:56.520361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:56.553665 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m15:38:56.556477 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:38:56.562988 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m15:38:56.563971 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m15:38:56.565882 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:38:56.567843 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:38:56.570001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_staging)
[0m15:38:56.570673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_marts)
[0m15:38:56.572466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_gold)
[0m15:38:56.573265 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_staging"
"
[0m15:38:56.574268 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_marts"
"
[0m15:38:56.575278 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_gold"
"
[0m15:38:56.585003 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:38:56.588450 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:38:56.591831 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:38:56.593655 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m15:38:56.595372 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_marts"} */
create schema if not exists "analytics_analytics_marts"
[0m15:38:56.596525 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_gold"} */
create schema if not exists "analytics_analytics_gold"
[0m15:38:56.597496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.598314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.599064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.620869 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.022 seconds
[0m15:38:56.624271 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:38:56.626981 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.029 seconds
[0m15:38:56.629345 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:38:56.630190 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.033 seconds
[0m15:38:56.631777 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:38:56.632737 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:38:56.634355 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:38:56.635380 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:38:56.636721 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:38:56.637513 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:38:56.638251 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:38:56.639272 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:38:56.640410 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: Close
[0m15:38:56.641184 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:38:56.642424 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: Close
[0m15:38:56.643021 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:38:56.685336 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: Close
[0m15:38:56.706467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_staging, now list_spacex_db_analytics_analytics_staging)
[0m15:38:56.707521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_marts, now list_spacex_db_analytics_analytics_marts)
[0m15:38:56.708430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_gold, now list_spacex_db_analytics_analytics_gold)
[0m15:38:56.737161 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:38:56.740352 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:38:56.744486 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:38:56.745768 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:38:56.746792 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:38:56.753235 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:38:56.754524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.756865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.758065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:56.792310 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m15:38:56.796571 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:38:56.800380 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:38:56.805191 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m15:38:56.806009 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m15:38:56.807718 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:38:56.809533 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:38:56.810780 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:38:56.813118 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:38:56.826027 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:56.827514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:38:56.831182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:56.861536 [debug] [MainThread]: SQL status: SELECT 2 in 0.030 seconds
[0m15:38:56.864018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe072a120>]}
[0m15:38:56.865339 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:56.866499 [debug] [MainThread]: On master: COMMIT
[0m15:38:56.867226 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:56.867901 [debug] [MainThread]: On master: COMMIT
[0m15:38:56.869101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:56.869975 [debug] [MainThread]: On master: Close
[0m15:38:56.881832 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:38:56.882665 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:38:56.883356 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:38:56.884179 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:38:56.885349 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:38:56.886539 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:38:56.887579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:38:56.888508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:38:56.889301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:38:56.890177 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:38:56.891046 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:38:56.891895 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:38:56.907008 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:38:56.910156 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:38:56.915279 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:38:56.924038 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:38:56.924771 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:38:56.930829 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:38:57.054623 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:38:57.055565 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:38:57.057247 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:38:57.067257 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:38:57.068934 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:38:57.069785 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:38:57.070572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:57.071842 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:38:57.072563 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:38:57.073855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:57.074720 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:38:57.077447 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:38:57.094004 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:38:57.095631 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:38:57.099751 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:38:57.108369 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:38:57.109224 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.035 seconds
[0m15:38:57.112001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe1d4f1d0>]}
[0m15:38:57.118782 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m15:38:57.124051 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:38:57.125420 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.22s]
[0m15:38:57.133432 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:38:57.134109 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:38:57.135308 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:38:57.136435 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:38:57.138191 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:38:57.138789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:57.140325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:57.185269 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:38:57.187333 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:38:57.188091 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:38:57.189329 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:38:57.190300 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:38:57.191080 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:38:57.195802 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:38:57.202163 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m15:38:57.211780 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:38:57.208035 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:38:57.226192 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:38:57.227326 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:38:57.228423 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:38:57.230074 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:38:57.232457 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:38:57.233278 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:38:57.236914 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:38:57.239387 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:38:57.240895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fdf0f1970>]}
[0m15:38:57.241872 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fdef55e80>]}
[0m15:38:57.244777 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.35s]
[0m15:38:57.247961 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.35s]
[0m15:38:57.249869 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:38:57.251104 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:38:57.253288 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:38:57.254530 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:38:57.255234 [debug] [Thread-4 (]: Began running node model.spacex_dbt.fct_launches
[0m15:38:57.256142 [info ] [Thread-3 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:38:57.257195 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:38:57.258237 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:38:57.259161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:38:57.260119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:38:57.261010 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:38:57.263316 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:38:57.264874 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:38:57.266154 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:38:57.270633 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:38:57.274847 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:38:57.285669 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:38:57.293073 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:38:57.364752 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:38:57.367741 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:38:57.374954 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:38:57.375921 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:38:57.376729 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:38:57.377620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:57.378681 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:38:57.383287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:38:57.418184 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m15:38:57.429050 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.051 seconds
[0m15:38:57.441074 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:38:57.441933 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:38:57.442591 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:38:57.444342 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:38:57.446962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:57.450539 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:38:57.451474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:38:57.452226 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:38:57.454459 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:38:57.455291 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:38:57.456210 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:38:57.457478 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:38:57.458805 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:38:57.462609 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:38:57.463431 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m15:38:57.470294 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:38:57.474127 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:38:57.475112 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:38:57.476452 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:38:57.478001 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:38:57.478716 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:38:57.482032 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:38:57.483943 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fdef7b890>]}
[0m15:38:57.484692 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:38:57.487893 [info ] [Thread-3 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.22s]
[0m15:38:57.490469 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:38:57.491823 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:38:57.493260 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cccbe8a-91d3-426f-8678-115b710257f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fdf07eab0>]}
[0m15:38:57.499480 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.23s]
[0m15:38:57.501011 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:38:57.503029 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:38:57.503969 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:38:57.504834 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:38:57.505646 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:38:57.508382 [debug] [MainThread]: On master: COMMIT
[0m15:38:57.509182 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:57.509830 [debug] [MainThread]: On master: COMMIT
[0m15:38:57.510572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:57.525256 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:38:57.526199 [debug] [MainThread]: On master: Close
[0m15:38:57.527168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:57.527977 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:38:57.530189 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:38:57.531243 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:38:57.532565 [info ] [MainThread]: 
[0m15:38:57.533420 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:38:57.536480 [debug] [MainThread]: Command end result
[0m15:38:57.589821 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:38:57.599634 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:38:57.614080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:38:57.614963 [info ] [MainThread]: 
[0m15:38:57.615980 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:38:57.616887 [info ] [MainThread]: 
[0m15:38:57.617839 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:38:57.618752 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:38:57.619468 [info ] [MainThread]: 
[0m15:38:57.620528 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:38:57.621276 [info ] [MainThread]: 
[0m15:38:57.622152 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:38:57.624260 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.4252741, "process_in_blocks": "0", "process_kernel_time": 1.106064, "process_mem_max_rss": "162972", "process_out_blocks": "0", "process_user_time": 9.072167}
[0m15:38:57.625276 [debug] [MainThread]: Command `dbt build` failed at 15:38:57.625099 after 3.43 seconds
[0m15:38:57.626110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe2a5f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fe1a50620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798fdf0e6ea0>]}
[0m15:38:57.627321 [debug] [MainThread]: Flushing usage events
[0m15:38:58.615185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:34.445145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b729c16b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b729c14680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b729c14080>]}


============================== 15:39:34.509928 | 7615be8e-90d7-4403-85ea-d57701553fb6 ==============================
[0m15:39:34.509928 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:39:34.511113 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/app/dbt/logs'}
[0m15:39:34.822925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72c274680>]}
[0m15:39:34.942114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72a1adbb0>]}
[0m15:39:34.943653 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:39:35.102243 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:39:35.356990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:35.357867 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:39:35.358697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:35.409441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b7292a9640>]}
[0m15:39:35.528241 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:39:35.535065 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:39:35.793116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b7291219d0>]}
[0m15:39:35.794029 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:39:35.797673 [info ] [MainThread]: 
[0m15:39:35.798461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:35.799246 [info ] [MainThread]: 
[0m15:39:35.800340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:35.807690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:39:35.819005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:39:35.836865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:39:35.915898 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:39:35.916571 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:39:35.917112 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:39:35.917658 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:39:35.918478 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:39:35.919195 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:39:35.919959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:35.920561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:35.921247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:35.944786 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m15:39:35.947107 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:39:35.948342 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m15:39:35.950454 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:39:35.951970 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m15:39:35.955762 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:39:35.958916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:39:35.960441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:39:35.966803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:39:35.970005 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:39:35.972640 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:39:35.975418 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:39:35.976180 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:39:35.976978 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:39:35.977836 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:39:35.978712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:35.979395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:35.980164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:36.004705 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.024 seconds
[0m15:39:36.005402 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:39:36.007550 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:39:36.008180 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.029 seconds
[0m15:39:36.009749 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:39:36.010901 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:39:36.012437 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:39:36.013468 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:39:36.015042 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:39:36.025335 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:36.026413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:39:36.027217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:36.051747 [debug] [MainThread]: SQL status: SELECT 4 in 0.024 seconds
[0m15:39:36.054601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b7290ee810>]}
[0m15:39:36.055738 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:36.056807 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.057533 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:36.058229 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.059392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:36.060052 [debug] [MainThread]: On master: Close
[0m15:39:36.066567 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:39:36.067298 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:39:36.068118 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:39:36.068859 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:39:36.069545 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:39:36.070553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:39:36.071538 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:39:36.072341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:39:36.073142 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:39:36.073940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:39:36.075002 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:39:36.085647 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:39:36.086346 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:39:36.090148 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:39:36.097496 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:39:36.103542 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:39:36.104261 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:39:36.104906 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:39:36.215871 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:39:36.216814 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:39:36.220107 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:39:36.227697 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:39:36.228395 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:39:36.229019 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:39:36.229890 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:39:36.230674 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:39:36.231232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:39:36.232028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:39:36.232816 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:39:36.235943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:36.252281 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:39:36.260276 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:39:36.264952 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:39:36.265595 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m15:39:36.266189 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:39:36.267433 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:39:36.272675 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:39:36.274758 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:39:36.276182 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:39:36.276901 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.282718 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:39:36.289336 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:39:36.290246 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:39:36.293379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72643f7a0>]}
[0m15:39:36.294107 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:39:36.298886 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:39:36.300202 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.22s]
[0m15:39:36.301650 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:39:36.302425 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.303345 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:39:36.316134 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:39:36.317146 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:39:36.346382 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:39:36.351314 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:39:36.352272 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:39:36.353171 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:39:36.355500 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:39:36.356563 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:39:36.359571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:36.370953 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m15:39:36.378550 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:39:36.380039 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:39:36.389800 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:39:36.390929 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:39:36.392571 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:39:36.393800 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:39:36.400405 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:39:36.404201 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:39:36.404965 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:39:36.406224 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72644e4e0>]}
[0m15:39:36.408241 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:39:36.409563 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.33s]
[0m15:39:36.410705 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72644eed0>]}
[0m15:39:36.411573 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:39:36.412774 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.34s]
[0m15:39:36.414560 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:39:36.415207 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:39:36.416393 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:39:36.417157 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:39:36.417748 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:39:36.418501 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:39:36.419550 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:39:36.420547 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:39:36.421314 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:39:36.422148 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:39:36.423034 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:39:36.427306 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:39:36.428142 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:39:36.429006 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:39:36.432717 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:39:36.438166 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:39:36.438936 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:39:36.495317 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:39:36.496228 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:39:36.503064 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:39:36.504000 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:39:36.504568 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:39:36.505380 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:39:36.506198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:39:36.507165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:39:36.531522 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.024 seconds
[0m15:39:36.532294 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:39:36.541611 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:39:36.545436 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:39:36.546479 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:39:36.547361 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:39:36.549153 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.553710 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:39:36.554366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:39:36.554952 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:39:36.560658 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:39:36.562498 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.563057 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:39:36.565328 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:39:36.567002 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:39:36.567854 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.568684 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:39:36.571527 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:39:36.572982 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:39:36.573751 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:39:36.574572 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:36.578230 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:39:36.578876 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:39:36.583812 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:39:36.587380 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:39:36.588251 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:39:36.589672 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:39:36.594510 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:39:36.596224 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:39:36.598603 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:39:36.599977 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b7265f78c0>]}
[0m15:39:36.601286 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:39:36.603045 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.18s]
[0m15:39:36.605561 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:39:36.606795 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:39:36.608029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7615be8e-90d7-4403-85ea-d57701553fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b726439250>]}
[0m15:39:36.609343 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.19s]
[0m15:39:36.610738 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:39:36.612451 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:39:36.613303 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:39:36.614176 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:39:36.614942 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:39:36.617715 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.618423 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:36.619067 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.619681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:36.633659 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:39:36.634689 [debug] [MainThread]: On master: Close
[0m15:39:36.635739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:36.638683 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:39:36.639511 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:39:36.640134 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:39:36.640753 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:39:36.641581 [info ] [MainThread]: 
[0m15:39:36.642453 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m15:39:36.644884 [debug] [MainThread]: Command end result
[0m15:39:36.694779 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:39:36.701610 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:39:36.714675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:39:36.715402 [info ] [MainThread]: 
[0m15:39:36.716163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:39:36.716926 [info ] [MainThread]: 
[0m15:39:36.717807 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:39:36.718653 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:39:36.719315 [info ] [MainThread]: 
[0m15:39:36.720168 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:39:36.720882 [info ] [MainThread]: 
[0m15:39:36.721590 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:39:36.723255 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.402377, "process_in_blocks": "0", "process_kernel_time": 0.741579, "process_mem_max_rss": "164492", "process_out_blocks": "0", "process_user_time": 6.506759}
[0m15:39:36.724051 [debug] [MainThread]: Command `dbt build` failed at 15:39:36.723912 after 2.40 seconds
[0m15:39:36.724842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b729f2a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72aa40dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b72a79f6e0>]}
[0m15:39:36.725545 [debug] [MainThread]: Flushing usage events
[0m15:39:37.568884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:13.357838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762087914b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620879142c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762087914920>]}


============================== 15:40:13.428592 | be463649-0307-4b46-8d3d-a95dcc1832c5 ==============================
[0m15:40:13.428592 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:40:13.429725 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'version_check': 'True'}
[0m15:40:13.779183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762087d67290>]}
[0m15:40:13.910552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762087fe21e0>]}
[0m15:40:13.912606 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:40:14.074238 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:40:14.345452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:14.346350 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:40:14.346954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:14.401531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762088310230>]}
[0m15:40:14.518026 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:40:14.524779 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:40:14.796351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620863ca4b0>]}
[0m15:40:14.797307 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:40:14.800847 [info ] [MainThread]: 
[0m15:40:14.801575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:14.802229 [info ] [MainThread]: 
[0m15:40:14.803158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:14.809166 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:14.810147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:14.816571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:14.904394 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:14.905102 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:14.905756 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:14.906236 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:14.907143 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:14.908112 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:14.908913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:14.909698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:14.910511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:14.932017 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:40:14.932660 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m15:40:14.933257 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m15:40:14.935255 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:14.937320 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:14.939058 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:14.949376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:40:14.950377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:40:14.956591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:40:14.959796 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:40:14.962499 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:40:14.965391 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:40:14.966225 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:40:14.967109 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:40:14.968036 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:40:14.968846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:14.969611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:14.970357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:14.994784 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:40:14.995458 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.025 seconds
[0m15:40:14.997559 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:40:14.998455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.029 seconds
[0m15:40:15.000256 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:40:15.001366 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:40:15.002860 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:40:15.003893 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:40:15.005684 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:40:15.013785 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:15.014770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:40:15.015667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:15.042663 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m15:40:15.044995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620863fff20>]}
[0m15:40:15.045832 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:15.046716 [debug] [MainThread]: On master: COMMIT
[0m15:40:15.047413 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:15.048125 [debug] [MainThread]: On master: COMMIT
[0m15:40:15.049106 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:40:15.049793 [debug] [MainThread]: On master: Close
[0m15:40:15.056683 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:40:15.057432 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:40:15.058031 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:40:15.058765 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:40:15.059781 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:40:15.060713 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:40:15.061609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:40:15.062407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:40:15.063217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:40:15.064080 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:40:15.065117 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:40:15.065961 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:40:15.080403 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:40:15.077124 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:40:15.085860 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:40:15.093082 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:40:15.093824 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:40:15.105268 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:40:15.205595 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:40:15.206545 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:40:15.210639 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:40:15.220047 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:15.220809 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:40:15.221455 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:40:15.222458 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:40:15.223451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:15.224200 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:15.224746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:15.226091 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:40:15.227659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:15.240739 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:40:15.241790 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:40:15.244459 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:40:15.245714 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:40:15.257180 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:15.259432 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:40:15.266257 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:40:15.271163 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:15.277390 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:15.279373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.284673 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:40:15.291128 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:15.286131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762085b97fb0>]}
[0m15:40:15.293991 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:40:15.294777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:40:15.295932 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.22s]
[0m15:40:15.298083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.305454 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:15.306890 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:40:15.319384 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:40:15.326429 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:40:15.343376 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:40:15.344240 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:40:15.345684 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:15.348131 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:40:15.348981 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:40:15.349932 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:15.351769 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:40:15.354773 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:40:15.361769 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m15:40:15.376528 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:40:15.379440 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:40:15.388587 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:15.389629 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:15.390476 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:40:15.391260 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:40:15.397265 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:40:15.401753 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:40:15.402808 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:40:15.405347 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:40:15.406241 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762084339130>]}
[0m15:40:15.407201 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762084335dc0>]}
[0m15:40:15.408306 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.34s]
[0m15:40:15.409499 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.34s]
[0m15:40:15.410692 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:40:15.411839 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:40:15.413504 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:40:15.415246 [debug] [Thread-1 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:40:15.414566 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:40:15.416138 [debug] [Thread-3 (]: Began running node model.spacex_dbt.fct_launches
[0m15:40:15.416916 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:40:15.417886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:40:15.418737 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:40:15.419504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launches, now model.spacex_dbt.dim_launchpads)
[0m15:40:15.420309 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:40:15.421153 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:40:15.421897 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:40:15.425969 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:40:15.427084 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:40:15.430465 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:40:15.437682 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:40:15.443856 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:40:15.495044 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:40:15.495632 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:40:15.502344 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:15.503196 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:40:15.503852 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:15.504660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:15.505510 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:40:15.506802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:15.529783 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.025 seconds
[0m15:40:15.537826 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.031 seconds
[0m15:40:15.541202 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:15.545485 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:15.546519 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:40:15.547413 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:40:15.549493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.550156 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.554185 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:15.561043 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:15.561689 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:40:15.562685 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:40:15.564726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.566326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:15.568652 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:40:15.571375 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:40:15.572920 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:15.574181 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:15.575352 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:40:15.577245 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:40:15.581719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:40:15.585780 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:40:15.586433 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:40:15.592285 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:15.595845 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:40:15.596768 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:40:15.598232 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:15.599588 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:40:15.605425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:40:15.606246 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:40:15.608335 [debug] [Thread-1 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:40:15.610375 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:40:15.611794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762084363e30>]}
[0m15:40:15.612684 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be463649-0307-4b46-8d3d-a95dcc1832c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76208430c4a0>]}
[0m15:40:15.616309 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.19s]
[0m15:40:15.617892 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.19s]
[0m15:40:15.619078 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:40:15.620219 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:40:15.622582 [debug] [Thread-4 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:40:15.623419 [info ] [Thread-4 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:40:15.624356 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:40:15.625103 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:40:15.628322 [debug] [MainThread]: On master: COMMIT
[0m15:40:15.629191 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:15.629909 [debug] [MainThread]: On master: COMMIT
[0m15:40:15.630594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:15.644016 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:40:15.644924 [debug] [MainThread]: On master: Close
[0m15:40:15.645853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:15.646492 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:40:15.647152 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:40:15.647879 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:40:15.648857 [info ] [MainThread]: 
[0m15:40:15.649698 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:40:15.652145 [debug] [MainThread]: Command end result
[0m15:40:15.701740 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:40:15.708629 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:40:15.721536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:40:15.722249 [info ] [MainThread]: 
[0m15:40:15.723005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:40:15.723777 [info ] [MainThread]: 
[0m15:40:15.724697 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:40:15.725544 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:15.726276 [info ] [MainThread]: 
[0m15:40:15.727074 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:15.727847 [info ] [MainThread]: 
[0m15:40:15.728582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:40:15.730200 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5088327, "process_in_blocks": "0", "process_kernel_time": 0.786734, "process_mem_max_rss": "162960", "process_out_blocks": "0", "process_user_time": 6.681191}
[0m15:40:15.731148 [debug] [MainThread]: Command `dbt build` failed at 15:40:15.730918 after 2.51 seconds
[0m15:40:15.731875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76208bcaac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762087258290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7620875cb290>]}
[0m15:40:15.732618 [debug] [MainThread]: Flushing usage events
[0m15:40:16.361068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:40.766559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabc8ad460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabd466300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabcc060c0>]}


============================== 15:40:40.840925 | 1180ea45-ba59-4533-bb55-4c26eff4f7f7 ==============================
[0m15:40:40.840925 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:40:40.842227 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/app/dbt', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'False'}
[0m15:40:41.328680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabbfc9d90>]}
[0m15:40:41.468898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabd2d2990>]}
[0m15:40:41.475698 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:40:41.641707 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:40:41.920600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:41.921978 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:40:41.925236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:41.983587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabbbf0410>]}
[0m15:40:42.127837 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:40:42.135297 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:40:42.550018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabbce6360>]}
[0m15:40:42.551304 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:40:42.555802 [info ] [MainThread]: 
[0m15:40:42.556842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:42.557652 [info ] [MainThread]: 
[0m15:40:42.558709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:42.566972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:42.576599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:42.577750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:40:42.681556 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:42.682406 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:42.683115 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:40:42.685605 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:42.686919 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:42.687842 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:42.688704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:42.689520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:42.690274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:42.714405 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m15:40:42.715266 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m15:40:42.720743 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:42.723287 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:42.729458 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.039 seconds
[0m15:40:42.731766 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:40:42.737521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:40:42.738728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:40:42.745228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:40:42.749957 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:40:42.753582 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:40:42.757181 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:40:42.758363 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:40:42.759260 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:40:42.760145 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:40:42.760970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:42.761765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:42.762455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:42.796218 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.034 seconds
[0m15:40:42.796893 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.034 seconds
[0m15:40:42.798807 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:40:42.801883 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:40:42.802981 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.042 seconds
[0m15:40:42.804168 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:40:42.807182 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:40:42.808037 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:40:42.812577 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:40:42.829107 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:42.830242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:40:42.832080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:42.863536 [debug] [MainThread]: SQL status: SELECT 4 in 0.032 seconds
[0m15:40:42.867132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabeb469f0>]}
[0m15:40:42.868620 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:42.870368 [debug] [MainThread]: On master: COMMIT
[0m15:40:42.871253 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:42.872026 [debug] [MainThread]: On master: COMMIT
[0m15:40:42.873208 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:40:42.874151 [debug] [MainThread]: On master: Close
[0m15:40:42.883648 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:40:42.884690 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:40:42.885624 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:40:42.886734 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:40:42.888079 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:40:42.889466 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:40:42.890584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:40:42.891710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:40:42.892790 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:40:42.893805 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:40:42.894982 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:40:42.895855 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:40:42.911770 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:40:42.912607 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:40:42.921015 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:40:42.944027 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:40:42.944828 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:40:42.956584 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:40:43.068480 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:40:43.070016 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:40:43.070731 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:40:43.078898 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:43.079727 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:43.080454 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:40:43.081606 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:40:43.083559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:40:43.085134 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:40:43.086074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:43.090890 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:40:43.092648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:43.113698 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:40:43.116684 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m15:40:43.119974 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:40:43.129124 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m15:40:43.169224 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:43.170695 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:40:43.178431 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:43.179627 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:40:43.182439 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:40:43.187830 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:43.191706 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:43.192575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:40:43.196056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab9b75430>]}
[0m15:40:43.208592 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:43.213309 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:43.215155 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.30s]
[0m15:40:43.218144 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:40:43.222442 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:40:43.226437 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:40:43.228655 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:40:43.229540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:40:43.230207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:40:43.299876 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:40:43.300468 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:40:43.304214 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:43.305862 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:43.307407 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:40:43.308772 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:40:43.313068 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:40:43.314037 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:40:43.339278 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:40:43.342580 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:40:43.355216 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:40:43.356741 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:40:43.357908 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:40:43.358923 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:40:43.365611 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:40:43.373966 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:40:43.374664 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m15:40:43.375680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab905cd70>]}
[0m15:40:43.377726 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:40:43.379045 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.48s]
[0m15:40:43.380370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab905c2f0>]}
[0m15:40:43.381945 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:40:43.385459 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.49s]
[0m15:40:43.387723 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:40:43.388731 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:40:43.390383 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:40:43.391348 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:40:43.391919 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:40:43.392680 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:40:43.393729 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:40:43.394657 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:40:43.395538 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:40:43.396548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:40:43.397567 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:40:43.403091 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:40:43.404161 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:40:43.405542 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:40:43.410627 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:40:43.420495 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:40:43.426611 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:40:43.488394 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:40:43.494545 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:40:43.504082 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:43.505292 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:40:43.506605 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:40:43.507413 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:43.508591 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:40:43.509461 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:43.536546 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:40:43.537307 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.028 seconds
[0m15:40:43.547714 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:43.553565 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:43.554490 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:40:43.556517 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:40:43.559716 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:43.560423 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:40:43.564663 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:43.573663 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:43.574426 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:40:43.575467 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:40:43.577282 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:43.578023 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:43.580258 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:40:43.584368 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:40:43.585863 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:43.588145 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:43.590552 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:40:43.592059 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:40:43.595030 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:40:43.599134 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:40:43.599981 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:40:43.606517 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:40:43.610278 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:40:43.611270 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:40:43.612611 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:40:43.613856 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:40:43.620898 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:40:43.621681 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:40:43.623737 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:40:43.626136 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:40:43.627682 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab91ebda0>]}
[0m15:40:43.628766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1180ea45-ba59-4533-bb55-4c26eff4f7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab903b0b0>]}
[0m15:40:43.632485 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.24s]
[0m15:40:43.634321 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.23s]
[0m15:40:43.635665 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:40:43.636888 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:40:43.639251 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:40:43.640337 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:40:43.641294 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:40:43.642199 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:40:43.645113 [debug] [MainThread]: On master: COMMIT
[0m15:40:43.646126 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:43.647033 [debug] [MainThread]: On master: COMMIT
[0m15:40:43.647692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:43.663249 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:40:43.664355 [debug] [MainThread]: On master: Close
[0m15:40:43.665267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:43.667554 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:40:43.668343 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:40:43.669070 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:40:43.669774 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:40:43.670576 [info ] [MainThread]: 
[0m15:40:43.671294 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m15:40:43.673616 [debug] [MainThread]: Command end result
[0m15:40:43.719554 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:40:43.726553 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:40:43.740126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:40:43.740852 [info ] [MainThread]: 
[0m15:40:43.742148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:40:43.743110 [info ] [MainThread]: 
[0m15:40:43.743921 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:40:43.744744 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:43.745473 [info ] [MainThread]: 
[0m15:40:43.746287 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:40:43.747058 [info ] [MainThread]: 
[0m15:40:43.747809 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:40:43.750110 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.1094542, "process_in_blocks": "0", "process_kernel_time": 1.058893, "process_mem_max_rss": "163388", "process_out_blocks": "0", "process_user_time": 9.26952}
[0m15:40:43.751179 [debug] [MainThread]: Command `dbt build` failed at 15:40:43.751030 after 3.11 seconds
[0m15:40:43.751966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfac0a1ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfabc090aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfab906b8f0>]}
[0m15:40:43.752724 [debug] [MainThread]: Flushing usage events
[0m15:40:44.380940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:20.361034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc24446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc2445520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc2445790>]}


============================== 15:41:20.425151 | 4d95d004-f94a-4c21-867d-51cdc0d36e7d ==============================
[0m15:41:20.425151 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:41:20.426220 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'empty': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True'}
[0m15:41:20.735525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc232e210>]}
[0m15:41:20.900398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc2c23d70>]}
[0m15:41:20.902722 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:41:21.078838 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:41:21.343785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:21.344786 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:41:21.345706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:21.396786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc210f2c0>]}
[0m15:41:21.520072 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:41:21.527438 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:41:21.793263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc11c6990>]}
[0m15:41:21.794132 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:41:21.797690 [info ] [MainThread]: 
[0m15:41:21.798487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:21.799274 [info ] [MainThread]: 
[0m15:41:21.800319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:21.806739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:41:21.808086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:41:21.819865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:41:21.902843 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:41:21.903494 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:41:21.904027 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:41:21.904546 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:21.905442 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:21.906298 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:21.907233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:21.908047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:21.908819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:21.929131 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m15:41:21.929819 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m15:41:21.933077 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m15:41:21.935548 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:41:21.937829 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:41:21.939791 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:41:21.946587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:41:21.947737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:41:21.953829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:41:21.956968 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:41:21.959508 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:41:21.962589 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:41:21.963620 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:41:21.964490 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:41:21.965388 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:41:21.966215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:21.967015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:21.967734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:21.992395 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:41:21.994082 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m15:41:21.994674 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.028 seconds
[0m15:41:21.996968 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:41:22.000187 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:41:22.002541 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:41:22.003846 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:41:22.004585 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:41:22.005362 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:41:22.018909 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:22.019862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:41:22.020725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:22.046436 [debug] [MainThread]: SQL status: SELECT 4 in 0.026 seconds
[0m15:41:22.048656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc0996e40>]}
[0m15:41:22.049494 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:22.050386 [debug] [MainThread]: On master: COMMIT
[0m15:41:22.051111 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:22.051729 [debug] [MainThread]: On master: COMMIT
[0m15:41:22.052695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:41:22.053325 [debug] [MainThread]: On master: Close
[0m15:41:22.060130 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:41:22.060888 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:41:22.061518 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:41:22.062283 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:41:22.063461 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:41:22.064466 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:41:22.065367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:41:22.066244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:41:22.067178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:41:22.067947 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:41:22.068960 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:41:22.069766 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:41:22.079971 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:41:22.083911 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:41:22.089716 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:41:22.096543 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:41:22.097183 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:41:22.103270 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:41:22.222468 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:41:22.223524 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:41:22.224473 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:41:22.233593 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:41:22.235016 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:41:22.235757 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:41:22.236456 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:41:22.237608 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:41:22.238625 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:41:22.239697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:22.240632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:22.241531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:22.258653 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:41:22.261092 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:41:22.262273 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:41:22.264093 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:41:22.264854 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m15:41:22.281964 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:41:22.290745 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:41:22.291659 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:41:22.293430 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:41:22.297099 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:41:22.298011 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:41:22.302327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:41:22.307096 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:41:22.308075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf113650>]}
[0m15:41:22.312436 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:41:22.313520 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:41:22.315370 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.23s]
[0m15:41:22.316450 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:41:22.317908 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:41:22.318652 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:22.320332 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:22.322341 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:41:22.375477 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:41:22.378481 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:41:22.379203 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:41:22.381070 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:41:22.382228 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:41:22.383117 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:41:22.385994 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:41:22.392256 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:41:22.396324 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:41:22.399872 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:41:22.408942 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:41:22.409880 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:41:22.410981 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:41:22.412192 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:41:22.418149 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:41:22.421744 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:41:22.422398 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m15:41:22.423407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf2c0590>]}
[0m15:41:22.425280 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:41:22.426702 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.36s]
[0m15:41:22.428322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf2c2db0>]}
[0m15:41:22.429313 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:41:22.430755 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.36s]
[0m15:41:22.432466 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:41:22.433355 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:41:22.434324 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:41:22.435797 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:41:22.436477 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:41:22.437075 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:41:22.437621 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:41:22.438594 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:41:22.439653 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:41:22.443905 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:41:22.444840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:41:22.445752 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:41:22.447337 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:41:22.448409 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:41:22.451994 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:41:22.457711 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:41:22.464060 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:41:22.519657 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:41:22.520563 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:41:22.527146 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:41:22.528052 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:41:22.528709 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:41:22.529251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:22.530019 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:41:22.531724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:22.553754 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.024 seconds
[0m15:41:22.560836 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.029 seconds
[0m15:41:22.564080 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:41:22.567937 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:41:22.568816 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:41:22.569707 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:41:22.571854 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:22.572546 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:41:22.579070 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:41:22.583454 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:41:22.584570 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:41:22.585424 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:41:22.587234 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:22.587881 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:22.589996 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:41:22.592209 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:41:22.593036 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:41:22.593850 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:41:22.594642 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:41:22.595479 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:41:22.597846 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:41:22.601453 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:41:22.602062 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m15:41:22.607166 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:41:22.611072 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:41:22.611942 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:41:22.613240 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:41:22.614430 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:41:22.620389 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:41:22.621132 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:41:22.623160 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:41:22.625123 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:41:22.626372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf2f21b0>]}
[0m15:41:22.627208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d95d004-f94a-4c21-867d-51cdc0d36e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf10de20>]}
[0m15:41:22.630585 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.19s]
[0m15:41:22.632194 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.18s]
[0m15:41:22.633432 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:41:22.634508 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:41:22.636760 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:41:22.637703 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:41:22.638614 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:41:22.639399 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:41:22.642102 [debug] [MainThread]: On master: COMMIT
[0m15:41:22.642871 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:22.643523 [debug] [MainThread]: On master: COMMIT
[0m15:41:22.644122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:22.658050 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:41:22.659066 [debug] [MainThread]: On master: Close
[0m15:41:22.659980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:22.662924 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:41:22.663646 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:41:22.664405 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:41:22.665057 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:41:22.665851 [info ] [MainThread]: 
[0m15:41:22.666584 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m15:41:22.668932 [debug] [MainThread]: Command end result
[0m15:41:22.718032 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:41:22.724545 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:41:22.737608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:41:22.738296 [info ] [MainThread]: 
[0m15:41:22.739178 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:41:22.739869 [info ] [MainThread]: 
[0m15:41:22.740658 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:41:22.741441 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:41:22.742331 [info ] [MainThread]: 
[0m15:41:22.743189 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:41:22.743930 [info ] [MainThread]: 
[0m15:41:22.744730 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:41:22.746383 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5252693, "process_in_blocks": "0", "process_kernel_time": 0.744939, "process_mem_max_rss": "164476", "process_out_blocks": "0", "process_user_time": 6.874496}
[0m15:41:22.747354 [debug] [MainThread]: Command `dbt build` failed at 15:41:22.747208 after 2.53 seconds
[0m15:41:22.748161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc2aa0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffc2443710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ffbf142db0>]}
[0m15:41:22.748970 [debug] [MainThread]: Flushing usage events
[0m15:41:23.586065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:59.030136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf775365ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf7753660c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf775366030>]}


============================== 15:41:59.089969 | 3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1 ==============================
[0m15:41:59.089969 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:41:59.091051 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/app/dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m15:41:59.399916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf778018440>]}
[0m15:41:59.531783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf77524cb90>]}
[0m15:41:59.533262 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:41:59.684707 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:41:59.942762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:59.943737 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:41:59.944553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:59.993055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf774dfc8f0>]}
[0m15:42:00.113397 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:42:00.120459 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:42:00.379845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf77447da90>]}
[0m15:42:00.380775 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:42:00.384323 [info ] [MainThread]: 
[0m15:42:00.385088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:00.385859 [info ] [MainThread]: 
[0m15:42:00.386809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:00.392721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:00.401041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:00.402342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:00.478444 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:00.479172 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:00.479705 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:00.480232 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:00.481137 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:00.482058 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:00.482867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:00.483711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:00.484544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:00.505354 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:42:00.506247 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:42:00.506818 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m15:42:00.508617 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:00.510463 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:00.512285 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:00.518595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:42:00.519572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:42:00.526014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:42:00.530180 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:42:00.533308 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:42:00.535969 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:42:00.536972 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:42:00.538008 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:42:00.538904 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:42:00.539810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:00.540542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:00.541320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:00.566544 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.025 seconds
[0m15:42:00.567256 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:42:00.569102 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:42:00.571566 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:42:00.572493 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.032 seconds
[0m15:42:00.573681 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:42:00.574559 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:42:00.576345 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:42:00.581503 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:42:00.589624 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:00.590544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:42:00.591317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:00.615221 [debug] [MainThread]: SQL status: SELECT 4 in 0.024 seconds
[0m15:42:00.617555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf774dd6ab0>]}
[0m15:42:00.618466 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:00.619365 [debug] [MainThread]: On master: COMMIT
[0m15:42:00.619991 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:00.620585 [debug] [MainThread]: On master: COMMIT
[0m15:42:00.621664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:42:00.622309 [debug] [MainThread]: On master: Close
[0m15:42:00.629194 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:42:00.629993 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:42:00.630575 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:42:00.631339 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:42:00.632595 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:42:00.633628 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:42:00.634445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:42:00.635337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launchpads)
[0m15:42:00.636086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:42:00.636877 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:42:00.637973 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:42:00.638752 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:42:00.648958 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:42:00.652442 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:42:00.657709 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:42:00.669200 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:42:00.670079 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:42:00.692749 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:42:00.774489 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:42:00.775180 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:42:00.779373 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:42:00.786880 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:42:00.787624 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:00.788677 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    launch_datetime as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:42:00.789645 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:00.790332 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:42:00.791667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:00.793110 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:42:00.794089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:42:00.795511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:42:00.809855 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_datetime" does not exist
LINE 10:     launch_datetime as launch_date,
             ^

[0m15:42:00.810835 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:42:00.812098 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:42:00.815933 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m15:42:00.816747 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m15:42:00.828623 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:00.839376 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:00.842865 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:00.880300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf77654e000>]}
[0m15:42:00.920979 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:42:00.925846 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:42:00.927730 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.24s]
[0m15:42:00.930237 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:00.930945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:42:00.931880 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:42:00.950791 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:00.956233 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:00.957672 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:42:00.959223 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:42:00.960374 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:42:00.964620 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:00.965433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:01.029063 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:42:01.029811 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:42:01.030563 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:01.035282 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:42:01.032192 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:01.039131 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:42:01.044104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m15:42:01.051996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:42:01.067094 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:42:01.069279 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:42:01.087934 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:01.088687 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:01.089431 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:42:01.090281 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:42:01.096262 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:42:01.097116 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:42:01.100499 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:42:01.102740 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:42:01.104038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf77231bc80>]}
[0m15:42:01.104939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf772319af0>]}
[0m15:42:01.108393 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.47s]
[0m15:42:01.109630 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.47s]
[0m15:42:01.110732 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:42:01.111728 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:42:01.113201 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:42:01.114200 [info ] [Thread-2 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:42:01.114988 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:42:01.115546 [debug] [Thread-4 (]: Began running node model.spacex_dbt.fct_launches
[0m15:42:01.116144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:42:01.117063 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:42:01.117990 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:42:01.118737 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:42:01.119494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:42:01.120278 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:42:01.124397 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:42:01.125187 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:42:01.126130 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:42:01.130158 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:42:01.135565 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:42:01.141698 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:42:01.192703 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:42:01.189756 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:42:01.199458 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:01.200399 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:42:01.201142 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:01.201736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:42:01.202517 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:42:01.203781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:42:01.227025 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.023 seconds
[0m15:42:01.227798 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:42:01.237178 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:01.240983 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:01.243679 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:42:01.242485 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:42:01.246077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:01.247711 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:01.253558 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:01.257747 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:01.258691 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:42:01.259501 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:42:01.261213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:01.261881 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:01.263869 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:42:01.266051 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:42:01.266891 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:01.267709 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:01.268590 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:42:01.269494 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:42:01.272472 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:42:01.276580 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:42:01.277274 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:42:01.282122 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:01.285707 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:42:01.286642 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:42:01.287960 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:01.289240 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:42:01.294421 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:42:01.295611 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:42:01.297624 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:42:01.299573 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:42:01.300826 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf772365970>]}
[0m15:42:01.301735 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fce5d7e-4f7f-4f1c-907c-e1fd32a952c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf774125340>]}
[0m15:42:01.305024 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.18s]
[0m15:42:01.306550 [info ] [Thread-2 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.19s]
[0m15:42:01.307661 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:42:01.308746 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:42:01.311196 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:42:01.312068 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:42:01.312917 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:42:01.313721 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:42:01.316773 [debug] [MainThread]: On master: COMMIT
[0m15:42:01.317549 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:01.318185 [debug] [MainThread]: On master: COMMIT
[0m15:42:01.318832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:01.331893 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m15:42:01.332744 [debug] [MainThread]: On master: Close
[0m15:42:01.333740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:01.334535 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:42:01.335403 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:42:01.336063 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:42:01.336900 [info ] [MainThread]: 
[0m15:42:01.337713 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:42:01.339990 [debug] [MainThread]: Command end result
[0m15:42:01.386424 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:42:01.392272 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:42:01.404178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:42:01.404874 [info ] [MainThread]: 
[0m15:42:01.405609 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:42:01.406276 [info ] [MainThread]: 
[0m15:42:01.407029 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:42:01.407763 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_datetime" does not exist
  LINE 10:     launch_datetime as launch_date,
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:01.408395 [info ] [MainThread]: 
[0m15:42:01.409092 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:01.409747 [info ] [MainThread]: 
[0m15:42:01.410400 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:42:01.411870 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5057209, "process_in_blocks": "0", "process_kernel_time": 0.627377, "process_mem_max_rss": "163076", "process_out_blocks": "0", "process_user_time": 6.433618}
[0m15:42:01.412797 [debug] [MainThread]: Command `dbt build` failed at 15:42:01.412657 after 2.51 seconds
[0m15:42:01.413522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf775f9c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf775bb7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf772d2bda0>]}
[0m15:42:01.414171 [debug] [MainThread]: Flushing usage events
[0m15:42:02.052637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:28.630871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a7f495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13aaa2f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a898df40>]}


============================== 15:42:28.726534 | c8124b09-58af-4cbb-a6e0-38a166815b85 ==============================
[0m15:42:28.726534 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:42:28.727774 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default'}
[0m15:42:29.202402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a817bd40>]}
[0m15:42:29.471998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a8df2480>]}
[0m15:42:29.474155 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:42:29.802488 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:42:30.153714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:30.155036 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:42:30.838203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a63d2630>]}
[0m15:42:31.030796 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:42:31.046399 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:42:31.423942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a5fcd070>]}
[0m15:42:31.424973 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:42:31.430152 [info ] [MainThread]: 
[0m15:42:31.431158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:31.431990 [info ] [MainThread]: 
[0m15:42:31.432989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:31.448149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:31.460710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:31.472901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:42:31.566369 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:31.567021 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:31.567683 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:42:31.568207 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:31.568982 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:31.569744 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:42:31.570445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:31.571109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:31.571862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:31.599373 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m15:42:31.602041 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.030 seconds
[0m15:42:31.603593 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.033 seconds
[0m15:42:31.605632 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:31.608509 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:31.612255 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:42:31.617689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:42:31.618814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:42:31.619851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:42:31.633170 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:42:31.636470 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:42:31.639588 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:42:31.640594 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:42:31.641634 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:42:31.644211 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:42:31.645394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:31.646125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:31.646768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:31.685197 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.040 seconds
[0m15:42:31.688186 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:42:31.688997 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.042 seconds
[0m15:42:31.689789 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:42:31.692310 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:42:31.695328 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:42:31.698430 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.052 seconds
[0m15:42:31.700639 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:42:31.701653 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:42:31.717409 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:31.727889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:42:31.729085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:31.768261 [debug] [MainThread]: SQL status: SELECT 4 in 0.039 seconds
[0m15:42:31.770458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a5fcce00>]}
[0m15:42:31.771444 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:31.772438 [debug] [MainThread]: On master: COMMIT
[0m15:42:31.774146 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:31.774940 [debug] [MainThread]: On master: COMMIT
[0m15:42:31.777797 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:42:31.778729 [debug] [MainThread]: On master: Close
[0m15:42:31.790901 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:42:31.791708 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:42:31.792393 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:42:31.793359 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:42:31.795048 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:42:31.796128 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:42:31.797376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launches)
[0m15:42:31.798496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:42:31.799605 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:42:31.800927 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:42:31.801926 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:42:31.817091 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:42:31.802805 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:42:31.828124 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:42:31.833616 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:42:31.840802 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:42:31.841604 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:42:31.842201 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:42:31.950585 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:42:31.953043 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:42:31.957296 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:42:31.965534 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:31.966497 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:42:31.967195 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:42:31.967875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:42:31.968783 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:42:31.969476 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:31.970485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:31.973315 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:42:31.977577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:42:31.993521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:42:31.996789 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:42:31.997592 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m15:42:31.998631 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:42:32.012620 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:32.015329 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m15:42:32.016079 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:42:32.019826 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:32.028192 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:32.031046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:42:32.032047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1397ddb470>]}
[0m15:42:32.032742 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:42:32.037418 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:32.038762 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.23s]
[0m15:42:32.040011 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:42:32.040910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:32.042364 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:42:32.049988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:42:32.049018 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:32.051302 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:42:32.074403 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:42:32.088656 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:42:32.091576 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:32.094321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:42:32.094971 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:42:32.097680 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:42:32.098897 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:32.099677 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:42:32.100359 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:42:32.203692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.103 seconds
[0m15:42:32.220347 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:42:32.248641 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:42:32.291727 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:42:32.292654 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:42:32.294391 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:42:32.295923 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:42:32.303027 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:42:32.307300 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:42:32.307998 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:42:32.309149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1397c37e30>]}
[0m15:42:32.311674 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:42:32.313217 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.51s]
[0m15:42:32.314462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1397c06960>]}
[0m15:42:32.315518 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:42:32.316944 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.52s]
[0m15:42:32.318909 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:42:32.319757 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:42:32.321117 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:42:32.321975 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:42:32.322553 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:42:32.323444 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:42:32.324757 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:42:32.325831 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:42:32.327120 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:42:32.328364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:42:32.329447 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:42:32.333815 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:42:32.334779 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:42:32.335703 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:42:32.340840 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:42:32.349621 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:42:32.355907 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:42:32.420505 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:42:32.423919 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:42:32.435951 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:32.436961 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:32.437610 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:42:32.438551 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:42:32.439445 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:42:32.440203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:42:32.468097 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.028 seconds
[0m15:42:32.476202 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.037 seconds
[0m15:42:32.488023 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:32.491856 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:32.494555 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:42:32.496024 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:42:32.498184 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:32.498863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:42:32.503136 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:32.510905 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:32.511873 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:42:32.512823 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:42:32.514699 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:32.515475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:42:32.517821 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:42:32.520535 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:42:32.522397 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:32.523418 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:32.524292 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:42:32.525200 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:42:32.528947 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:42:32.533219 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:42:32.533943 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:42:32.539360 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:42:32.543594 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:42:32.544900 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:42:32.546431 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:42:32.547595 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:42:32.553965 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:42:32.554812 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:42:32.557361 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:42:32.564488 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:42:32.566079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a67e1640>]}
[0m15:42:32.567764 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8124b09-58af-4cbb-a6e0-38a166815b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a6357e00>]}
[0m15:42:32.569210 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.24s]
[0m15:42:32.570692 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.24s]
[0m15:42:32.572513 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:42:32.574774 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:42:32.577673 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:42:32.579087 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:42:32.580348 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:42:32.581165 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:42:32.585289 [debug] [MainThread]: On master: COMMIT
[0m15:42:32.586395 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:32.587188 [debug] [MainThread]: On master: COMMIT
[0m15:42:32.588073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:32.611884 [debug] [MainThread]: SQL status: COMMIT in 0.024 seconds
[0m15:42:32.613344 [debug] [MainThread]: On master: Close
[0m15:42:32.615860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:32.618073 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:42:32.619425 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:42:32.620141 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:42:32.620947 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:42:32.621785 [info ] [MainThread]: 
[0m15:42:32.622597 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m15:42:32.625292 [debug] [MainThread]: Command end result
[0m15:42:32.692985 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:42:32.703560 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:42:32.717915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:42:32.718781 [info ] [MainThread]: 
[0m15:42:32.719560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:42:32.720252 [info ] [MainThread]: 
[0m15:42:32.721235 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:42:32.722080 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:32.722797 [info ] [MainThread]: 
[0m15:42:32.723640 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:42:32.724406 [info ] [MainThread]: 
[0m15:42:32.725309 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:42:32.727956 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.4612246, "process_in_blocks": "0", "process_kernel_time": 1.35713, "process_mem_max_rss": "169496", "process_out_blocks": "0", "process_user_time": 11.670453}
[0m15:42:32.729287 [debug] [MainThread]: Command `dbt build` failed at 15:42:32.729094 after 4.46 seconds
[0m15:42:32.730059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a809de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1397c18110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a81c63c0>]}
[0m15:42:32.730770 [debug] [MainThread]: Flushing usage events
[0m15:42:33.354601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:40.663012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1228f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf121ff92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf121cb8a40>]}


============================== 15:44:40.740755 | e22d1f5d-4174-4ccd-8e8f-f03e139a527d ==============================
[0m15:44:40.740755 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:44:40.741968 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True'}
[0m15:44:41.207562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1244a4500>]}
[0m15:44:41.407330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf12217bd40>]}
[0m15:44:41.411363 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:44:41.630874 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:44:41.939218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:41.940180 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:44:41.940842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:42.003998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1215e2270>]}
[0m15:44:42.159668 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:42.171884 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:42.598223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1215e28a0>]}
[0m15:44:42.600862 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:44:42.606274 [info ] [MainThread]: 
[0m15:44:42.607282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:42.608018 [info ] [MainThread]: 
[0m15:44:42.609077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:42.624299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:44:42.625599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:44:42.632202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:44:42.881102 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:44:42.881941 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:44:42.882496 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:44:42.883025 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:42.883886 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:42.884640 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:44:42.885461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:42.886231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:42.886963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:42.929342 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m15:44:42.932665 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:44:42.933416 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m15:44:42.933963 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m15:44:42.936713 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:44:42.939359 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:44:42.941768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_gold)
[0m15:44:42.942500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_staging)
[0m15:44:42.943072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics_analytics_marts)
[0m15:44:42.944206 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_gold"
"
[0m15:44:42.953990 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_staging"
"
[0m15:44:42.955163 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics_analytics_marts"
"
[0m15:44:42.966592 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:44:42.970187 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:44:42.973703 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:44:42.974658 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_gold"} */
create schema if not exists "analytics_analytics_gold"
[0m15:44:42.975753 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m15:44:42.976640 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics_analytics_marts"} */
create schema if not exists "analytics_analytics_marts"
[0m15:44:42.982428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:42.983233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:42.984014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:43.008858 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.026 seconds
[0m15:44:43.010780 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.027 seconds
[0m15:44:43.011381 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.029 seconds
[0m15:44:43.016462 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:44:43.021303 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_marts"
[0m15:44:43.020253 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:44:43.021986 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: COMMIT
[0m15:44:43.022683 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_gold"
[0m15:44:43.014069 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:44:43.023936 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: COMMIT
[0m15:44:43.024886 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics_analytics_staging"
[0m15:44:43.026097 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:44:43.029399 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: COMMIT
[0m15:44:43.030337 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m15:44:43.031471 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_marts: Close
[0m15:44:43.032758 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_gold: Close
[0m15:44:43.034705 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:44:43.037728 [debug] [ThreadPool]: On create_spacex_db_analytics_analytics_staging: Close
[0m15:44:43.049739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_staging, now list_spacex_db_analytics_analytics_gold)
[0m15:44:43.050803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_gold, now list_spacex_db_analytics_analytics_staging)
[0m15:44:43.057190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics_analytics_marts, now list_spacex_db_analytics_analytics_marts)
[0m15:44:43.075147 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:44:43.077552 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:44:43.080793 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:44:43.081894 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:44:43.083274 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:44:43.084209 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:44:43.085148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:43.085932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:43.086688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:43.154556 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.069 seconds
[0m15:44:43.156718 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:44:43.157857 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:44:43.163494 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.078 seconds
[0m15:44:43.171716 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:44:43.172450 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.086 seconds
[0m15:44:43.173661 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:44:43.175524 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:44:43.186157 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:44:43.193893 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:43.194927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:44:43.201812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:43.265148 [debug] [MainThread]: SQL status: SELECT 2 in 0.063 seconds
[0m15:44:43.267872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1207cbdd0>]}
[0m15:44:43.268896 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:43.269962 [debug] [MainThread]: On master: COMMIT
[0m15:44:43.270705 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:43.271371 [debug] [MainThread]: On master: COMMIT
[0m15:44:43.272429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:43.273069 [debug] [MainThread]: On master: Close
[0m15:44:43.289015 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:44:43.289980 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:44:43.290653 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:44:43.291481 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:44:43.292701 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:44:43.294219 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:44:43.301041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:44:43.301990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:44:43.303218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:44:43.304205 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:44:43.305517 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:44:43.306568 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:44:43.326940 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:44:43.336380 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:44:43.341057 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:44:43.349793 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:44:43.350538 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:44:43.370966 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:44:43.521822 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:44:43.522858 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:44:43.526958 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:44:43.535393 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:44:43.536176 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:44:43.536832 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:44:43.537805 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:44:43.538598 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:44:43.539201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:44:43.540102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:43.540935 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:44:43.543398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:43.569280 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m15:44:43.570738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:44:43.584000 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:44:43.584775 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m15:44:43.585835 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:44:43.591926 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:44:43.599273 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:44:43.603443 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:44:43.606522 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:44:43.607266 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:44:43.610750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:44:43.615182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11e70a960>]}
[0m15:44:43.617495 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:44:43.629646 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.31s]
[0m15:44:43.652579 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:44:43.656847 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:44:43.657987 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:44:43.659034 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:44:43.660010 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:44:43.661444 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:44:43.662551 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:44:43.663652 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:44:43.668261 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:43.675236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m15:44:43.679570 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:44:43.684228 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:44:43.699209 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:44:43.700926 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:44:43.701695 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:44:43.702620 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:44:43.704250 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:44:43.709098 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:44:43.710027 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:44:43.713146 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:44:43.714285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11e70a660>]}
[0m15:44:43.715891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11e8d9d60>]}
[0m15:44:43.717499 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.41s]
[0m15:44:43.718814 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.41s]
[0m15:44:43.720208 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:44:43.721725 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:44:43.723828 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:44:43.725597 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:44:43.727109 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:44:43.727802 [debug] [Thread-3 (]: Began running node model.spacex_dbt.fct_launches
[0m15:44:43.728650 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:44:43.730522 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:44:43.733424 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:44:43.731817 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:44:43.734659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:44:43.739151 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:44:43.740282 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:44:43.741222 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:44:43.742836 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:44:43.747468 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:44:43.755455 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:44:43.763569 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:44:43.824373 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:44:43.829740 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:44:43.838401 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:44:43.839329 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:44:43.839999 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:44:43.840570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:44:43.841463 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:44:43.842758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:43.872840 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:44:43.888890 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:44:43.889828 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.049 seconds
[0m15:44:43.891342 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:44:43.896381 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:44:43.899411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:43.900194 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:44:43.902674 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:44:43.904144 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:44:43.904839 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:43.905460 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:44:43.907782 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:44:43.910063 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:44:43.911643 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:44:43.912902 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:44:43.919428 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:44:43.920157 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:44:43.925221 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:44:43.929391 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:44:43.932150 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:44:43.933986 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:44:43.935268 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:44:43.935940 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:44:43.938873 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:44:43.939651 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:44:43.940669 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11e790dd0>]}
[0m15:44:43.942805 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:44:43.944247 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.21s]
[0m15:44:43.946119 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e22d1f5d-4174-4ccd-8e8f-f03e139a527d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11f7c90d0>]}
[0m15:44:43.950047 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:44:43.951560 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.22s]
[0m15:44:43.953517 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:44:43.954236 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:44:43.955347 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:44:43.956205 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:44:43.957187 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:44:43.960169 [debug] [MainThread]: On master: COMMIT
[0m15:44:43.961159 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:43.962016 [debug] [MainThread]: On master: COMMIT
[0m15:44:43.962737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:43.980916 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m15:44:43.982062 [debug] [MainThread]: On master: Close
[0m15:44:43.983414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:43.984377 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:44:43.985912 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:44:43.986772 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:44:43.987582 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:44:43.990334 [info ] [MainThread]: 
[0m15:44:43.991890 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m15:44:43.995125 [debug] [MainThread]: Command end result
[0m15:44:44.050377 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:44:44.058280 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:44:44.075304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:44:44.076343 [info ] [MainThread]: 
[0m15:44:44.077311 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:44:44.078407 [info ] [MainThread]: 
[0m15:44:44.079564 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:44:44.081155 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:44:44.082660 [info ] [MainThread]: 
[0m15:44:44.084028 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:44:44.084895 [info ] [MainThread]: 
[0m15:44:44.085718 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:44:44.088175 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.57867, "process_in_blocks": "0", "process_kernel_time": 1.104709, "process_mem_max_rss": "164720", "process_out_blocks": "0", "process_user_time": 9.289419}
[0m15:44:44.089737 [debug] [MainThread]: Command `dbt build` failed at 15:44:44.089054 after 3.58 seconds
[0m15:44:44.091279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf1228f2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf12216b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf11e7271a0>]}
[0m15:44:44.092247 [debug] [MainThread]: Flushing usage events
[0m15:44:44.766799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:21.243044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd79dfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd7bbeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd79df440>]}


============================== 15:45:21.308429 | 8eaa6714-bc2b-48e4-a28f-78aa13801182 ==============================
[0m15:45:21.308429 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:45:21.309740 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'empty': 'False'}
[0m15:45:21.666918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd7057a10>]}
[0m15:45:21.813149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd7d10560>]}
[0m15:45:21.815098 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:45:21.999938 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:45:22.278077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:22.279196 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:45:22.280016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:22.334080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd6ab0e00>]}
[0m15:45:22.463319 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:45:22.470207 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:45:22.753806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd6bd6810>]}
[0m15:45:22.754743 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:45:22.758657 [info ] [MainThread]: 
[0m15:45:22.759481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:22.760198 [info ] [MainThread]: 
[0m15:45:22.761158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:22.767330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:45:22.768336 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:45:22.774918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:45:22.853336 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:45:22.854036 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:45:22.854600 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:45:22.855094 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:45:22.855893 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:45:22.856953 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:45:22.857892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:22.859273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:22.860270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:22.884035 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m15:45:22.884720 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m15:45:22.885197 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m15:45:22.887019 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:45:22.889205 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:45:22.891459 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:45:22.899245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:45:22.900167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:45:22.908514 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:45:22.909335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:45:22.912050 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:45:22.912888 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:45:22.915584 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:45:22.916341 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:45:22.917137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:22.917916 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:45:22.918707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:22.920484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:22.943956 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:45:22.946502 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:45:22.947122 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.028 seconds
[0m15:45:22.947649 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m15:45:22.948402 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:45:22.950085 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:45:22.952055 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:45:22.954167 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:45:22.955049 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:45:22.963234 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:22.964385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:45:22.965438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:23.023570 [debug] [MainThread]: SQL status: SELECT 4 in 0.058 seconds
[0m15:45:23.037564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd5b1fec0>]}
[0m15:45:23.038785 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:23.039960 [debug] [MainThread]: On master: COMMIT
[0m15:45:23.040846 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:23.041562 [debug] [MainThread]: On master: COMMIT
[0m15:45:23.042695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:23.043506 [debug] [MainThread]: On master: Close
[0m15:45:23.057754 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:45:23.058625 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:45:23.059301 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:45:23.060510 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:45:23.061888 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:45:23.062790 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:45:23.063770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:45:23.064626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:45:23.065394 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:45:23.066240 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:45:23.067341 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:45:23.068083 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:45:23.083298 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:45:23.083899 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:45:23.087801 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:45:23.094092 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:45:23.094797 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:45:23.100691 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:45:23.209722 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:45:23.208733 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:45:23.212884 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:45:23.221461 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:45:23.222533 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:45:23.223455 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:45:23.224528 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:45:23.225149 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:45:23.226088 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:45:23.227151 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:45:23.228070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:23.229714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:23.249977 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m15:45:23.251056 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m15:45:23.257280 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:45:23.268823 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:45:23.274885 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:45:23.276311 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:45:23.277922 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:45:23.279089 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:45:23.280613 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:45:23.281328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:45:23.288006 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:45:23.288845 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:45:23.289529 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:45:23.295770 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:45:23.300418 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:45:23.301135 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:45:23.301896 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:45:23.305728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd6a86810>]}
[0m15:45:23.319541 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:45:23.318855 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.24s]
[0m15:45:23.351488 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:45:23.355891 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:45:23.356996 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:45:23.383281 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:45:23.385383 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:45:23.387826 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:45:23.389151 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:45:23.394286 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:45:23.401200 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:45:23.408749 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m15:45:23.422298 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:45:23.423183 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:45:23.447234 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:45:23.488889 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:45:23.494460 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:45:23.495900 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:45:23.508446 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m15:45:23.514706 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:45:23.515413 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m15:45:23.516452 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd40e2690>]}
[0m15:45:23.518635 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:45:23.520241 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.45s]
[0m15:45:23.521813 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd40e1af0>]}
[0m15:45:23.525666 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:45:23.527186 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.46s]
[0m15:45:23.528897 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:45:23.530040 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:45:23.531289 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:45:23.533496 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:45:23.534256 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:45:23.534906 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:45:23.535468 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:45:23.536623 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:45:23.537511 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:45:23.544274 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:45:23.545539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:45:23.546802 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:45:23.548449 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:45:23.549551 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:45:23.554185 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:45:23.630423 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:45:23.643163 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:45:23.697655 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:45:23.703612 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:45:23.712371 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:45:23.713319 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:45:23.714151 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:45:23.714842 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:23.715772 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:45:23.717496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:45:23.748290 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.033 seconds
[0m15:45:23.756280 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.039 seconds
[0m15:45:23.767253 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:45:23.770115 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:45:23.770939 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:45:23.772025 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:45:23.775263 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:45:23.776614 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:45:23.781653 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:45:23.786693 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:45:23.787782 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:45:23.788845 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:45:23.792616 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:45:23.793400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:45:23.798085 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:45:23.801136 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:45:23.802135 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:45:23.803037 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:45:23.803807 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:45:23.804637 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:45:23.806851 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:45:23.811072 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:45:23.812647 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:45:23.817995 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:45:23.822034 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:45:23.823054 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:45:23.824511 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:45:23.826089 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:45:23.831843 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:45:23.832877 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:45:23.835143 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:45:23.837538 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:45:23.839289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd3f2d9a0>]}
[0m15:45:23.840854 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eaa6714-bc2b-48e4-a28f-78aa13801182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd3f1c890>]}
[0m15:45:23.848352 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.29s]
[0m15:45:23.852252 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.31s]
[0m15:45:23.853993 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:45:23.855602 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:45:23.857565 [debug] [Thread-4 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:45:23.859050 [info ] [Thread-4 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:45:23.861609 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:45:23.862721 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:45:23.866106 [debug] [MainThread]: On master: COMMIT
[0m15:45:23.868963 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:23.871432 [debug] [MainThread]: On master: COMMIT
[0m15:45:23.873380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:23.894837 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m15:45:23.896397 [debug] [MainThread]: On master: Close
[0m15:45:23.897585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:23.898392 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:45:23.899196 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:45:23.899947 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:45:23.900625 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:45:23.901525 [info ] [MainThread]: 
[0m15:45:23.902411 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m15:45:23.905231 [debug] [MainThread]: Command end result
[0m15:45:24.039753 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:45:24.048948 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:45:24.066378 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:45:24.067296 [info ] [MainThread]: 
[0m15:45:24.068261 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:24.069170 [info ] [MainThread]: 
[0m15:45:24.070548 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:45:24.071451 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:45:24.072716 [info ] [MainThread]: 
[0m15:45:24.073526 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:45:24.074267 [info ] [MainThread]: 
[0m15:45:24.077347 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:45:24.079445 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.9752345, "process_in_blocks": "0", "process_kernel_time": 0.791521, "process_mem_max_rss": "164176", "process_out_blocks": "0", "process_user_time": 7.208066}
[0m15:45:24.081735 [debug] [MainThread]: Command `dbt build` failed at 15:45:24.081469 after 2.98 seconds
[0m15:45:24.082761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd70578f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd824b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76efd720f530>]}
[0m15:45:24.083633 [debug] [MainThread]: Flushing usage events
[0m15:45:25.244321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:02.055090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e185697bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e187f763f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e185697c20>]}


============================== 15:46:02.126914 | 03cb0fd0-0cc1-4f84-8aa8-002876ebff3a ==============================
[0m15:46:02.126914 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:46:02.128276 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m15:46:02.493983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e184d0f830>]}
[0m15:46:02.647908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e1859ca3c0>]}
[0m15:46:02.649789 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:46:02.840659 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:46:03.102661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:03.103659 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:46:03.104247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:03.155435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e184764410>]}
[0m15:46:03.288376 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:03.295972 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:03.712801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e184899b50>]}
[0m15:46:03.713730 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:46:03.717409 [info ] [MainThread]: 
[0m15:46:03.718177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:03.719216 [info ] [MainThread]: 
[0m15:46:03.726448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:03.732804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:03.733913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:03.740356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:03.825206 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:03.825928 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:03.826408 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:03.826925 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:03.827650 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:03.828382 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:03.829038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:03.829698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:03.830448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:03.853680 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m15:46:03.856250 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:03.856930 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m15:46:03.857418 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m15:46:03.859621 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:03.862005 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:03.866570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:46:03.867696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:46:03.874184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:46:03.878877 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:46:03.881581 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:46:03.884454 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:46:03.885347 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:46:03.886306 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:46:03.887084 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:46:03.887791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:03.888445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:03.889155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:03.914510 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.027 seconds
[0m15:46:03.915439 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.026 seconds
[0m15:46:03.916595 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.028 seconds
[0m15:46:03.918458 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:46:03.920606 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:46:03.922546 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:46:03.923513 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:46:03.924020 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:46:03.924714 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:46:03.935328 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:03.936379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:46:03.937155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:03.961896 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m15:46:03.964096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e184dd5f70>]}
[0m15:46:03.964861 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:03.965695 [debug] [MainThread]: On master: COMMIT
[0m15:46:03.966386 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:03.967074 [debug] [MainThread]: On master: COMMIT
[0m15:46:03.968722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:03.969631 [debug] [MainThread]: On master: Close
[0m15:46:03.981054 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:46:03.981868 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:46:03.982453 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:46:03.983178 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:46:03.984202 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:46:03.985071 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:46:03.985984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launches)
[0m15:46:03.986956 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:46:03.987746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_rockets)
[0m15:46:03.988561 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:46:03.989650 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:46:03.990461 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:46:04.005004 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:46:04.001489 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:46:04.056155 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:46:04.224998 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:46:04.233324 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:46:04.267877 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:46:04.372965 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:46:04.373912 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:46:04.374603 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:46:04.380611 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:46:04.381416 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:04.382199 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:46:04.383235 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:46:04.384285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:04.384852 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:04.385607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:04.386870 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:46:04.388435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:46:04.401480 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:46:04.404901 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:46:04.408477 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:46:04.412212 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m15:46:04.420724 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m15:46:04.423626 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:04.436478 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:04.432257 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:04.440481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e181c12810>]}
[0m15:46:04.441331 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:46:04.442397 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:46:04.443866 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.45s]
[0m15:46:04.446335 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:46:04.447014 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:46:04.447945 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:46:04.448674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:46:04.453045 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:04.459399 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:04.460510 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:46:04.461436 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:46:04.463408 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:04.464154 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:04.511166 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:46:04.514321 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:46:04.514906 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:04.515724 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:04.516456 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:46:04.517208 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:46:04.519848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:04.526081 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:46:04.531095 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:46:04.534426 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:46:04.544756 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:04.545773 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:04.546725 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:46:04.547589 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:46:04.553781 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:46:04.557743 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:46:04.558527 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:46:04.559515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e181c5bdd0>]}
[0m15:46:04.561398 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:46:04.562769 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.57s]
[0m15:46:04.563955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e181c0b380>]}
[0m15:46:04.564877 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:46:04.566128 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.58s]
[0m15:46:04.568010 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:46:04.569030 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:46:04.570083 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:46:04.571643 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_launchpads'
[0m15:46:04.572262 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:46:04.572835 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:46:04.573370 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:46:04.574471 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:46:04.575350 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:46:04.579661 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:46:04.580611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:46:04.581433 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:46:04.582651 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:46:04.583550 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:46:04.587476 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:46:04.593881 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:46:04.601129 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:46:04.666046 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:46:04.670197 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:46:04.680105 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:04.680945 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:04.681654 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:46:04.682731 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:46:04.683642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:46:04.684556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:04.710426 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m15:46:04.719738 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.035 seconds
[0m15:46:04.737213 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:04.739205 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:04.740092 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:46:04.741349 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:46:04.744067 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:04.745053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:46:04.756966 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:04.763463 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:04.765921 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:46:04.767204 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:46:04.769634 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:04.770637 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:46:04.775261 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:46:04.780035 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:46:04.781308 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:04.782510 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:04.783800 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:46:04.784928 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:46:04.789512 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:46:04.794553 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:46:04.795538 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m15:46:04.814473 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:04.812557 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:46:04.815921 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:46:04.818921 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:04.825636 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:46:04.829538 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:46:04.835389 [debug] [Thread-4 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:46:04.840597 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e183bed9a0>]}
[0m15:46:04.842857 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.27s]
[0m15:46:04.843877 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:46:04.848621 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:46:04.853980 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:46:04.856668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb0fd0-0cc1-4f84-8aa8-002876ebff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e181c83f20>]}
[0m15:46:04.860698 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.28s]
[0m15:46:04.866214 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:46:04.868995 [debug] [Thread-3 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:46:04.870547 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:46:04.871991 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:46:04.873192 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:46:04.876390 [debug] [MainThread]: On master: COMMIT
[0m15:46:04.877548 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:04.878589 [debug] [MainThread]: On master: COMMIT
[0m15:46:04.879783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:04.898921 [debug] [MainThread]: SQL status: COMMIT in 0.019 seconds
[0m15:46:04.899898 [debug] [MainThread]: On master: Close
[0m15:46:04.901080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:04.901894 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:46:04.902611 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:46:04.903281 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_rockets' was properly closed.
[0m15:46:04.904429 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:46:04.905505 [info ] [MainThread]: 
[0m15:46:04.906398 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m15:46:04.909021 [debug] [MainThread]: Command end result
[0m15:46:04.971968 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:04.978968 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:04.991748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:46:04.992498 [info ] [MainThread]: 
[0m15:46:04.993263 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:04.994082 [info ] [MainThread]: 
[0m15:46:04.994922 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:46:04.995767 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:04.996444 [info ] [MainThread]: 
[0m15:46:04.997261 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:04.997933 [info ] [MainThread]: 
[0m15:46:04.998642 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:46:05.000196 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.0730622, "process_in_blocks": "0", "process_kernel_time": 0.957069, "process_mem_max_rss": "164440", "process_out_blocks": "0", "process_user_time": 7.868334}
[0m15:46:05.001011 [debug] [MainThread]: Command `dbt build` failed at 15:46:05.000870 after 3.07 seconds
[0m15:46:05.001739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e1852ef890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e184f46150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e181c66630>]}
[0m15:46:05.002471 [debug] [MainThread]: Flushing usage events
[0m15:46:05.698745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:30.452034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70554095f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055431de900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705540a39af0>]}


============================== 15:46:30.580855 | 97145e81-bf96-415c-942e-8bb183148f2f ==============================
[0m15:46:30.580855 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:46:30.581877 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/app/dbt/logs'}
[0m15:46:31.138984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055406da600>]}
[0m15:46:31.328408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70554054cb60>]}
[0m15:46:31.330150 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:46:31.672763 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:46:32.089103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:32.090926 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:46:32.092721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:32.195555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553fe45d30>]}
[0m15:46:32.445389 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:32.452285 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:32.930039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553fb4f260>]}
[0m15:46:32.931086 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:46:32.935197 [info ] [MainThread]: 
[0m15:46:32.936253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:32.937496 [info ] [MainThread]: 
[0m15:46:32.939645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:32.947288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:32.957281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:32.975211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:33.153731 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:33.154405 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:33.154902 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:33.155564 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:33.156584 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:33.157688 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:33.158487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:33.159180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:33.159996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:33.188093 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.029 seconds
[0m15:46:33.191072 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.032 seconds
[0m15:46:33.193372 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:33.195832 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:33.196482 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.036 seconds
[0m15:46:33.200311 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:33.203856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:46:33.205016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:46:33.206030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:46:33.220724 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:46:33.224759 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:46:33.227822 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:46:33.228902 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:46:33.229836 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:46:33.230638 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:46:33.231538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:33.232287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:33.233186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:33.279280 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.048 seconds
[0m15:46:33.283288 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.051 seconds
[0m15:46:33.289614 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.056 seconds
[0m15:46:33.292582 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:46:33.293613 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:46:33.295530 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:46:33.296878 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:46:33.297417 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:46:33.298117 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:46:33.315514 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:33.316546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:46:33.317687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:33.378129 [debug] [MainThread]: SQL status: SELECT 4 in 0.060 seconds
[0m15:46:33.380498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055429c2d80>]}
[0m15:46:33.381436 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:33.382498 [debug] [MainThread]: On master: COMMIT
[0m15:46:33.383204 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:33.384073 [debug] [MainThread]: On master: COMMIT
[0m15:46:33.385348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:33.386159 [debug] [MainThread]: On master: Close
[0m15:46:33.401175 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:46:33.401991 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:46:33.402654 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:46:33.403666 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:46:33.405011 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:46:33.406553 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:46:33.412098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:46:33.413227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_launchpads)
[0m15:46:33.414132 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_rockets)
[0m15:46:33.415072 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:46:33.416085 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:46:33.417132 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:46:33.436937 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:46:33.444465 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:46:33.450603 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:46:33.463017 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:46:33.463868 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:46:33.494582 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:46:33.615892 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:46:33.617111 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:46:33.619033 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:46:33.634681 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:33.635576 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:46:33.636454 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:46:33.638982 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:46:33.640535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:33.641841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:33.642705 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:33.644489 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:46:33.645341 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:46:33.677313 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m15:46:33.665728 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:46:33.679035 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m15:46:33.700147 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:33.701071 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:46:33.706003 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:33.707614 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:46:33.709249 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:46:33.709936 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:46:33.712651 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:46:33.714312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:33.727033 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:33.742653 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:33.743487 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:46:33.744711 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:46:33.746878 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:33.749169 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:33.749818 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:33.752584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553cf62150>]}
[0m15:46:33.787684 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.34s]
[0m15:46:33.813856 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:46:33.817491 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:46:33.820254 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:46:33.821374 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:46:33.822645 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:33.825053 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:33.827519 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:46:33.828516 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:46:33.831656 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:33.838438 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:46:33.852706 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:46:33.853481 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:46:33.874707 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:46:33.867878 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:46:33.876358 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:46:33.877674 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:46:33.884617 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:46:33.890322 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:46:33.894432 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:46:33.897311 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:46:33.899064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553d0dd640>]}
[0m15:46:33.902974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553cf74680>]}
[0m15:46:33.904336 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.49s]
[0m15:46:33.907356 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.49s]
[0m15:46:33.909562 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:46:33.910924 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:46:33.912727 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:46:33.913968 [debug] [Thread-2 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:46:33.914720 [debug] [Thread-4 (]: Began running node model.spacex_dbt.fct_launches
[0m15:46:33.915628 [info ] [Thread-3 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:46:33.916969 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:46:33.918220 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:46:33.919669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:46:33.920846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_launchpads, now model.spacex_dbt.dim_rockets)
[0m15:46:33.922367 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:46:33.924943 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:46:33.926313 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:46:33.927551 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:46:33.932102 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:46:33.936583 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:46:33.948048 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:46:33.958717 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:46:34.031309 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:46:34.048557 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:46:34.056237 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:34.058080 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:46:34.059247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:46:34.060056 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:34.061826 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:46:34.063003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:46:34.105047 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.046 seconds
[0m15:46:34.105775 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.043 seconds
[0m15:46:34.127527 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:34.128275 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:34.128881 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:46:34.129810 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:46:34.131820 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:34.137066 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:46:34.144161 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:34.148854 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:34.149977 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:46:34.151047 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:46:34.152936 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:34.153606 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:34.155952 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:46:34.163967 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:46:34.164920 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:34.165838 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:34.166678 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:46:34.167674 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:46:34.170906 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:34.175655 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:46:34.176409 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m15:46:34.195309 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:46:34.196092 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:46:34.197422 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:46:34.198350 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:46:34.199517 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:46:34.208357 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:46:34.209913 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:46:34.212130 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:46:34.214626 [debug] [Thread-2 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:46:34.216121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553cf0bce0>]}
[0m15:46:34.217176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97145e81-bf96-415c-942e-8bb183148f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553d0fbc20>]}
[0m15:46:34.220388 [info ] [Thread-3 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.30s]
[0m15:46:34.222430 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.30s]
[0m15:46:34.224243 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:46:34.225881 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:46:34.228782 [debug] [Thread-1 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:46:34.229883 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:46:34.230835 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:46:34.231971 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:46:34.235084 [debug] [MainThread]: On master: COMMIT
[0m15:46:34.236690 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:34.237490 [debug] [MainThread]: On master: COMMIT
[0m15:46:34.238734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:34.253940 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:46:34.256028 [debug] [MainThread]: On master: Close
[0m15:46:34.257412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:34.258551 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:46:34.259463 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:46:34.260122 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:46:34.261593 [info ] [MainThread]: 
[0m15:46:34.262793 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m15:46:34.265626 [debug] [MainThread]: Command end result
[0m15:46:34.328571 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:34.335474 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:34.352638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:46:34.353922 [info ] [MainThread]: 
[0m15:46:34.354840 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:34.355990 [info ] [MainThread]: 
[0m15:46:34.358911 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:46:34.360825 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:34.361648 [info ] [MainThread]: 
[0m15:46:34.364013 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:46:34.365305 [info ] [MainThread]: 
[0m15:46:34.366174 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:46:34.367971 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.1416564, "process_in_blocks": "0", "process_kernel_time": 1.374233, "process_mem_max_rss": "163376", "process_out_blocks": "0", "process_user_time": 10.489136}
[0m15:46:34.369036 [debug] [MainThread]: Command `dbt build` failed at 15:46:34.368846 after 4.14 seconds
[0m15:46:34.369815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7055410d78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553cf12330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70553cf741d0>]}
[0m15:46:34.370587 [debug] [MainThread]: Flushing usage events
[0m15:46:35.158386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:12.306704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089d699a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e70899aec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089e8f530>]}


============================== 15:47:12.368006 | 54f0dc35-f76e-4f6b-84a0-e40fa6135fef ==============================
[0m15:47:12.368006 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:47:12.369097 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/app/dbt', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:47:12.787743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089253dd0>]}
[0m15:47:12.918238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089c79190>]}
[0m15:47:12.919855 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:47:13.077997 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:47:13.365528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:47:13.366375 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:47:13.366984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:47:13.419805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089157b90>]}
[0m15:47:13.542052 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:47:13.549526 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:47:13.841162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7088fa5b20>]}
[0m15:47:13.842081 [info ] [MainThread]: Found 7 models, 3 sources, 464 macros
[0m15:47:13.845619 [info ] [MainThread]: 
[0m15:47:13.846382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:13.847047 [info ] [MainThread]: 
[0m15:47:13.847972 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:47:13.854563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:47:13.863014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:47:13.878338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:47:13.947555 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:47:13.948328 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:47:13.948851 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:47:13.949427 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:13.950341 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:13.951250 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:47:13.952135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:13.953068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:13.953943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:13.974820 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m15:47:13.975407 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.022 seconds
[0m15:47:13.977402 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:47:13.978463 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m15:47:13.980379 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:47:13.983327 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:47:13.990749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_gold)
[0m15:47:13.991877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_marts)
[0m15:47:13.998390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics_analytics_staging)
[0m15:47:14.008247 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_gold"
[0m15:47:14.009256 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_marts"
[0m15:47:14.012360 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics_analytics_staging"
[0m15:47:14.013488 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_gold"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_gold'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_gold'
  
[0m15:47:14.014458 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_marts"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_marts'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_marts'
  
[0m15:47:14.015339 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics_analytics_staging"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m15:47:14.016149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:14.016980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:14.017712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:14.046290 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.030 seconds
[0m15:47:14.046954 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.029 seconds
[0m15:47:14.048944 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: ROLLBACK
[0m15:47:14.049565 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.033 seconds
[0m15:47:14.051294 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: ROLLBACK
[0m15:47:14.052422 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_gold: Close
[0m15:47:14.054338 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: ROLLBACK
[0m15:47:14.055397 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_staging: Close
[0m15:47:14.056565 [debug] [ThreadPool]: On list_spacex_db_analytics_analytics_marts: Close
[0m15:47:14.067168 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:14.068079 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:47:14.069095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:14.094051 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m15:47:14.096299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7088fa5520>]}
[0m15:47:14.097171 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:14.097992 [debug] [MainThread]: On master: COMMIT
[0m15:47:14.098729 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:14.099325 [debug] [MainThread]: On master: COMMIT
[0m15:47:14.100334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:14.100964 [debug] [MainThread]: On master: Close
[0m15:47:14.107313 [debug] [Thread-1 (]: Began running node model.spacex_dbt.stg_launches
[0m15:47:14.108024 [debug] [Thread-2 (]: Began running node model.spacex_dbt.stg_launchpads
[0m15:47:14.108598 [debug] [Thread-3 (]: Began running node model.spacex_dbt.stg_rockets
[0m15:47:14.109388 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_analytics_staging.stg_launches ........... [RUN]
[0m15:47:14.110567 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_analytics_staging.stg_launchpads ......... [RUN]
[0m15:47:14.111613 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_analytics_staging.stg_rockets ............ [RUN]
[0m15:47:14.112787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_marts, now model.spacex_dbt.stg_launches)
[0m15:47:14.114185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_staging, now model.spacex_dbt.stg_launchpads)
[0m15:47:14.115142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics_analytics_gold, now model.spacex_dbt.stg_rockets)
[0m15:47:14.115979 [debug] [Thread-1 (]: Began compiling node model.spacex_dbt.stg_launches
[0m15:47:14.116747 [debug] [Thread-2 (]: Began compiling node model.spacex_dbt.stg_launchpads
[0m15:47:14.117553 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.stg_rockets
[0m15:47:14.128214 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_dbt.stg_launches"
[0m15:47:14.131574 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_dbt.stg_launchpads"
[0m15:47:14.137834 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.stg_rockets"
[0m15:47:14.144964 [debug] [Thread-1 (]: Began executing node model.spacex_dbt.stg_launches
[0m15:47:14.145610 [debug] [Thread-2 (]: Began executing node model.spacex_dbt.stg_launchpads
[0m15:47:14.167978 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.stg_rockets
[0m15:47:14.226790 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.stg_rockets"
[0m15:47:14.231023 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_dbt.stg_launchpads"
[0m15:47:14.231884 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_dbt.stg_launches"
[0m15:47:14.241423 [debug] [Thread-1 (]: Using postgres connection "model.spacex_dbt.stg_launches"
[0m15:47:14.242267 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:47:14.243055 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launches"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launches__dbt_tmp"
    
    
  as (
    select
    launch_id,
    rocket_id,
    date_utc::timestamptz as launch_date,
    name as mission,
    success,
    flight_number,
    launchpad_id,
    launch_year
from "spacex_db"."public"."silver_launches"
  );
[0m15:47:14.244194 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp"
    
    
  as (
    select
    rocket_id,
    name as rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."public"."silver_rockets"
  );
[0m15:47:14.245063 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:47:14.245659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:14.246502 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:14.247341 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */

  create view "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp"
    
    
  as (
    -- models/staging/stg_launchpads.sql
select
    launchpad_id,
    name as launchpad_name,
    locality,
    region
from "spacex_db"."public"."silver_launchpads" -- Tabela silver_launchpads, agora no schema correto
  );
[0m15:47:14.250762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:47:14.265763 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "launch_year" does not exist
LINE 15:     launch_year
             ^

[0m15:47:14.267400 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: ROLLBACK
[0m15:47:14.266799 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m15:47:14.268043 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m15:47:14.269134 [debug] [Thread-1 (]: On model.spacex_dbt.stg_launches: Close
[0m15:47:14.279235 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:47:14.283921 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:47:14.286740 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:47:14.289095 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads" rename to "stg_launchpads__dbt_backup"
[0m15:47:14.292276 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:14.295820 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:47:14.297439 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:47:14.302697 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:47:14.307891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7088e4fcb0>]}
[0m15:47:14.312315 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:47:14.313346 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:47:14.314647 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model analytics_analytics_staging.stg_launches .. [[31mERROR[0m in 0.19s]
[0m15:47:14.315564 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
alter table "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_tmp" rename to "stg_launchpads"
[0m15:47:14.318535 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:47:14.319665 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.stg_launches
[0m15:47:14.332755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:47:14.339626 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql.
[0m15:47:14.358967 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:47:14.360969 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:47:14.362711 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:47:14.363576 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:47:14.364339 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: COMMIT
[0m15:47:14.365191 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: COMMIT
[0m15:47:14.368554 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:14.378663 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m15:47:14.391575 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup"
[0m15:47:14.392740 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup"
[0m15:47:14.405364 [debug] [Thread-2 (]: Using postgres connection "model.spacex_dbt.stg_launchpads"
[0m15:47:14.405882 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.stg_rockets"
[0m15:47:14.406626 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_launchpads"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_launchpads__dbt_backup" cascade
[0m15:47:14.407561 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.stg_rockets"} */
drop view if exists "spacex_db"."analytics_analytics_staging"."stg_rockets__dbt_backup" cascade
[0m15:47:14.414007 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:47:14.417650 [debug] [Thread-3 (]: On model.spacex_dbt.stg_rockets: Close
[0m15:47:14.418274 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:47:14.419455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7086368c20>]}
[0m15:47:14.422267 [debug] [Thread-2 (]: On model.spacex_dbt.stg_launchpads: Close
[0m15:47:14.423598 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_analytics_staging.stg_rockets ....... [[32mCREATE VIEW[0m in 0.30s]
[0m15:47:14.424780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7086354080>]}
[0m15:47:14.425685 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.stg_rockets
[0m15:47:14.426924 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_analytics_staging.stg_launchpads .... [[32mCREATE VIEW[0m in 0.31s]
[0m15:47:14.428496 [debug] [Thread-4 (]: Began running node model.spacex_dbt.dim_rockets
[0m15:47:14.429413 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.stg_launchpads
[0m15:47:14.430335 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_analytics_marts.dim_rockets ............. [RUN]
[0m15:47:14.431747 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_dbt.dim_rockets'
[0m15:47:14.432396 [debug] [Thread-3 (]: Began running node model.spacex_dbt.dim_launchpads
[0m15:47:14.432948 [debug] [Thread-1 (]: Began running node model.spacex_dbt.fct_launches
[0m15:47:14.433502 [debug] [Thread-4 (]: Began compiling node model.spacex_dbt.dim_rockets
[0m15:47:14.435115 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics_analytics_marts.dim_launchpads .......... [RUN]
[0m15:47:14.436293 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_analytics_marts.fct_launches .................... [[33mSKIP[0m]
[0m15:47:14.441698 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_dbt.dim_rockets"
[0m15:47:14.442833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.spacex_dbt.stg_rockets, now model.spacex_dbt.dim_launchpads)
[0m15:47:14.443800 [debug] [Thread-1 (]: Finished running node model.spacex_dbt.fct_launches
[0m15:47:14.445093 [debug] [Thread-3 (]: Began compiling node model.spacex_dbt.dim_launchpads
[0m15:47:14.446498 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.fct_launches' to be skipped because of status 'skipped'. 
[0m15:47:14.450498 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_dbt.dim_launchpads"
[0m15:47:14.455796 [debug] [Thread-4 (]: Began executing node model.spacex_dbt.dim_rockets
[0m15:47:14.461938 [debug] [Thread-3 (]: Began executing node model.spacex_dbt.dim_launchpads
[0m15:47:14.515703 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_dbt.dim_launchpads"
[0m15:47:14.516493 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_dbt.dim_rockets"
[0m15:47:14.523378 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:47:14.524181 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp"
  
  
    as
  
  (
    select
    launchpad_id,
    launchpad_name,
    locality,
    region
from "spacex_db"."analytics_analytics_staging"."stg_launchpads"
  );
  
[0m15:47:14.524821 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:47:14.525402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:47:14.526186 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    select
    rocket_id,
    rocket_name,
    active,
    cost_per_launch,
    success_rate_pct
from "spacex_db"."analytics_analytics_staging"."stg_rockets"
  );
  
[0m15:47:14.527715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:47:14.552401 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.025 seconds
[0m15:47:14.553170 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.028 seconds
[0m15:47:14.562406 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:47:14.566278 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:47:14.567138 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:47:14.568013 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads" rename to "dim_launchpads__dbt_backup"
[0m15:47:14.569852 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:14.570495 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:14.574765 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:47:14.581596 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:47:14.582293 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:47:14.583274 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
alter table "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_tmp" rename to "dim_launchpads"
[0m15:47:14.585311 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:47:14.588323 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:47:14.589072 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:47:14.589683 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:47:14.592035 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:47:14.592913 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: COMMIT
[0m15:47:14.593908 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:47:14.595260 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: COMMIT
[0m15:47:14.596771 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:47:14.600484 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup"
[0m15:47:14.601108 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m15:47:14.606146 [debug] [Thread-4 (]: Using postgres connection "model.spacex_dbt.dim_rockets"
[0m15:47:14.610168 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup"
[0m15:47:14.611085 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_rockets"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_rockets__dbt_backup" cascade
[0m15:47:14.612501 [debug] [Thread-3 (]: Using postgres connection "model.spacex_dbt.dim_launchpads"
[0m15:47:14.617188 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_dbt.dim_launchpads"} */
drop table if exists "spacex_db"."analytics_analytics_marts"."dim_launchpads__dbt_backup" cascade
[0m15:47:14.619056 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:47:14.621475 [debug] [Thread-4 (]: On model.spacex_dbt.dim_rockets: Close
[0m15:47:14.622678 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e70863380e0>]}
[0m15:47:14.623752 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:47:14.625645 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_analytics_marts.dim_rockets ........ [[32mSELECT 0[0m in 0.19s]
[0m15:47:14.627942 [debug] [Thread-3 (]: On model.spacex_dbt.dim_launchpads: Close
[0m15:47:14.629105 [debug] [Thread-4 (]: Finished running node model.spacex_dbt.dim_rockets
[0m15:47:14.630202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54f0dc35-f76e-4f6b-84a0-e40fa6135fef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e70864df0b0>]}
[0m15:47:14.631695 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics_analytics_marts.dim_launchpads ..... [[32mSELECT 0[0m in 0.19s]
[0m15:47:14.632472 [debug] [Thread-2 (]: Began running node model.spacex_dbt.gold_rocket_performance
[0m15:47:14.633357 [debug] [Thread-3 (]: Finished running node model.spacex_dbt.dim_launchpads
[0m15:47:14.634380 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_analytics_gold.gold_rocket_performance .......... [[33mSKIP[0m]
[0m15:47:14.635816 [debug] [Thread-2 (]: Finished running node model.spacex_dbt.gold_rocket_performance
[0m15:47:14.636549 [debug] [Thread-7 (]: Marking all children of 'model.spacex_dbt.gold_rocket_performance' to be skipped because of status 'skipped'. 
[0m15:47:14.639418 [debug] [MainThread]: On master: COMMIT
[0m15:47:14.640114 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:14.640745 [debug] [MainThread]: On master: COMMIT
[0m15:47:14.641369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:14.656122 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:47:14.657073 [debug] [MainThread]: On master: Close
[0m15:47:14.657975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:14.658617 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_launchpads' was properly closed.
[0m15:47:14.659231 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launches' was properly closed.
[0m15:47:14.659844 [debug] [MainThread]: Connection 'model.spacex_dbt.stg_launchpads' was properly closed.
[0m15:47:14.660425 [debug] [MainThread]: Connection 'model.spacex_dbt.dim_rockets' was properly closed.
[0m15:47:14.661327 [info ] [MainThread]: 
[0m15:47:14.662109 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m15:47:14.664675 [debug] [MainThread]: Command end result
[0m15:47:14.709622 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:47:14.717027 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:47:14.731074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:47:14.731962 [info ] [MainThread]: 
[0m15:47:14.732916 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:14.733732 [info ] [MainThread]: 
[0m15:47:14.734615 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m15:47:14.735485 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "launch_year" does not exist
  LINE 15:     launch_year
               ^
  compiled code at target/run/spacex_dbt/models/staging/stg_launches.sql
[0m15:47:14.736220 [info ] [MainThread]: 
[0m15:47:14.737072 [info ] [MainThread]:   compiled code at target/compiled/spacex_dbt/models/staging/stg_launches.sql
[0m15:47:14.737820 [info ] [MainThread]: 
[0m15:47:14.738695 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m15:47:14.740522 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.569185, "process_in_blocks": "0", "process_kernel_time": 1.019382, "process_mem_max_rss": "163740", "process_out_blocks": "0", "process_user_time": 7.479665}
[0m15:47:14.741595 [debug] [MainThread]: Command `dbt build` failed at 15:47:14.741410 after 2.57 seconds
[0m15:47:14.742716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7089d699a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e708a61a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e708637fb30>]}
[0m15:47:14.743696 [debug] [MainThread]: Flushing usage events
[0m15:47:15.392812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:22.644196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5bfa66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5b2c3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5b2c07a0>]}


============================== 15:48:22.728350 | a0d0ba51-3eb4-4e8a-9f84-3cd6c1e4d612 ==============================
[0m15:48:22.728350 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:48:22.730293 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False'}
[0m15:48:23.194733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0d0ba51-3eb4-4e8a-9f84-3cd6c1e4d612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5daa85f0>]}
[0m15:48:23.349491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0d0ba51-3eb4-4e8a-9f84-3cd6c1e4d612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5ae94d40>]}
[0m15:48:23.352197 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:48:23.570868 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:48:23.905661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:23.907234 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:48:24.491925 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_dbt.stg_launches' (models/staging/stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m15:48:24.494040 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0135987, "process_in_blocks": "0", "process_kernel_time": 0.927331, "process_mem_max_rss": "124552", "process_out_blocks": "0", "process_user_time": 8.040996}
[0m15:48:24.495157 [debug] [MainThread]: Command `dbt build` failed at 15:48:24.494895 after 2.01 seconds
[0m15:48:24.495909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5afa5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea599ab770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cea5996c1a0>]}
[0m15:48:24.496798 [debug] [MainThread]: Flushing usage events
[0m15:48:25.356105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:01.093681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a129bdbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a129bc8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a129a53980>]}


============================== 15:49:01.161969 | e0347b52-a4b6-4e54-9542-870508b72fe0 ==============================
[0m15:49:01.161969 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:49:01.163088 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '/app/dbt', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m15:49:01.473749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0347b52-a4b6-4e54-9542-870508b72fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a1290faa20>]}
[0m15:49:01.593964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0347b52-a4b6-4e54-9542-870508b72fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a129e47e30>]}
[0m15:49:01.595561 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:49:01.748117 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:49:02.035638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:02.037032 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:49:02.431574 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_dbt.stg_launches' (models/staging/stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m15:49:02.433578 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4631292, "process_in_blocks": "0", "process_kernel_time": 0.547112, "process_mem_max_rss": "124704", "process_out_blocks": "0", "process_user_time": 5.750676}
[0m15:49:02.434636 [debug] [MainThread]: Command `dbt build` failed at 15:49:02.434462 after 1.46 seconds
[0m15:49:02.435504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a12a3324b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a128f03c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a128f00a10>]}
[0m15:49:02.436329 [debug] [MainThread]: Flushing usage events
[0m15:49:03.093757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:39.158285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b5979dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b1ac3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b30eb920>]}


============================== 15:49:39.231384 | af6dd691-a51f-4910-88ca-fd0a512b3831 ==============================
[0m15:49:39.231384 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:49:39.232465 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'profiles_dir': '/app/dbt'}
[0m15:49:39.559867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6dd691-a51f-4910-88ca-fd0a512b3831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b13095b0>]}
[0m15:49:39.689905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6dd691-a51f-4910-88ca-fd0a512b3831', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b1ab2540>]}
[0m15:49:39.691629 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:49:39.856547 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:49:40.127839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:40.129198 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:49:40.508456 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_dbt.stg_launches' (models/staging/stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m15:49:40.510498 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5071392, "process_in_blocks": "0", "process_kernel_time": 0.662129, "process_mem_max_rss": "124552", "process_out_blocks": "0", "process_user_time": 6.227265}
[0m15:49:40.511524 [debug] [MainThread]: Command `dbt build` failed at 15:49:40.511363 after 1.51 seconds
[0m15:49:40.512650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184b5979dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184aff8da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7184aff8ca40>]}
[0m15:49:40.513644 [debug] [MainThread]: Flushing usage events
[0m15:49:41.357417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:05.363867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab84b78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab96a3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab5814050>]}


============================== 15:50:05.450097 | c3d72d07-02b0-4e1f-b671-d2bc088a9005 ==============================
[0m15:50:05.450097 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:50:05.451620 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'empty': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'version_check': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80'}
[0m15:50:05.889329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3d72d07-02b0-4e1f-b671-d2bc088a9005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab7fc4500>]}
[0m15:50:06.045988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3d72d07-02b0-4e1f-b671-d2bc088a9005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab63f9a30>]}
[0m15:50:06.047824 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:50:06.242612 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:50:06.574656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:06.575837 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:50:07.101914 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_dbt.stg_launches' (models/staging/stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m15:50:07.104297 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8895242, "process_in_blocks": "0", "process_kernel_time": 0.835133, "process_mem_max_rss": "125064", "process_out_blocks": "0", "process_user_time": 7.83396}
[0m15:50:07.105569 [debug] [MainThread]: Command `dbt build` failed at 15:50:07.105328 after 1.89 seconds
[0m15:50:07.106412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab84b78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab41ba8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706ab50ddc40>]}
[0m15:50:07.107236 [debug] [MainThread]: Flushing usage events
[0m15:50:07.767608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:43.596996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e5c7f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e5e613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e5b51d00>]}


============================== 15:50:43.667972 | 68ba6e0d-4d63-4e06-8580-8194ef658558 ==============================
[0m15:50:43.667972 [info ] [MainThread]: Running with dbt=1.11.6
[0m15:50:43.669361 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/app/dbt', 'write_json': 'True', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None'}
[0m15:50:44.027027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68ba6e0d-4d63-4e06-8580-8194ef658558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e515f740>]}
[0m15:50:44.221566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68ba6e0d-4d63-4e06-8580-8194ef658558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e5303680>]}
[0m15:50:44.223066 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:50:44.383514 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m15:50:44.677777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:44.679038 [debug] [MainThread]: Partial parsing: updated file: spacex_dbt://models/staging/stg_launches.sql
[0m15:50:45.337763 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_dbt.stg_launches' (models/staging/stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m15:50:45.339857 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8709134, "process_in_blocks": "0", "process_kernel_time": 0.593776, "process_mem_max_rss": "124888", "process_out_blocks": "0", "process_user_time": 6.322696}
[0m15:50:45.340947 [debug] [MainThread]: Command `dbt build` failed at 15:50:45.340764 after 1.87 seconds
[0m15:50:45.341869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e5e613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e4fa9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7989e4127e00>]}
[0m15:50:45.342963 [debug] [MainThread]: Flushing usage events
[0m15:50:46.170840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:44.653806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e48a25dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e48f34560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e48f40830>]}


============================== 14:05:44.737068 | 5938747c-c4c2-468e-8f21-8c4ad31b2376 ==============================
[0m14:05:44.737068 [info ] [MainThread]: Running with dbt=1.11.6
[0m14:05:44.738371 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /app/dbt --profiles-dir /app/dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True'}
[0m14:05:44.749351 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       host: "{{ env_var('POSTGRES_HOST') }}"
    7  |       user: "{{ env_var('POSTGRES_USER') }}"
    8  |       password: "{{ env_var('POSTGRES_PASSWORD') }}"
    9  |       port: {{ env_var('POSTGRES_PORT') | int }}
    10 |       dbname: "{{ env_var('POSTGRES_DB') }}"
    11 |       schema: public # Onde as tabelas Gold/Marts serão criadas
    12 |       threads: 4
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 9, column 13
    found unhashable key
      in "<unicode string>", line 9, column 14
  
[0m14:05:44.750966 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.1244542, "process_in_blocks": "26056", "process_kernel_time": 0.635396, "process_mem_max_rss": "123172", "process_out_blocks": "0", "process_user_time": 4.722978}
[0m14:05:44.751758 [debug] [MainThread]: Command `dbt build` failed at 14:05:44.751624 after 0.13 seconds
[0m14:05:44.752452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e49253aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e48f42960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b3e48f36000>]}
[0m14:05:44.753658 [debug] [MainThread]: Flushing usage events
[0m14:05:46.259073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:02.961671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d37a66630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d372e69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d3784bf50>]}


============================== 17:38:03.053845 | 8d173776-7164-4dbc-a670-dd6e3212d9af ==============================
[0m17:38:03.053845 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:38:03.055224 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default', 'printer_width': '80'}
[0m17:38:03.357556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d173776-7164-4dbc-a670-dd6e3212d9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d37234d70>]}
[0m17:38:03.510543 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:38:03.522094 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:38:03.529363 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7177475, "process_in_blocks": "3200", "process_kernel_time": 0.698338, "process_mem_max_rss": "124928", "process_out_blocks": "0", "process_user_time": 5.849615}
[0m17:38:03.543411 [debug] [MainThread]: Command `dbt deps` succeeded at 17:38:03.543138 after 0.73 seconds
[0m17:38:03.560511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d37655220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d376569f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753d3756eea0>]}
[0m17:38:03.574626 [debug] [MainThread]: Flushing usage events
[0m17:38:04.676516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:12.218018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3323172f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e332f05b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3323163c0>]}


============================== 17:38:12.294424 | d79f145c-3353-4df2-86ce-48e96472e3cf ==============================
[0m17:38:12.294424 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:38:12.295783 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'debug': 'False'}
[0m17:38:12.352486 [info ] [MainThread]: dbt version: 1.11.6
[0m17:38:12.353393 [info ] [MainThread]: python version: 3.12.12
[0m17:38:12.354118 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:38:12.354833 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:38:12.473284 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m17:38:12.474302 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m17:38:12.475159 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m17:38:12.476311 [info ] [MainThread]: adapter type: postgres
[0m17:38:12.477593 [info ] [MainThread]: adapter version: 1.10.0
[0m17:38:12.694894 [info ] [MainThread]: Configuration:
[0m17:38:12.696138 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:38:12.697187 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:38:12.697944 [info ] [MainThread]: Required dependencies:
[0m17:38:12.698926 [debug] [MainThread]: Executing "git --help"
[0m17:38:12.702665 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:38:12.703813 [debug] [MainThread]: STDERR: "b''"
[0m17:38:12.704560 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:38:12.705280 [info ] [MainThread]: Connection:
[0m17:38:12.706021 [info ] [MainThread]:   host: db
[0m17:38:12.706710 [info ] [MainThread]:   port: 5432
[0m17:38:12.707437 [info ] [MainThread]:   user: postgres
[0m17:38:12.708103 [info ] [MainThread]:   database: spacex_db
[0m17:38:12.708801 [info ] [MainThread]:   schema: analytics
[0m17:38:12.709516 [info ] [MainThread]:   connect_timeout: 10
[0m17:38:12.710220 [info ] [MainThread]:   role: None
[0m17:38:12.710909 [info ] [MainThread]:   search_path: None
[0m17:38:12.711645 [info ] [MainThread]:   keepalives_idle: 0
[0m17:38:12.712494 [info ] [MainThread]:   sslmode: None
[0m17:38:12.713248 [info ] [MainThread]:   sslcert: None
[0m17:38:12.713949 [info ] [MainThread]:   sslkey: None
[0m17:38:12.714616 [info ] [MainThread]:   sslrootcert: None
[0m17:38:12.715451 [info ] [MainThread]:   application_name: dbt
[0m17:38:12.716301 [info ] [MainThread]:   retries: 1
[0m17:38:12.717181 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:38:12.872735 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:38:12.952017 [debug] [MainThread]: Using postgres connection "debug"
[0m17:38:12.952830 [debug] [MainThread]: On debug: select 1 as id
[0m17:38:12.953530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:12.974068 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m17:38:12.975864 [debug] [MainThread]: On debug: Close
[0m17:38:12.976638 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:38:12.977503 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:38:12.979765 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8973004, "process_in_blocks": "96", "process_kernel_time": 0.785678, "process_mem_max_rss": "124748", "process_out_blocks": "0", "process_user_time": 6.617347}
[0m17:38:12.980758 [debug] [MainThread]: Command `dbt debug` succeeded at 17:38:12.980610 after 0.90 seconds
[0m17:38:12.981476 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:38:12.982164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e3313c5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e331a1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e331d995e0>]}
[0m17:38:12.982951 [debug] [MainThread]: Flushing usage events
[0m17:38:13.610533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:20.909664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58adc0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58d492180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58a8b0800>]}


============================== 17:38:20.984929 | 227ab82a-eda9-49a6-85de-09b6edbcbb43 ==============================
[0m17:38:20.984929 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:38:20.985909 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default'}
[0m17:38:21.444449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58a6caab0>]}
[0m17:38:21.572415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58abdc170>]}
[0m17:38:21.574101 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:38:21.743508 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:38:22.080696 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:38:22.082814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58b043140>]}
[0m17:38:24.367340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5891ddf70>]}
[0m17:38:24.540042 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:38:24.549589 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:38:24.648044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed588d55760>]}
[0m17:38:24.648936 [info ] [MainThread]: Found 5 models, 4 data tests, 5 sources, 464 macros
[0m17:38:24.649680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed588d0a450>]}
[0m17:38:24.652573 [info ] [MainThread]: 
[0m17:38:24.653281 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:24.653941 [info ] [MainThread]: 
[0m17:38:24.655041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:24.663021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m17:38:24.748223 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m17:38:24.749248 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m17:38:24.750063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:24.771938 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m17:38:24.774550 [debug] [ThreadPool]: On list_spacex_db: Close
[0m17:38:24.777434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m17:38:24.786384 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m17:38:24.787493 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:38:24.788305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:24.814803 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m17:38:24.817196 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m17:38:24.818247 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m17:38:24.826142 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:24.827231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:38:24.828154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:24.854978 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m17:38:24.857712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed588111a60>]}
[0m17:38:24.858900 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:24.859946 [debug] [MainThread]: On master: COMMIT
[0m17:38:24.860733 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:24.861498 [debug] [MainThread]: On master: COMMIT
[0m17:38:24.862784 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:38:24.863655 [debug] [MainThread]: On master: Close
[0m17:38:24.875656 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m17:38:24.876405 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m17:38:24.877246 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m17:38:24.878258 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m17:38:24.879072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m17:38:24.880035 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m17:38:24.880773 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m17:38:24.881712 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m17:38:24.894092 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m17:38:24.898202 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m17:38:24.921511 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m17:38:24.951060 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m17:38:25.009257 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m17:38:25.006379 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m17:38:25.023372 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:38:25.024340 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)

SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal, -- Converte 98 para 0.98
    NOW() AS stg_updated_at
FROM source
  );
[0m17:38:25.025303 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:25.026496 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:38:25.027343 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    COALESCE(success, FALSE) AS is_success, -- Trata nulos como falha por padrão de negócio
    rocket AS rocket_id,
    NOW() AS stg_updated_at
FROM source
  );
[0m17:38:25.028343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.049378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:38:25.059119 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m17:38:25.061777 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:38:25.066764 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:38:25.067736 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m17:38:25.068550 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m17:38:25.070981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.071570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:38:25.076158 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:38:25.081438 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:38:25.082423 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m17:38:25.083182 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m17:38:25.085002 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.085697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.126178 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:38:25.127050 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:38:25.127631 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:38:25.128370 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:38:25.129185 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:38:25.129895 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:38:25.133376 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:38:25.139701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:38:25.148763 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m17:38:25.149439 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m17:38:25.158995 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:38:25.160198 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:38:25.161715 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m17:38:25.162823 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m17:38:25.169711 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:38:25.173785 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m17:38:25.174403 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m17:38:25.177017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58b8b98b0>]}
[0m17:38:25.179311 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m17:38:25.180609 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m17:38:25.182023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed584110230>]}
[0m17:38:25.182930 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m17:38:25.184148 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m17:38:25.185743 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m17:38:25.187482 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m17:38:25.188426 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m17:38:25.189466 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m17:38:25.190193 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m17:38:25.194556 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m17:38:25.208999 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m17:38:25.244501 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m17:38:25.260119 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:38:25.261164 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets" -- Use REF, não SOURCE aqui
  );
  
[0m17:38:25.262224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:25.287699 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.025 seconds
[0m17:38:25.297398 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:38:25.298427 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m17:38:25.300236 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.304410 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:38:25.305342 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m17:38:25.306957 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.309291 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:38:25.310105 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:38:25.310906 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:38:25.314119 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:38:25.317921 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m17:38:25.323065 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:38:25.324325 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m17:38:25.331439 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:38:25.333825 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m17:38:25.334962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed587d31f10>]}
[0m17:38:25.336176 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.15s]
[0m17:38:25.337486 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m17:38:25.339200 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m17:38:25.340363 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m17:38:25.341435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m17:38:25.342270 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m17:38:25.347032 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m17:38:25.357334 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m17:38:25.362693 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m17:38:25.373502 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:38:25.374543 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m17:38:25.375505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:25.402532 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.027 seconds
[0m17:38:25.410001 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:38:25.411059 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m17:38:25.412843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.417225 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:38:25.418104 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m17:38:25.419762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:38:25.422014 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:38:25.422819 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:38:25.423638 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:38:25.426652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:38:25.430133 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m17:38:25.431339 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:38:25.432175 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m17:38:25.438669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:38:25.440961 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m17:38:25.442132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed587d10800>]}
[0m17:38:25.445596 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 0[0m in 0.10s]
[0m17:38:25.446808 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m17:38:25.448544 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m17:38:25.450017 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m17:38:25.451458 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m17:38:25.452482 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m17:38:25.462766 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m17:38:25.478738 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m17:38:25.483685 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m17:38:25.498675 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m17:38:25.499537 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    WITH rockets AS (
    SELECT 
        rocket_id,
        -- Ajuste: Use o nome real da coluna que está na dim_rockets
        -- Se você usou o SCHEMA_REGISTRY padrão, deve ser 'name'
        name AS rocket_name 
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id, -- Garantindo o nome para o JOIN
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
-- Agora as colunas coincidem com as tabelas acima
SELECT
    r.rocket_id,
    r.rocket_name, -- E não 'name'
    COUNT(l.launch_id) AS total_launches
FROM "spacex_db"."analytics"."dim_rockets" r
LEFT JOIN "spacex_db"."analytics"."fct_launches" l ON r.rocket_id = l.rocket_id
GROUP BY 1, 2
  );
[0m17:38:25.500325 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:38:25.514906 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name 
                 ^

[0m17:38:25.515948 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m17:38:25.517152 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m17:38:25.522911 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:38:25.523977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227ab82a-eda9-49a6-85de-09b6edbcbb43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed587d2d490>]}
[0m17:38:25.525169 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.07s]
[0m17:38:25.526425 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m17:38:25.527486 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m17:38:25.531370 [debug] [MainThread]: On master: COMMIT
[0m17:38:25.532109 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:25.532756 [debug] [MainThread]: On master: COMMIT
[0m17:38:25.533384 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:25.546860 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m17:38:25.547767 [debug] [MainThread]: On master: Close
[0m17:38:25.548829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:25.549610 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m17:38:25.550291 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m17:38:25.550969 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m17:38:25.552001 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m17:38:25.553052 [info ] [MainThread]: 
[0m17:38:25.553989 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m17:38:25.556675 [debug] [MainThread]: Command end result
[0m17:38:25.617074 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:38:25.624476 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:38:25.657683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:38:25.658477 [info ] [MainThread]: 
[0m17:38:25.659291 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:38:25.660049 [info ] [MainThread]: 
[0m17:38:25.660865 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m17:38:25.661704 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:38:25.662447 [info ] [MainThread]: 
[0m17:38:25.663227 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:38:25.663910 [info ] [MainThread]: 
[0m17:38:25.664712 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:38:25.666845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.947734, "process_in_blocks": "280", "process_kernel_time": 0.845587, "process_mem_max_rss": "139588", "process_out_blocks": "0", "process_user_time": 9.763437}
[0m17:38:25.667692 [debug] [MainThread]: Command `dbt run` failed at 17:38:25.667553 after 4.95 seconds
[0m17:38:25.668419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58ef6ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58a8af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed58a8afa40>]}
[0m17:38:25.669135 [debug] [MainThread]: Flushing usage events
[0m17:38:26.452265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:02.762306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c72477c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c72477f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c72477ca70>]}


============================== 17:43:02.835046 | 2b1f9fcd-abdf-4d68-b7af-82ece1dc357b ==============================
[0m17:43:02.835046 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:43:02.836176 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'empty': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None'}
[0m17:43:03.159542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b1f9fcd-abdf-4d68-b7af-82ece1dc357b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c725087380>]}
[0m17:43:03.237427 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:43:03.245744 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:43:03.252041 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.62658864, "process_in_blocks": "1408", "process_kernel_time": 0.679002, "process_mem_max_rss": "124632", "process_out_blocks": "0", "process_user_time": 5.876603}
[0m17:43:03.253246 [debug] [MainThread]: Command `dbt deps` succeeded at 17:43:03.253014 after 0.63 seconds
[0m17:43:03.254203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c724648a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c723ef3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c726af89b0>]}
[0m17:43:03.255017 [debug] [MainThread]: Flushing usage events
[0m17:43:03.919000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:10.280209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b72388a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b72cff680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b7328a960>]}


============================== 17:43:10.367287 | 41bfc568-36e1-4e74-8830-662cd991105b ==============================
[0m17:43:10.367287 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:43:10.368315 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '/app/dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True'}
[0m17:43:10.430977 [info ] [MainThread]: dbt version: 1.11.6
[0m17:43:10.431943 [info ] [MainThread]: python version: 3.12.12
[0m17:43:10.432777 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:43:10.433555 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:43:10.543863 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m17:43:10.545011 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m17:43:10.546038 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m17:43:10.547344 [info ] [MainThread]: adapter type: postgres
[0m17:43:10.548109 [info ] [MainThread]: adapter version: 1.10.0
[0m17:43:10.762015 [info ] [MainThread]: Configuration:
[0m17:43:10.763160 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:43:10.764018 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:43:10.764784 [info ] [MainThread]: Required dependencies:
[0m17:43:10.765630 [debug] [MainThread]: Executing "git --help"
[0m17:43:10.769717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:43:10.770869 [debug] [MainThread]: STDERR: "b''"
[0m17:43:10.771611 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:43:10.772494 [info ] [MainThread]: Connection:
[0m17:43:10.773273 [info ] [MainThread]:   host: db
[0m17:43:10.773986 [info ] [MainThread]:   port: 5432
[0m17:43:10.774774 [info ] [MainThread]:   user: postgres
[0m17:43:10.775532 [info ] [MainThread]:   database: spacex_db
[0m17:43:10.776374 [info ] [MainThread]:   schema: analytics
[0m17:43:10.777200 [info ] [MainThread]:   connect_timeout: 10
[0m17:43:10.777991 [info ] [MainThread]:   role: None
[0m17:43:10.778776 [info ] [MainThread]:   search_path: None
[0m17:43:10.779508 [info ] [MainThread]:   keepalives_idle: 0
[0m17:43:10.780244 [info ] [MainThread]:   sslmode: None
[0m17:43:10.780989 [info ] [MainThread]:   sslcert: None
[0m17:43:10.781736 [info ] [MainThread]:   sslkey: None
[0m17:43:10.782439 [info ] [MainThread]:   sslrootcert: None
[0m17:43:10.783280 [info ] [MainThread]:   application_name: dbt
[0m17:43:10.784244 [info ] [MainThread]:   retries: 1
[0m17:43:10.785316 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:43:10.960233 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:43:11.075688 [debug] [MainThread]: Using postgres connection "debug"
[0m17:43:11.076746 [debug] [MainThread]: On debug: select 1 as id
[0m17:43:11.077443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:11.096234 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m17:43:11.097923 [debug] [MainThread]: On debug: Close
[0m17:43:11.098782 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:43:11.099549 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:43:11.101754 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.95996237, "process_in_blocks": "56", "process_kernel_time": 0.619872, "process_mem_max_rss": "124692", "process_out_blocks": "0", "process_user_time": 5.981368}
[0m17:43:11.102826 [debug] [MainThread]: Command `dbt debug` succeeded at 17:43:11.102603 after 0.96 seconds
[0m17:43:11.103538 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:43:11.104218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b72391f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b72bcc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b72d03620>]}
[0m17:43:11.104948 [debug] [MainThread]: Flushing usage events
[0m17:43:11.751885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:18.005022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f3ff5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f5072960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f3ff5700>]}


============================== 17:43:18.076972 | a56fd422-206a-4dcf-94ca-7f216a412488 ==============================
[0m17:43:18.076972 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:43:18.078153 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'empty': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m17:43:18.416024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f4333470>]}
[0m17:43:18.560613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f38a3a70>]}
[0m17:43:18.562533 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:43:18.741833 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:43:19.039488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:19.040805 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/gold_rocket_performance.sql
[0m17:43:19.595364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f25f5190>]}
[0m17:43:19.745346 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:43:19.753788 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:43:19.863467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f21125d0>]}
[0m17:43:19.864787 [info ] [MainThread]: Found 5 models, 4 data tests, 5 sources, 464 macros
[0m17:43:19.866592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f39cfad0>]}
[0m17:43:19.870031 [info ] [MainThread]: 
[0m17:43:19.871065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:19.872151 [info ] [MainThread]: 
[0m17:43:19.873396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:43:19.880590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m17:43:19.976707 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m17:43:19.977916 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m17:43:19.978571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:19.998100 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m17:43:20.001605 [debug] [ThreadPool]: On list_spacex_db: Close
[0m17:43:20.006694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m17:43:20.016072 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m17:43:20.017127 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:43:20.017779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:20.041323 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m17:43:20.043694 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m17:43:20.044575 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m17:43:20.052745 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:20.053826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:43:20.054671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:20.081283 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m17:43:20.083795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f2182300>]}
[0m17:43:20.084686 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:20.085605 [debug] [MainThread]: On master: COMMIT
[0m17:43:20.086324 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:20.087035 [debug] [MainThread]: On master: COMMIT
[0m17:43:20.088196 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:43:20.088911 [debug] [MainThread]: On master: Close
[0m17:43:20.097820 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m17:43:20.098620 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m17:43:20.099472 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m17:43:20.100643 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m17:43:20.101729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m17:43:20.102883 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m17:43:20.103779 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m17:43:20.104609 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m17:43:20.119257 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m17:43:20.119984 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m17:43:20.126252 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m17:43:20.132588 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m17:43:20.218062 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m17:43:20.218678 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m17:43:20.226395 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:43:20.227221 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)

SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal, -- Converte 98 para 0.98
    NOW() AS stg_updated_at
FROM source
  );
[0m17:43:20.228271 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:43:20.229228 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:20.230446 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    COALESCE(success, FALSE) AS is_success, -- Trata nulos como falha por padrão de negócio
    rocket AS rocket_id,
    NOW() AS stg_updated_at
FROM source
  );
[0m17:43:20.232013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:20.251846 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:43:20.252733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:43:20.272200 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:43:20.273168 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:43:20.273843 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m17:43:20.274852 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m17:43:20.277169 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.277835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:43:20.282083 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:43:20.286350 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:43:20.287308 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m17:43:20.288267 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m17:43:20.290215 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.290822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.330304 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:43:20.331016 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:43:20.332032 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:43:20.332965 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:43:20.333821 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:43:20.334724 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:43:20.339734 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m17:43:20.346925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m17:43:20.349866 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m17:43:20.353408 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m17:43:20.362832 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:43:20.363932 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:43:20.364905 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m17:43:20.365857 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m17:43:20.373273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:43:20.377857 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m17:43:20.378603 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m17:43:20.383434 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m17:43:20.384259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f67bdaf0>]}
[0m17:43:20.385223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f1181be0>]}
[0m17:43:20.386188 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m17:43:20.387615 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m17:43:20.388940 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m17:43:20.390269 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m17:43:20.392408 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m17:43:20.393537 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m17:43:20.394583 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m17:43:20.395366 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m17:43:20.400017 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m17:43:20.410168 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m17:43:20.443891 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m17:43:20.456283 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:43:20.457242 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets" -- Use REF, não SOURCE aqui
  );
  
[0m17:43:20.458043 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:43:20.484869 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.027 seconds
[0m17:43:20.495187 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:43:20.496090 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m17:43:20.497856 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.503737 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:43:20.504907 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m17:43:20.506634 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.509178 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:43:20.510059 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:43:20.510764 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:43:20.513716 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:43:20.519754 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m17:43:20.525519 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:43:20.526356 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m17:43:20.532927 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:43:20.535707 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m17:43:20.536986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f072ba10>]}
[0m17:43:20.538135 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.14s]
[0m17:43:20.539626 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m17:43:20.541295 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m17:43:20.542346 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m17:43:20.543304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m17:43:20.544136 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m17:43:20.635811 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m17:43:20.645818 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m17:43:20.651686 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m17:43:20.661885 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:43:20.662838 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m17:43:20.663673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:20.693041 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m17:43:20.698139 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:43:20.699219 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m17:43:20.701382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.707121 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:43:20.708117 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m17:43:20.710047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:43:20.712653 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:43:20.713557 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:43:20.714295 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:43:20.717320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:43:20.721926 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m17:43:20.723685 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:43:20.724530 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m17:43:20.731225 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:43:20.733922 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m17:43:20.735449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f2903e60>]}
[0m17:43:20.736827 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 0[0m in 0.19s]
[0m17:43:20.738268 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m17:43:20.740138 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m17:43:20.741275 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m17:43:20.742378 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m17:43:20.743216 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m17:43:20.748679 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m17:43:20.758022 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m17:43:20.764044 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m17:43:20.773956 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m17:43:20.774940 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    WITH rockets AS (
    SELECT 
        rocket_id,
        -- Ajuste: Use o nome real da coluna que está na dim_rockets
        -- Se você usou o SCHEMA_REGISTRY padrão, deve ser 'name'
        name AS rocket_name 
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id, -- Garantindo o nome para o JOIN
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
-- Agora as colunas coincidem com as tabelas acima
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches
FROM "spacex_db"."analytics"."dim_rockets" r
LEFT JOIN "spacex_db"."analytics"."fct_launches" l ON r.rocket_id = l.rocket_id
GROUP BY 1, 2
  );
[0m17:43:20.775800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:20.791362 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name 
                 ^

[0m17:43:20.792467 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m17:43:20.793535 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m17:43:20.800411 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:43:20.801635 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a56fd422-206a-4dcf-94ca-7f216a412488', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f0764e90>]}
[0m17:43:20.802752 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m17:43:20.803902 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m17:43:20.804967 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m17:43:20.808702 [debug] [MainThread]: On master: COMMIT
[0m17:43:20.809493 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:20.810115 [debug] [MainThread]: On master: COMMIT
[0m17:43:20.810765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:20.825723 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m17:43:20.826782 [debug] [MainThread]: On master: Close
[0m17:43:20.827898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:20.830704 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m17:43:20.831534 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m17:43:20.832202 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m17:43:20.832869 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m17:43:20.833656 [info ] [MainThread]: 
[0m17:43:20.834406 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m17:43:20.836734 [debug] [MainThread]: Command end result
[0m17:43:20.887960 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:43:20.895225 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:43:20.911432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:43:20.912212 [info ] [MainThread]: 
[0m17:43:20.913000 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:43:20.913722 [info ] [MainThread]: 
[0m17:43:20.914675 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m17:43:20.915720 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:43:20.916475 [info ] [MainThread]: 
[0m17:43:20.917329 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:43:20.918148 [info ] [MainThread]: 
[0m17:43:20.918919 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:43:20.921274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.044405, "process_in_blocks": "80", "process_kernel_time": 0.682299, "process_mem_max_rss": "138380", "process_out_blocks": "0", "process_user_time": 7.529233}
[0m17:43:20.922232 [debug] [MainThread]: Command `dbt run` failed at 17:43:20.922079 after 3.05 seconds
[0m17:43:20.923036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f40030b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f3ae38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255f3ae3830>]}
[0m17:43:20.923826 [debug] [MainThread]: Flushing usage events
[0m17:43:21.562916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:26.765034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af773b5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af775379e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af777401a0>]}


============================== 17:57:26.854027 | e098991d-d7ac-4f02-bc87-ed235df36c06 ==============================
[0m17:57:26.854027 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:57:26.855132 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'no_print': 'None', 'empty': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default'}
[0m17:57:27.105291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e098991d-d7ac-4f02-bc87-ed235df36c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af7749e570>]}
[0m17:57:27.177047 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:57:27.185244 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:57:27.187879 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5657709, "process_in_blocks": "1384", "process_kernel_time": 0.589085, "process_mem_max_rss": "124684", "process_out_blocks": "0", "process_user_time": 5.479304}
[0m17:57:27.188707 [debug] [MainThread]: Command `dbt deps` succeeded at 17:57:27.188561 after 0.57 seconds
[0m17:57:27.189456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af7738fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af77d27e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79af7712fa70>]}
[0m17:57:27.190233 [debug] [MainThread]: Flushing usage events
[0m17:57:27.841973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:33.704444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743eb919460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743eb757740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743ead69400>]}


============================== 17:57:33.768936 | e70de31d-0715-440d-bc08-bb26833f3838 ==============================
[0m17:57:33.768936 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:57:33.769983 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'None'}
[0m17:57:33.821256 [info ] [MainThread]: dbt version: 1.11.6
[0m17:57:33.822170 [info ] [MainThread]: python version: 3.12.12
[0m17:57:33.822895 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:57:33.823645 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m17:57:33.929977 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m17:57:33.930966 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m17:57:33.931735 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m17:57:33.932861 [info ] [MainThread]: adapter type: postgres
[0m17:57:33.933684 [info ] [MainThread]: adapter version: 1.10.0
[0m17:57:34.129014 [info ] [MainThread]: Configuration:
[0m17:57:34.130038 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:34.131003 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:34.131801 [info ] [MainThread]: Required dependencies:
[0m17:57:34.132603 [debug] [MainThread]: Executing "git --help"
[0m17:57:34.136447 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:57:34.137512 [debug] [MainThread]: STDERR: "b''"
[0m17:57:34.138219 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:57:34.138944 [info ] [MainThread]: Connection:
[0m17:57:34.139658 [info ] [MainThread]:   host: db
[0m17:57:34.140335 [info ] [MainThread]:   port: 5432
[0m17:57:34.141008 [info ] [MainThread]:   user: postgres
[0m17:57:34.141797 [info ] [MainThread]:   database: spacex_db
[0m17:57:34.142465 [info ] [MainThread]:   schema: analytics
[0m17:57:34.143118 [info ] [MainThread]:   connect_timeout: 10
[0m17:57:34.143872 [info ] [MainThread]:   role: None
[0m17:57:34.144566 [info ] [MainThread]:   search_path: None
[0m17:57:34.145241 [info ] [MainThread]:   keepalives_idle: 0
[0m17:57:34.145873 [info ] [MainThread]:   sslmode: None
[0m17:57:34.146499 [info ] [MainThread]:   sslcert: None
[0m17:57:34.147128 [info ] [MainThread]:   sslkey: None
[0m17:57:34.147756 [info ] [MainThread]:   sslrootcert: None
[0m17:57:34.148381 [info ] [MainThread]:   application_name: dbt
[0m17:57:34.149015 [info ] [MainThread]:   retries: 1
[0m17:57:34.149907 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:57:34.328787 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:57:34.413072 [debug] [MainThread]: Using postgres connection "debug"
[0m17:57:34.413920 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:34.414494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:34.431445 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m17:57:34.433316 [debug] [MainThread]: On debug: Close
[0m17:57:34.434073 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:57:34.434788 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:57:34.436884 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8816594, "process_in_blocks": "56", "process_kernel_time": 0.629131, "process_mem_max_rss": "124944", "process_out_blocks": "0", "process_user_time": 5.46182}
[0m17:57:34.437924 [debug] [MainThread]: Command `dbt debug` succeeded at 17:57:34.437759 after 0.88 seconds
[0m17:57:34.438586 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:34.439226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743eab715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743eaeb09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7743ea4e51c0>]}
[0m17:57:34.439924 [debug] [MainThread]: Flushing usage events
[0m17:57:35.063367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:42.014680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86efc4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86ecd6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86ecd66f0>]}


============================== 17:57:42.085243 | 708bfc1e-21ef-4bba-807e-655f1464b43c ==============================
[0m17:57:42.085243 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:57:42.086420 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m17:57:42.582351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86fbd2ba0>]}
[0m17:57:42.728608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce87058bfb0>]}
[0m17:57:42.730261 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:57:42.977348 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:57:43.368444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:43.369864 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:57:43.370661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:43.451836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86e7623c0>]}
[0m17:57:43.616178 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:57:43.627816 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:57:43.772836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86d97b3b0>]}
[0m17:57:43.774038 [info ] [MainThread]: Found 5 models, 4 data tests, 5 sources, 464 macros
[0m17:57:43.774948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86d989100>]}
[0m17:57:43.778421 [info ] [MainThread]: 
[0m17:57:43.779484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:43.780294 [info ] [MainThread]: 
[0m17:57:43.781468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:57:43.794619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m17:57:43.899962 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m17:57:43.900902 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m17:57:43.901563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:43.923500 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m17:57:43.926013 [debug] [ThreadPool]: On list_spacex_db: Close
[0m17:57:43.929196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m17:57:43.940686 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m17:57:43.941752 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m17:57:43.942745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:43.969865 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m17:57:43.972330 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m17:57:43.973567 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m17:57:43.981590 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:43.984073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:57:43.985484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:44.012417 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m17:57:44.014826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86cd01610>]}
[0m17:57:44.015726 [debug] [MainThread]: On master: ROLLBACK
[0m17:57:44.016624 [debug] [MainThread]: On master: COMMIT
[0m17:57:44.017346 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:44.017951 [debug] [MainThread]: On master: COMMIT
[0m17:57:44.018931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:57:44.020033 [debug] [MainThread]: On master: Close
[0m17:57:44.029897 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m17:57:44.030672 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m17:57:44.031488 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m17:57:44.032425 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m17:57:44.033332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m17:57:44.034270 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m17:57:44.035065 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m17:57:44.035817 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m17:57:44.047465 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m17:57:44.051378 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m17:57:44.058594 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m17:57:44.072217 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m17:57:44.150899 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m17:57:44.151904 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m17:57:44.177487 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:57:44.178754 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)

SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal, -- Converte 98 para 0.98
    NOW() AS stg_updated_at
FROM source
  );
[0m17:57:44.179712 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:57:44.182236 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:57:44.183660 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    COALESCE(success, FALSE) AS is_success, -- Trata nulos como falha por padrão de negócio
    rocket AS rocket_id,
    NOW() AS stg_updated_at
FROM source
  );
[0m17:57:44.185325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:44.207570 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m17:57:44.216809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m17:57:44.220969 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:57:44.225880 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:57:44.226961 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m17:57:44.227961 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m17:57:44.230323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.237456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:57:44.238676 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:57:44.243414 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:57:44.244468 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m17:57:44.245451 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m17:57:44.247526 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.249349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.306005 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:57:44.311388 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:57:44.338632 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:57:44.348348 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:57:44.350863 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m17:57:44.353662 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m17:57:44.360241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:57:44.368135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m17:57:44.387188 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m17:57:44.388946 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m17:57:44.407211 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m17:57:44.403497 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m17:57:44.408228 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m17:57:44.409135 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m17:57:44.417486 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:57:44.422066 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m17:57:44.423188 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m17:57:44.426009 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m17:57:44.430588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce871781d30>]}
[0m17:57:44.431600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86c9a6ae0>]}
[0m17:57:44.435242 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.40s]
[0m17:57:44.439948 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m17:57:44.438033 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.39s]
[0m17:57:44.442036 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m17:57:44.443118 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m17:57:44.444399 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m17:57:44.446119 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m17:57:44.446948 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m17:57:44.451921 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m17:57:44.467535 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m17:57:44.502744 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m17:57:44.511825 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:57:44.512707 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets" -- Use REF, não SOURCE aqui
  );
  
[0m17:57:44.513494 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:57:44.541343 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.028 seconds
[0m17:57:44.552995 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:57:44.554607 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m17:57:44.558013 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.562833 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:57:44.563771 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m17:57:44.565499 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.568346 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:57:44.569330 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:57:44.570515 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m17:57:44.576552 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m17:57:44.583250 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m17:57:44.593494 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m17:57:44.594565 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m17:57:44.601332 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:57:44.603924 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m17:57:44.606169 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86c982390>]}
[0m17:57:44.609598 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.16s]
[0m17:57:44.611008 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m17:57:44.613007 [debug] [Thread-2 (]: Began running node model.spacex_analytics.fct_launches
[0m17:57:44.614528 [info ] [Thread-2 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m17:57:44.616035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_rockets, now model.spacex_analytics.fct_launches)
[0m17:57:44.616951 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.fct_launches
[0m17:57:44.624391 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m17:57:44.636336 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.fct_launches
[0m17:57:44.642328 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m17:57:44.655904 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:57:44.657134 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m17:57:44.658084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:44.694970 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.037 seconds
[0m17:57:44.701905 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:57:44.702941 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m17:57:44.705130 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.712490 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:57:44.713987 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m17:57:44.716392 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:57:44.719147 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:57:44.720318 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:57:44.723103 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m17:57:44.726592 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:57:44.733620 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m17:57:44.735447 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m17:57:44.736630 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m17:57:44.745308 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:57:44.748045 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: Close
[0m17:57:44.749503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86c521760>]}
[0m17:57:44.750862 [info ] [Thread-2 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 0[0m in 0.13s]
[0m17:57:44.752310 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.fct_launches
[0m17:57:44.754649 [debug] [Thread-1 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m17:57:44.755790 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m17:57:44.757397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.gold_rocket_performance)
[0m17:57:44.758557 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m17:57:44.764529 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m17:57:44.779797 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m17:57:44.786182 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m17:57:44.798642 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m17:57:44.800422 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    WITH rockets AS (
    SELECT 
        rocket_id,
        -- Ajuste: Use o nome real da coluna que está na dim_rockets
        -- Se você usou o SCHEMA_REGISTRY padrão, deve ser 'name'
        name AS rocket_name 
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id, -- Garantindo o nome para o JOIN
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
-- Agora as colunas coincidem com as tabelas acima
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches
FROM "spacex_db"."analytics"."dim_rockets" r
LEFT JOIN "spacex_db"."analytics"."fct_launches" l ON r.rocket_id = l.rocket_id
GROUP BY 1, 2
  );
[0m17:57:44.801493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:44.816887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name 
                 ^

[0m17:57:44.818087 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m17:57:44.819583 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m17:57:44.826807 [debug] [Thread-1 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:57:44.828035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708bfc1e-21ef-4bba-807e-655f1464b43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86c55ce60>]}
[0m17:57:44.829331 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.07s]
[0m17:57:44.830638 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m17:57:44.831770 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m17:57:44.835820 [debug] [MainThread]: On master: COMMIT
[0m17:57:44.836761 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:44.837512 [debug] [MainThread]: On master: COMMIT
[0m17:57:44.838300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:44.852713 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m17:57:44.853798 [debug] [MainThread]: On master: Close
[0m17:57:44.855120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:44.856126 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m17:57:44.856957 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m17:57:44.857645 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m17:57:44.858662 [info ] [MainThread]: 
[0m17:57:44.859506 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m17:57:44.861921 [debug] [MainThread]: Command end result
[0m17:57:44.914352 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m17:57:44.922149 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m17:57:44.941210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m17:57:44.942060 [info ] [MainThread]: 
[0m17:57:44.942896 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:57:44.943668 [info ] [MainThread]: 
[0m17:57:44.944489 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m17:57:44.945336 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:57:44.946034 [info ] [MainThread]: 
[0m17:57:44.946812 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m17:57:44.947478 [info ] [MainThread]: 
[0m17:57:44.948213 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:57:44.950343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.071849, "process_in_blocks": "80", "process_kernel_time": 0.821444, "process_mem_max_rss": "133956", "process_out_blocks": "0", "process_user_time": 7.969242}
[0m17:57:44.951217 [debug] [MainThread]: Command `dbt run` failed at 17:57:44.951065 after 3.07 seconds
[0m17:57:44.951960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86f2f8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86e8d4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce86f9a5fd0>]}
[0m17:57:44.952743 [debug] [MainThread]: Flushing usage events
[0m17:57:45.562064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:32.562103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70955e8a0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70955e8a07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70955e8a0a70>]}


============================== 18:15:32.632318 | 66469a15-9e68-42bb-9de7-e6a74f652106 ==============================
[0m18:15:32.632318 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:15:32.633406 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '/app/dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True'}
[0m18:15:32.861371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66469a15-9e68-42bb-9de7-e6a74f652106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7095613ac950>]}
[0m18:15:32.929612 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:15:32.936210 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:15:32.938693 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49859193, "process_in_blocks": "1384", "process_kernel_time": 0.47273, "process_mem_max_rss": "124608", "process_out_blocks": "0", "process_user_time": 5.005384}
[0m18:15:32.939522 [debug] [MainThread]: Command `dbt deps` succeeded at 18:15:32.939371 after 0.50 seconds
[0m18:15:32.940202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709562f5ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70955e4c43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70955e497980>]}
[0m18:15:32.940867 [debug] [MainThread]: Flushing usage events
[0m18:15:33.587163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:39.348400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db19112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db3ecfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db1e443e0>]}


============================== 18:15:39.422188 | f867399f-19c7-4396-baec-f077bc5f0810 ==============================
[0m18:15:39.422188 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:15:39.423546 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'empty': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m18:15:39.483102 [info ] [MainThread]: dbt version: 1.11.6
[0m18:15:39.484011 [info ] [MainThread]: python version: 3.12.12
[0m18:15:39.484762 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:15:39.485565 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:15:39.600527 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m18:15:39.601646 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m18:15:39.602679 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m18:15:39.603868 [info ] [MainThread]: adapter type: postgres
[0m18:15:39.604642 [info ] [MainThread]: adapter version: 1.10.0
[0m18:15:39.833167 [info ] [MainThread]: Configuration:
[0m18:15:39.834359 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:15:39.835246 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:15:39.836077 [info ] [MainThread]: Required dependencies:
[0m18:15:39.836948 [debug] [MainThread]: Executing "git --help"
[0m18:15:39.840825 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:15:39.841985 [debug] [MainThread]: STDERR: "b''"
[0m18:15:39.842898 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:15:39.843843 [info ] [MainThread]: Connection:
[0m18:15:39.844662 [info ] [MainThread]:   host: db
[0m18:15:39.845482 [info ] [MainThread]:   port: 5432
[0m18:15:39.846209 [info ] [MainThread]:   user: postgres
[0m18:15:39.846945 [info ] [MainThread]:   database: spacex_db
[0m18:15:39.847603 [info ] [MainThread]:   schema: analytics
[0m18:15:39.848336 [info ] [MainThread]:   connect_timeout: 10
[0m18:15:39.849129 [info ] [MainThread]:   role: None
[0m18:15:39.850024 [info ] [MainThread]:   search_path: None
[0m18:15:39.850804 [info ] [MainThread]:   keepalives_idle: 0
[0m18:15:39.851529 [info ] [MainThread]:   sslmode: None
[0m18:15:39.852239 [info ] [MainThread]:   sslcert: None
[0m18:15:39.852941 [info ] [MainThread]:   sslkey: None
[0m18:15:39.853686 [info ] [MainThread]:   sslrootcert: None
[0m18:15:39.854490 [info ] [MainThread]:   application_name: dbt
[0m18:15:39.855354 [info ] [MainThread]:   retries: 1
[0m18:15:39.856331 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:15:40.040006 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:15:40.126150 [debug] [MainThread]: Using postgres connection "debug"
[0m18:15:40.127201 [debug] [MainThread]: On debug: select 1 as id
[0m18:15:40.127991 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:40.146129 [debug] [MainThread]: SQL status: SELECT 1 in 0.018 seconds
[0m18:15:40.148111 [debug] [MainThread]: On debug: Close
[0m18:15:40.149042 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:15:40.152157 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:15:40.154629 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9394999, "process_in_blocks": "56", "process_kernel_time": 0.54561, "process_mem_max_rss": "124308", "process_out_blocks": "0", "process_user_time": 5.504242}
[0m18:15:40.155610 [debug] [MainThread]: Command `dbt debug` succeeded at 18:15:40.155440 after 0.94 seconds
[0m18:15:40.156276 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:15:40.156964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db1692e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db0a4c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760db1225e80>]}
[0m18:15:40.157878 [debug] [MainThread]: Flushing usage events
[0m18:15:40.818475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:46.628746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a7a1a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4f771a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4b29ee0>]}


============================== 18:15:46.696600 | 2de72560-e668-474f-9aaa-c043dff36ca4 ==============================
[0m18:15:46.696600 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:15:46.697730 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m18:15:47.057994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a72cc800>]}
[0m18:15:47.183824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4fee030>]}
[0m18:15:47.185738 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:15:47.353494 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:15:47.635374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:47.636419 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:15:47.637325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:47.704961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a42964e0>]}
[0m18:15:47.861006 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:15:47.867904 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:15:47.956346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a315fb00>]}
[0m18:15:47.957213 [info ] [MainThread]: Found 5 models, 4 data tests, 5 sources, 464 macros
[0m18:15:47.957961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4b32fc0>]}
[0m18:15:47.960800 [info ] [MainThread]: 
[0m18:15:47.961660 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:47.962418 [info ] [MainThread]: 
[0m18:15:47.963620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:47.969599 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m18:15:48.053788 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m18:15:48.054774 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m18:15:48.055619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:48.074756 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m18:15:48.077021 [debug] [ThreadPool]: On list_spacex_db: Close
[0m18:15:48.079847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m18:15:48.090315 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m18:15:48.091330 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:15:48.092111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:48.119507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m18:15:48.122012 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m18:15:48.123196 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m18:15:48.131044 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:48.131957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:15:48.132846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:48.157944 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m18:15:48.160198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a29c50a0>]}
[0m18:15:48.161174 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:48.162244 [debug] [MainThread]: On master: COMMIT
[0m18:15:48.163023 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:48.163797 [debug] [MainThread]: On master: COMMIT
[0m18:15:48.165025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:48.165888 [debug] [MainThread]: On master: Close
[0m18:15:48.174206 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m18:15:48.174973 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m18:15:48.175797 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m18:15:48.176811 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m18:15:48.177883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m18:15:48.178924 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m18:15:48.179746 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m18:15:48.180550 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m18:15:48.191518 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m18:15:48.195107 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m18:15:48.202364 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m18:15:48.208626 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m18:15:48.283030 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m18:15:48.287162 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m18:15:48.294700 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:15:48.295674 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)

SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal, -- Converte 98 para 0.98
    NOW() AS stg_updated_at
FROM source
  );
[0m18:15:48.296381 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:15:48.296947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:15:48.297889 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    COALESCE(success, FALSE) AS is_success, -- Trata nulos como falha por padrão de negócio
    rocket AS rocket_id,
    NOW() AS stg_updated_at
FROM source
  );
[0m18:15:48.299244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:48.325291 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m18:15:48.326113 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m18:15:48.336062 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:15:48.340228 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:15:48.341334 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m18:15:48.342409 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m18:15:48.345495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.346267 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:15:48.352918 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:15:48.356896 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:15:48.358025 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m18:15:48.359446 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m18:15:48.362058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.364262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.403557 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:15:48.404483 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:15:48.405069 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:15:48.406181 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:15:48.407098 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:15:48.408015 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:15:48.411330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:15:48.417785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m18:15:48.421834 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m18:15:48.425368 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m18:15:48.435962 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:15:48.437247 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:15:48.438330 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m18:15:48.439304 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m18:15:48.450682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m18:15:48.451445 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m18:15:48.455593 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m18:15:48.458579 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m18:15:48.462678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a2117b60>]}
[0m18:15:48.463395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a21a4890>]}
[0m18:15:48.465923 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m18:15:48.467502 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m18:15:48.468982 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m18:15:48.470692 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m18:15:48.473427 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m18:15:48.474623 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m18:15:48.475804 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m18:15:48.476658 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m18:15:48.481840 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m18:15:48.491571 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m18:15:48.530714 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m18:15:48.540126 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:15:48.540921 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets" -- Use REF, não SOURCE aqui
  );
  
[0m18:15:48.541710 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:15:48.565883 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.024 seconds
[0m18:15:48.575119 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:15:48.575925 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m18:15:48.577828 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.582740 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:15:48.583661 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m18:15:48.585268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.587563 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:15:48.588349 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:15:48.589104 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:15:48.591758 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:15:48.595647 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m18:15:48.600445 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:15:48.601250 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m18:15:48.607790 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m18:15:48.610138 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m18:15:48.611199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a2105d30>]}
[0m18:15:48.612318 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.14s]
[0m18:15:48.613463 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m18:15:48.614909 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m18:15:48.616113 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m18:15:48.617010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m18:15:48.617765 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m18:15:48.624358 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m18:15:48.634512 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m18:15:48.639670 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m18:15:48.650170 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:15:48.650974 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m18:15:48.651710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:48.680310 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.028 seconds
[0m18:15:48.685160 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:15:48.686030 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m18:15:48.687872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.693380 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:15:48.694396 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m18:15:48.696089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:15:48.698354 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:15:48.699178 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:15:48.699912 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:15:48.702597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:15:48.706118 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m18:15:48.707348 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:15:48.708143 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m18:15:48.714259 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:15:48.716397 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m18:15:48.717483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a1d15130>]}
[0m18:15:48.721226 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m18:15:48.722588 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m18:15:48.724223 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m18:15:48.725243 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m18:15:48.726320 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m18:15:48.727107 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m18:15:48.732231 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m18:15:48.742796 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m18:15:48.747991 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m18:15:48.757527 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m18:15:48.758379 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    WITH rockets AS (
    SELECT 
        rocket_id,
        -- Ajuste: Use o nome real da coluna que está na dim_rockets
        -- Se você usou o SCHEMA_REGISTRY padrão, deve ser 'name'
        name AS rocket_name 
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id, -- Garantindo o nome para o JOIN
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
-- Agora as colunas coincidem com as tabelas acima
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches
FROM "spacex_db"."analytics"."dim_rockets" r
LEFT JOIN "spacex_db"."analytics"."fct_launches" l ON r.rocket_id = l.rocket_id
GROUP BY 1, 2
  );
[0m18:15:48.759157 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:15:48.773778 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name 
                 ^

[0m18:15:48.775022 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m18:15:48.776320 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m18:15:48.782505 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:15:48.784208 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2de72560-e668-474f-9aaa-c043dff36ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a41d3fe0>]}
[0m18:15:48.785612 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m18:15:48.786894 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m18:15:48.788048 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m18:15:48.792014 [debug] [MainThread]: On master: COMMIT
[0m18:15:48.792797 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:48.793471 [debug] [MainThread]: On master: COMMIT
[0m18:15:48.794181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:48.808159 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m18:15:48.809133 [debug] [MainThread]: On master: Close
[0m18:15:48.810162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:48.810898 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m18:15:48.811550 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m18:15:48.812176 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m18:15:48.812821 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m18:15:48.813840 [info ] [MainThread]: 
[0m18:15:48.814609 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m18:15:48.816857 [debug] [MainThread]: Command end result
[0m18:15:48.867519 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:15:48.874519 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:15:48.887422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:15:48.888136 [info ] [MainThread]: 
[0m18:15:48.888888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:15:48.889591 [info ] [MainThread]: 
[0m18:15:48.890419 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m18:15:48.891206 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name 
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:15:48.891896 [info ] [MainThread]: 
[0m18:15:48.893161 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:15:48.894362 [info ] [MainThread]: 
[0m18:15:48.895267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:15:48.897883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.396141, "process_in_blocks": "80", "process_kernel_time": 0.685637, "process_mem_max_rss": "134172", "process_out_blocks": "0", "process_user_time": 6.467445}
[0m18:15:48.898873 [debug] [MainThread]: Command `dbt run` failed at 18:15:48.898714 after 2.40 seconds
[0m18:15:48.899666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a46177d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4b32fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7287a4f93a70>]}
[0m18:15:48.900413 [debug] [MainThread]: Flushing usage events
[0m18:15:49.608932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:42.274420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b56eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b453230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b06f860>]}


============================== 18:34:42.344289 | e884c3cc-d231-49aa-86c4-34420950ced0 ==============================
[0m18:34:42.344289 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:34:42.345453 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/app/dbt', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'empty': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m18:34:42.593375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e884c3cc-d231-49aa-86c4-34420950ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b39c470>]}
[0m18:34:42.664799 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:42.673034 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:42.675851 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52802557, "process_in_blocks": "1384", "process_kernel_time": 0.531423, "process_mem_max_rss": "124860", "process_out_blocks": "0", "process_user_time": 5.118447}
[0m18:34:42.676790 [debug] [MainThread]: Command `dbt deps` succeeded at 18:34:42.676639 after 0.53 seconds
[0m18:34:42.677484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b39c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b3a05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e174b3a0e30>]}
[0m18:34:42.678160 [debug] [MainThread]: Flushing usage events
[0m18:34:43.464126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:49.496651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735443267bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735442a32360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735444f3a540>]}


============================== 18:34:49.569635 | e102e3e7-475b-4b3d-a53f-b4571e5c1318 ==============================
[0m18:34:49.569635 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:34:49.570830 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None'}
[0m18:34:49.625964 [info ] [MainThread]: dbt version: 1.11.6
[0m18:34:49.626852 [info ] [MainThread]: python version: 3.12.12
[0m18:34:49.627584 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:34:49.628287 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:34:49.743084 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m18:34:49.744249 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m18:34:49.745107 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m18:34:49.746333 [info ] [MainThread]: adapter type: postgres
[0m18:34:49.747091 [info ] [MainThread]: adapter version: 1.10.0
[0m18:34:49.972605 [info ] [MainThread]: Configuration:
[0m18:34:49.973701 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:34:49.974568 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:34:49.975332 [info ] [MainThread]: Required dependencies:
[0m18:34:49.976097 [debug] [MainThread]: Executing "git --help"
[0m18:34:49.979522 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:34:49.980853 [debug] [MainThread]: STDERR: "b''"
[0m18:34:49.981694 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:34:49.982462 [info ] [MainThread]: Connection:
[0m18:34:49.983199 [info ] [MainThread]:   host: db
[0m18:34:49.983928 [info ] [MainThread]:   port: 5432
[0m18:34:49.984568 [info ] [MainThread]:   user: postgres
[0m18:34:49.985232 [info ] [MainThread]:   database: spacex_db
[0m18:34:49.985900 [info ] [MainThread]:   schema: analytics
[0m18:34:49.986546 [info ] [MainThread]:   connect_timeout: 10
[0m18:34:49.987194 [info ] [MainThread]:   role: None
[0m18:34:49.987871 [info ] [MainThread]:   search_path: None
[0m18:34:49.988511 [info ] [MainThread]:   keepalives_idle: 0
[0m18:34:49.989135 [info ] [MainThread]:   sslmode: None
[0m18:34:49.989766 [info ] [MainThread]:   sslcert: None
[0m18:34:49.990390 [info ] [MainThread]:   sslkey: None
[0m18:34:49.991002 [info ] [MainThread]:   sslrootcert: None
[0m18:34:49.991645 [info ] [MainThread]:   application_name: dbt
[0m18:34:49.992277 [info ] [MainThread]:   retries: 1
[0m18:34:49.993128 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:34:50.152875 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:34:50.238229 [debug] [MainThread]: Using postgres connection "debug"
[0m18:34:50.239977 [debug] [MainThread]: On debug: select 1 as id
[0m18:34:50.240917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:50.260709 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m18:34:50.262714 [debug] [MainThread]: On debug: Close
[0m18:34:50.263981 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:34:50.265997 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:34:50.268734 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9003962, "process_in_blocks": "56", "process_kernel_time": 0.623685, "process_mem_max_rss": "124688", "process_out_blocks": "0", "process_user_time": 5.641153}
[0m18:34:50.269727 [debug] [MainThread]: Command `dbt debug` succeeded at 18:34:50.269554 after 0.90 seconds
[0m18:34:50.270482 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:34:50.271505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735442a77f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7354422e5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735441e97f80>]}
[0m18:34:50.272690 [debug] [MainThread]: Flushing usage events
[0m18:34:50.918817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:57.032657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480bb7c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480c34b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480c348500>]}


============================== 18:34:57.105649 | 690909b7-4788-48d9-87ff-735aafeade6b ==============================
[0m18:34:57.105649 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:34:57.106815 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default'}
[0m18:34:57.461069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480bce4500>]}
[0m18:34:57.585337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480b11ea20>]}
[0m18:34:57.586919 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:34:57.756196 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:34:58.053898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:58.055180 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/gold_rocket_performance.sql
[0m18:34:58.571000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480c345be0>]}
[0m18:34:58.727835 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:34:58.734691 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:34:58.834307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724809512e10>]}
[0m18:34:58.835307 [info ] [MainThread]: Found 5 models, 4 data tests, 5 sources, 464 macros
[0m18:34:58.836072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480b053fe0>]}
[0m18:34:58.838951 [info ] [MainThread]: 
[0m18:34:58.839730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:34:58.840516 [info ] [MainThread]: 
[0m18:34:58.841448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:58.847212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m18:34:58.929121 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m18:34:58.930192 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m18:34:58.930965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:58.951462 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m18:34:58.953705 [debug] [ThreadPool]: On list_spacex_db: Close
[0m18:34:58.956675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m18:34:58.964883 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m18:34:58.965770 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:34:58.966643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:58.993579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m18:34:58.995872 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m18:34:58.996806 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m18:34:59.004653 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:59.005772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:34:59.006689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:59.033242 [debug] [MainThread]: SQL status: SELECT 4 in 0.026 seconds
[0m18:34:59.035574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724809df2c30>]}
[0m18:34:59.036480 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:59.037536 [debug] [MainThread]: On master: COMMIT
[0m18:34:59.038391 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:59.039145 [debug] [MainThread]: On master: COMMIT
[0m18:34:59.040381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:59.041085 [debug] [MainThread]: On master: Close
[0m18:34:59.048870 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m18:34:59.049618 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m18:34:59.050442 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m18:34:59.051583 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m18:34:59.052523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m18:34:59.053569 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m18:34:59.054431 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m18:34:59.055375 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m18:34:59.070576 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m18:34:59.071416 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m18:34:59.079245 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m18:34:59.080393 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m18:34:59.171982 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m18:34:59.172812 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m18:34:59.181204 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:34:59.182129 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    COALESCE(success, FALSE) AS is_success, -- Trata nulos como falha por padrão de negócio
    rocket AS rocket_id,
    NOW() AS stg_updated_at
FROM source
  );
[0m18:34:59.182825 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:34:59.183460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:59.184324 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)

SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal, -- Converte 98 para 0.98
    NOW() AS stg_updated_at
FROM source
  );
[0m18:34:59.185581 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:59.213016 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m18:34:59.213713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m18:34:59.223120 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:34:59.229845 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:34:59.230503 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m18:34:59.231452 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m18:34:59.234275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.234842 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:34:59.238930 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:34:59.242939 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:34:59.243927 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m18:34:59.245134 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m18:34:59.247497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.254426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m18:34:59.287724 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:34:59.288253 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:34:59.288903 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:34:59.289945 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:34:59.290895 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:34:59.291956 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:34:59.295229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:59.301666 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m18:34:59.305059 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m18:34:59.308455 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m18:34:59.319512 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:34:59.320575 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:34:59.321584 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m18:34:59.322505 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m18:34:59.332707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m18:34:59.333661 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m18:34:59.336980 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m18:34:59.339036 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m18:34:59.343002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480def6060>]}
[0m18:34:59.344149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480819c4d0>]}
[0m18:34:59.345350 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.29s]
[0m18:34:59.346768 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m18:34:59.348162 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m18:34:59.349227 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m18:34:59.351481 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m18:34:59.352787 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m18:34:59.353825 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m18:34:59.354559 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m18:34:59.359434 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m18:34:59.369650 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m18:34:59.400933 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m18:34:59.412367 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:34:59.413206 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets" -- Use REF, não SOURCE aqui
  );
  
[0m18:34:59.413939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:59.439427 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.025 seconds
[0m18:34:59.449474 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:34:59.450464 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m18:34:59.452342 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.457298 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:34:59.458203 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m18:34:59.459880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.462556 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:34:59.463843 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:34:59.464737 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:34:59.467710 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:59.473661 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m18:34:59.479860 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:34:59.480815 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m18:34:59.487727 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m18:34:59.490015 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m18:34:59.491076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480034b8f0>]}
[0m18:34:59.492262 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.14s]
[0m18:34:59.493648 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m18:34:59.495846 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m18:34:59.496972 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m18:34:59.497877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m18:34:59.498627 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m18:34:59.582622 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m18:34:59.593580 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m18:34:59.598551 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m18:34:59.609721 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:34:59.610589 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m18:34:59.611337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:59.638863 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.027 seconds
[0m18:34:59.643804 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:34:59.644752 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m18:34:59.646361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.650537 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:34:59.651427 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m18:34:59.653001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:59.655162 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:34:59.656023 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:34:59.656834 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:34:59.659362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:59.662813 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m18:34:59.664123 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:34:59.664976 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m18:34:59.671331 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m18:34:59.673643 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m18:34:59.674802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480034b0b0>]}
[0m18:34:59.678321 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.18s]
[0m18:34:59.679721 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m18:34:59.681411 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m18:34:59.682498 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m18:34:59.683651 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m18:34:59.684540 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m18:34:59.689427 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m18:34:59.697401 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m18:34:59.702322 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m18:34:59.712658 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m18:34:59.713523 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    -- models/marts/gold_rocket_performance.sql

WITH rockets AS (
    SELECT 
        rocket_id,
        name AS rocket_name
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id,
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    ROUND(
        AVG(CASE WHEN l.success = TRUE THEN 1.0 ELSE 0.0 END)::numeric * 100, 
        2
    ) AS success_rate_pct
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
  );
[0m18:34:59.714274 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:34:59.728431 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name
                 ^

[0m18:34:59.729458 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m18:34:59.730857 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m18:34:59.736420 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:34:59.737482 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690909b7-4788-48d9-87ff-735aafeade6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480afcdd90>]}
[0m18:34:59.738595 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.05s]
[0m18:34:59.740102 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m18:34:59.741259 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m18:34:59.745199 [debug] [MainThread]: On master: COMMIT
[0m18:34:59.745946 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:59.746639 [debug] [MainThread]: On master: COMMIT
[0m18:34:59.747368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:59.762525 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m18:34:59.763552 [debug] [MainThread]: On master: Close
[0m18:34:59.764579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:59.765501 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m18:34:59.766336 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m18:34:59.767063 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m18:34:59.767839 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m18:34:59.768711 [info ] [MainThread]: 
[0m18:34:59.769530 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:34:59.771975 [debug] [MainThread]: Command end result
[0m18:34:59.829140 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:34:59.837472 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:34:59.850911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:34:59.851975 [info ] [MainThread]: 
[0m18:34:59.852890 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:34:59.853658 [info ] [MainThread]: 
[0m18:34:59.854640 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m18:34:59.855615 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:34:59.856359 [info ] [MainThread]: 
[0m18:34:59.857283 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:34:59.858094 [info ] [MainThread]: 
[0m18:34:59.858996 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:34:59.861407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.957514, "process_in_blocks": "80", "process_kernel_time": 0.796187, "process_mem_max_rss": "137804", "process_out_blocks": "0", "process_user_time": 7.185595}
[0m18:34:59.862374 [debug] [MainThread]: Command `dbt run` failed at 18:34:59.862208 after 2.96 seconds
[0m18:34:59.863207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480bb593d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480c403860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72480c4027e0>]}
[0m18:34:59.864075 [debug] [MainThread]: Flushing usage events
[0m18:35:00.562153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:04.708494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc76a919130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc767001430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc767002360>]}


============================== 18:55:04.792057 | 38b7dbbe-9825-4d68-a113-d4fec8b51371 ==============================
[0m18:55:04.792057 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:55:04.793543 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:05.045376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38b7dbbe-9825-4d68-a113-d4fec8b51371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc7662204a0>]}
[0m18:55:05.114977 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:55:05.123263 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:55:05.126412 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54928386, "process_in_blocks": "1384", "process_kernel_time": 0.60075, "process_mem_max_rss": "124528", "process_out_blocks": "0", "process_user_time": 5.218515}
[0m18:55:05.127621 [debug] [MainThread]: Command `dbt deps` succeeded at 18:55:05.127416 after 0.55 seconds
[0m18:55:05.128405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc766a62270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc7690bcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc7662204a0>]}
[0m18:55:05.129122 [debug] [MainThread]: Flushing usage events
[0m18:55:05.748043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:11.693124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b4e42720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b4e42660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b547a1e0>]}


============================== 18:55:11.762866 | f69b69c5-f2da-4358-aaa5-31d113f83a84 ==============================
[0m18:55:11.762866 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:55:11.763929 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None'}
[0m18:55:11.816533 [info ] [MainThread]: dbt version: 1.11.6
[0m18:55:11.817466 [info ] [MainThread]: python version: 3.12.12
[0m18:55:11.818213 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:55:11.818948 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m18:55:11.919533 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m18:55:11.920572 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m18:55:11.921358 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m18:55:11.922386 [info ] [MainThread]: adapter type: postgres
[0m18:55:11.923090 [info ] [MainThread]: adapter version: 1.10.0
[0m18:55:12.142786 [info ] [MainThread]: Configuration:
[0m18:55:12.143797 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:55:12.144556 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:55:12.145390 [info ] [MainThread]: Required dependencies:
[0m18:55:12.146293 [debug] [MainThread]: Executing "git --help"
[0m18:55:12.149748 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:55:12.150635 [debug] [MainThread]: STDERR: "b''"
[0m18:55:12.151209 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:55:12.151941 [info ] [MainThread]: Connection:
[0m18:55:12.152601 [info ] [MainThread]:   host: db
[0m18:55:12.153222 [info ] [MainThread]:   port: 5432
[0m18:55:12.153878 [info ] [MainThread]:   user: postgres
[0m18:55:12.154516 [info ] [MainThread]:   database: spacex_db
[0m18:55:12.155146 [info ] [MainThread]:   schema: analytics
[0m18:55:12.155779 [info ] [MainThread]:   connect_timeout: 10
[0m18:55:12.156396 [info ] [MainThread]:   role: None
[0m18:55:12.157006 [info ] [MainThread]:   search_path: None
[0m18:55:12.157620 [info ] [MainThread]:   keepalives_idle: 0
[0m18:55:12.158228 [info ] [MainThread]:   sslmode: None
[0m18:55:12.158836 [info ] [MainThread]:   sslcert: None
[0m18:55:12.159462 [info ] [MainThread]:   sslkey: None
[0m18:55:12.160144 [info ] [MainThread]:   sslrootcert: None
[0m18:55:12.160736 [info ] [MainThread]:   application_name: dbt
[0m18:55:12.161326 [info ] [MainThread]:   retries: 1
[0m18:55:12.162142 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:55:12.316116 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:55:12.391888 [debug] [MainThread]: Using postgres connection "debug"
[0m18:55:12.392736 [debug] [MainThread]: On debug: select 1 as id
[0m18:55:12.393484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:12.409830 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m18:55:12.411518 [debug] [MainThread]: On debug: Close
[0m18:55:12.412340 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:55:12.413118 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:55:12.415610 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8542075, "process_in_blocks": "56", "process_kernel_time": 0.563769, "process_mem_max_rss": "124876", "process_out_blocks": "0", "process_user_time": 5.589372}
[0m18:55:12.416541 [debug] [MainThread]: Command `dbt debug` succeeded at 18:55:12.416392 after 0.86 seconds
[0m18:55:12.417227 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:55:12.417955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b7ad75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b75e4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36b4524a10>]}
[0m18:55:12.418747 [debug] [MainThread]: Flushing usage events
[0m18:55:13.066332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:19.438781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7d4709b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7de3f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7dcbd2b0>]}


============================== 18:55:19.522228 | 272c2dfc-0f94-46a3-a167-e546df08cfb2 ==============================
[0m18:55:19.522228 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:55:19.523500 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'printer_width': '80'}
[0m18:55:19.967981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7dd6f740>]}
[0m18:55:20.098061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7d372ba0>]}
[0m18:55:20.099585 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m18:55:20.282380 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m18:55:20.596888 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m18:55:20.598321 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/marts/dim_rockets.sql
[0m18:55:20.599458 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_rockets.sql
[0m18:55:20.600334 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m18:55:21.133804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7d071b80>]}
[0m18:55:21.287102 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:55:21.294259 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:55:21.383977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7bbd3c20>]}
[0m18:55:21.384936 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m18:55:21.385702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7bbb9f10>]}
[0m18:55:21.388654 [info ] [MainThread]: 
[0m18:55:21.389469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:21.390311 [info ] [MainThread]: 
[0m18:55:21.391342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:21.397394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m18:55:21.486596 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m18:55:21.487662 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m18:55:21.488440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:21.510856 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m18:55:21.513068 [debug] [ThreadPool]: On list_spacex_db: Close
[0m18:55:21.516011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m18:55:21.524562 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m18:55:21.525640 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m18:55:21.526410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:21.555019 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m18:55:21.557423 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m18:55:21.558420 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m18:55:21.566895 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.568397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:55:21.569544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:21.597817 [debug] [MainThread]: SQL status: SELECT 4 in 0.028 seconds
[0m18:55:21.600300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7d374ad0>]}
[0m18:55:21.601307 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:21.602443 [debug] [MainThread]: On master: COMMIT
[0m18:55:21.603226 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:21.603960 [debug] [MainThread]: On master: COMMIT
[0m18:55:21.605219 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:55:21.605969 [debug] [MainThread]: On master: Close
[0m18:55:21.614173 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m18:55:21.614942 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m18:55:21.615744 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m18:55:21.616830 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m18:55:21.617764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m18:55:21.618763 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m18:55:21.619587 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m18:55:21.620381 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m18:55:21.631619 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m18:55:21.635034 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m18:55:21.643478 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m18:55:21.651288 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m18:55:21.733041 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m18:55:21.740448 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m18:55:21.747813 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:55:21.748636 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:55:21.749299 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    rocket AS rocket_id,
    success AS is_success,
    flight_number,
    NOW() AS stg_updated_at
FROM "spacex_db"."public"."silver_launches"
  );
[0m18:55:21.750252 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)
SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal,  -- converte percentual para decimal
    NOW() AS stg_updated_at
FROM source
  );
[0m18:55:21.751133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:21.752056 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:21.780041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m18:55:21.780908 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m18:55:21.792167 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:55:21.796259 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:55:21.797490 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m18:55:21.798627 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m18:55:21.802039 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:55:21.802758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:55:21.807258 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:55:21.811640 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:55:21.812628 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m18:55:21.813762 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m18:55:21.815855 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:21.816533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:21.857919 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:55:21.858985 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:55:21.859705 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:55:21.860805 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:55:21.861778 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m18:55:21.863117 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m18:55:21.868927 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m18:55:21.875675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m18:55:21.879736 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m18:55:21.883251 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m18:55:21.893839 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m18:55:21.895202 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m18:55:21.896203 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m18:55:21.897258 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m18:55:21.906667 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m18:55:21.907719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m18:55:21.911338 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m18:55:21.914064 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m18:55:21.917694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7e651370>]}
[0m18:55:21.918371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c79739610>]}
[0m18:55:21.920684 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:55:21.922299 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m18:55:21.923565 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m18:55:21.924674 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m18:55:21.926296 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m18:55:21.927477 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m18:55:21.928542 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m18:55:21.929325 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m18:55:21.933757 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m18:55:21.943582 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m18:55:21.975892 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m18:55:21.987471 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:55:21.988337 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m18:55:21.989183 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:22.016320 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.027 seconds
[0m18:55:22.026055 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:55:22.027326 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m18:55:22.029281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:22.035821 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:55:22.036814 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m18:55:22.038431 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:22.040663 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:55:22.041813 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:55:22.042787 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m18:55:22.045889 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:22.130637 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m18:55:22.135763 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m18:55:22.136651 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m18:55:22.144662 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m18:55:22.147491 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m18:55:22.149511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c797dfa40>]}
[0m18:55:22.153465 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.22s]
[0m18:55:22.155215 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m18:55:22.157500 [debug] [Thread-2 (]: Began running node model.spacex_analytics.fct_launches
[0m18:55:22.158572 [info ] [Thread-2 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m18:55:22.159548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_rockets, now model.spacex_analytics.fct_launches)
[0m18:55:22.160379 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.fct_launches
[0m18:55:22.165235 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m18:55:22.176219 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.fct_launches
[0m18:55:22.181283 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m18:55:22.191855 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:55:22.192793 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m18:55:22.193533 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:22.221477 [debug] [Thread-2 (]: SQL status: SELECT 205 in 0.028 seconds
[0m18:55:22.226500 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:55:22.227297 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m18:55:22.229084 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:22.233452 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:55:22.234448 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m18:55:22.236505 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:22.239203 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:55:22.240029 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:55:22.240881 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m18:55:22.243459 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:22.246980 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m18:55:22.248214 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m18:55:22.249172 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m18:55:22.255883 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m18:55:22.258264 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: Close
[0m18:55:22.259529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7d0714f0>]}
[0m18:55:22.260907 [info ] [Thread-2 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m18:55:22.262205 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.fct_launches
[0m18:55:22.264270 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m18:55:22.265856 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m18:55:22.267332 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m18:55:22.268133 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m18:55:22.272496 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m18:55:22.282841 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m18:55:22.287535 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m18:55:22.299036 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m18:55:22.299992 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    -- models/marts/gold_rocket_performance.sql

WITH rockets AS (
    SELECT 
        rocket_id,
        name AS rocket_name
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id,
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    ROUND(
        AVG(CASE WHEN l.success = TRUE THEN 1.0 ELSE 0.0 END)::numeric * 100, 
        2
    ) AS success_rate_pct
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
  );
[0m18:55:22.300908 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:22.315827 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "name" does not exist
LINE 12:         name AS rocket_name
                 ^

[0m18:55:22.316977 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m18:55:22.318228 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m18:55:22.324593 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:55:22.325786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '272c2dfc-0f94-46a3-a167-e546df08cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c797bf320>]}
[0m18:55:22.326871 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m18:55:22.328133 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m18:55:22.330072 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m18:55:22.333991 [debug] [MainThread]: On master: COMMIT
[0m18:55:22.334716 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:22.335376 [debug] [MainThread]: On master: COMMIT
[0m18:55:22.335979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:22.350411 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m18:55:22.351326 [debug] [MainThread]: On master: Close
[0m18:55:22.352269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:22.352909 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_launches' was properly closed.
[0m18:55:22.353522 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m18:55:22.354176 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m18:55:22.354778 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m18:55:22.355583 [info ] [MainThread]: 
[0m18:55:22.356327 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m18:55:22.358578 [debug] [MainThread]: Command end result
[0m18:55:22.410204 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m18:55:22.418283 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m18:55:22.431693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m18:55:22.432448 [info ] [MainThread]: 
[0m18:55:22.433247 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:55:22.433961 [info ] [MainThread]: 
[0m18:55:22.434768 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m18:55:22.435541 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "name" does not exist
  LINE 12:         name AS rocket_name
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:55:22.436204 [info ] [MainThread]: 
[0m18:55:22.436933 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m18:55:22.437744 [info ] [MainThread]: 
[0m18:55:22.438622 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:55:22.441127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1599588, "process_in_blocks": "80", "process_kernel_time": 0.740838, "process_mem_max_rss": "139144", "process_out_blocks": "0", "process_user_time": 7.58554}
[0m18:55:22.442084 [debug] [MainThread]: Command `dbt run` failed at 18:55:22.441937 after 3.16 seconds
[0m18:55:22.442972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7de3f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c7dcc57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767c797a0ad0>]}
[0m18:55:22.443741 [debug] [MainThread]: Flushing usage events
[0m18:55:23.079056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:55.549705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799683008d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799680229070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799682d13fb0>]}


============================== 18:59:55.625952 | 2d14ee07-4c80-4c24-8521-580eb3c6d329 ==============================
[0m18:59:55.625952 [info ] [MainThread]: Running with dbt=1.11.6
[0m18:59:55.627073 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m18:59:55.875951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d14ee07-4c80-4c24-8521-580eb3c6d329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799680692d20>]}
[0m18:59:55.952075 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:59:55.960252 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:59:55.962726 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5418331, "process_in_blocks": "0", "process_kernel_time": 0.567467, "process_mem_max_rss": "124816", "process_out_blocks": "0", "process_user_time": 5.430907}
[0m18:59:55.963609 [debug] [MainThread]: Command `dbt deps` succeeded at 18:59:55.963454 after 0.54 seconds
[0m18:59:55.964411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799683008d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79967fd18980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79967f89ef00>]}
[0m18:59:55.965405 [debug] [MainThread]: Flushing usage events
[0m18:59:56.604751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:02.849639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240198d6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724019029ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72401953b950>]}


============================== 19:00:02.927976 | f9894ff2-71a7-4732-b63c-a97e0abe0ab3 ==============================
[0m19:00:02.927976 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:00:02.929084 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/app/dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m19:00:02.986670 [info ] [MainThread]: dbt version: 1.11.6
[0m19:00:02.987506 [info ] [MainThread]: python version: 3.12.12
[0m19:00:02.988456 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:00:02.989178 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m19:00:03.110904 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m19:00:03.111900 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m19:00:03.112740 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:00:03.113994 [info ] [MainThread]: adapter type: postgres
[0m19:00:03.114715 [info ] [MainThread]: adapter version: 1.10.0
[0m19:00:03.316607 [info ] [MainThread]: Configuration:
[0m19:00:03.317652 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:00:03.318613 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:00:03.319316 [info ] [MainThread]: Required dependencies:
[0m19:00:03.320142 [debug] [MainThread]: Executing "git --help"
[0m19:00:03.323513 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:00:03.324417 [debug] [MainThread]: STDERR: "b''"
[0m19:00:03.325087 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:00:03.325812 [info ] [MainThread]: Connection:
[0m19:00:03.326518 [info ] [MainThread]:   host: db
[0m19:00:03.327181 [info ] [MainThread]:   port: 5432
[0m19:00:03.327844 [info ] [MainThread]:   user: postgres
[0m19:00:03.328543 [info ] [MainThread]:   database: spacex_db
[0m19:00:03.329204 [info ] [MainThread]:   schema: analytics
[0m19:00:03.329953 [info ] [MainThread]:   connect_timeout: 10
[0m19:00:03.330701 [info ] [MainThread]:   role: None
[0m19:00:03.331366 [info ] [MainThread]:   search_path: None
[0m19:00:03.332107 [info ] [MainThread]:   keepalives_idle: 0
[0m19:00:03.332775 [info ] [MainThread]:   sslmode: None
[0m19:00:03.333669 [info ] [MainThread]:   sslcert: None
[0m19:00:03.334342 [info ] [MainThread]:   sslkey: None
[0m19:00:03.335017 [info ] [MainThread]:   sslrootcert: None
[0m19:00:03.335687 [info ] [MainThread]:   application_name: dbt
[0m19:00:03.336427 [info ] [MainThread]:   retries: 1
[0m19:00:03.337294 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:00:03.486953 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:00:03.560068 [debug] [MainThread]: Using postgres connection "debug"
[0m19:00:03.560925 [debug] [MainThread]: On debug: select 1 as id
[0m19:00:03.561594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:03.578190 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m19:00:03.579955 [debug] [MainThread]: On debug: Close
[0m19:00:03.580933 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:00:03.581644 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:00:03.583756 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8711525, "process_in_blocks": "0", "process_kernel_time": 0.685062, "process_mem_max_rss": "124864", "process_out_blocks": "0", "process_user_time": 5.744906}
[0m19:00:03.584791 [debug] [MainThread]: Command `dbt debug` succeeded at 19:00:03.584649 after 0.87 seconds
[0m19:00:03.585450 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:00:03.586162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72401953f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72401804ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240198d6840>]}
[0m19:00:03.586917 [debug] [MainThread]: Flushing usage events
[0m19:00:04.215542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:10.466242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc74fa540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc7c881a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc7c8a4b0>]}


============================== 19:00:10.544065 | f4eebeea-598e-484c-a11c-442094649221 ==============================
[0m19:00:10.544065 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:00:10.545029 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/app/dbt'}
[0m19:00:10.880806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc77e8080>]}
[0m19:00:11.008899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc7d2e960>]}
[0m19:00:11.010510 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:00:11.182241 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:00:11.465275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:00:11.466492 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/gold_rocket_performance.sql
[0m19:00:11.467326 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_rockets.sql
[0m19:00:11.986411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc5d73980>]}
[0m19:00:12.135223 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:00:12.142318 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:00:12.232693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc598f170>]}
[0m19:00:12.233675 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m19:00:12.234462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc599cc80>]}
[0m19:00:12.237497 [info ] [MainThread]: 
[0m19:00:12.238317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:12.239003 [info ] [MainThread]: 
[0m19:00:12.239936 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:00:12.245845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m19:00:12.334918 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m19:00:12.336233 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m19:00:12.337081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:12.358590 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m19:00:12.360873 [debug] [ThreadPool]: On list_spacex_db: Close
[0m19:00:12.363489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m19:00:12.373420 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m19:00:12.374354 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:00:12.375105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:12.400515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m19:00:12.402755 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m19:00:12.403723 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m19:00:12.411153 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:12.412195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:00:12.413135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:12.437994 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m19:00:12.440671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc4901280>]}
[0m19:00:12.441588 [debug] [MainThread]: On master: ROLLBACK
[0m19:00:12.442647 [debug] [MainThread]: On master: COMMIT
[0m19:00:12.443350 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:12.443991 [debug] [MainThread]: On master: COMMIT
[0m19:00:12.445041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:00:12.445723 [debug] [MainThread]: On master: Close
[0m19:00:12.452543 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m19:00:12.453311 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m19:00:12.454159 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m19:00:12.455451 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m19:00:12.456672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m19:00:12.458035 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m19:00:12.458943 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m19:00:12.459790 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m19:00:12.474824 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m19:00:12.476437 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m19:00:12.482619 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m19:00:12.489689 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m19:00:12.575576 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m19:00:12.578804 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m19:00:12.586233 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:00:12.587056 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:00:12.587642 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)
SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal,
    NOW() AS stg_updated_at
FROM source
  );
[0m19:00:12.589402 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    rocket AS rocket_id,
    success AS is_success,
    flight_number,
    NOW() AS stg_updated_at
FROM "spacex_db"."public"."silver_launches"
  );
[0m19:00:12.594437 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:00:12.595307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:12.618968 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m19:00:12.619794 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m19:00:12.630942 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:00:12.635191 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:00:12.636188 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m19:00:12.637408 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m19:00:12.639730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:12.640507 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:00:12.644912 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:00:12.649680 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:00:12.650706 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m19:00:12.651707 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m19:00:12.653557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:12.654121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:12.695189 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m19:00:12.696165 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:00:12.696717 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:00:12.697599 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:00:12.698392 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m19:00:12.699225 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:00:12.703918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:00:12.710162 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m19:00:12.713617 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m19:00:12.716666 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m19:00:12.726484 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:00:12.727470 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:00:12.728388 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m19:00:12.729253 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m19:00:12.736503 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m19:00:12.737408 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m19:00:12.740875 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m19:00:12.742877 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m19:00:12.746472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc4932960>]}
[0m19:00:12.747111 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc4981b80>]}
[0m19:00:12.748248 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.29s]
[0m19:00:12.749748 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m19:00:12.750902 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m19:00:12.752122 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m19:00:12.754555 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m19:00:12.755538 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m19:00:12.756598 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m19:00:12.757331 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m19:00:12.761699 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m19:00:12.778940 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m19:00:12.810346 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m19:00:12.821642 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:00:12.822474 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m19:00:12.823177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:00:12.847175 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.024 seconds
[0m19:00:12.856300 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:00:12.857199 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m19:00:12.858986 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:12.866468 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:00:12.867814 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m19:00:12.869849 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:12.872749 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:00:12.873728 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:00:12.874508 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:00:12.881680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m19:00:12.965844 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m19:00:12.972071 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:00:12.973117 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m19:00:12.980290 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:00:12.982845 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m19:00:12.984055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc41d6a20>]}
[0m19:00:12.985231 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.23s]
[0m19:00:12.986513 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m19:00:12.988284 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m19:00:12.989198 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m19:00:12.990053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m19:00:12.990728 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m19:00:12.995524 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m19:00:13.003821 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m19:00:13.008871 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m19:00:13.019010 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:00:13.019949 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m19:00:13.021013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:13.048162 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.027 seconds
[0m19:00:13.053089 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:00:13.053978 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m19:00:13.055771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:13.060199 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:00:13.061334 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m19:00:13.063017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:00:13.065842 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m19:00:13.066773 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:00:13.067499 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m19:00:13.070054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:00:13.073432 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m19:00:13.074538 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:00:13.075371 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m19:00:13.082260 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:00:13.084802 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m19:00:13.086001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc61928d0>]}
[0m19:00:13.088652 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m19:00:13.090024 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m19:00:13.091670 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m19:00:13.092645 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m19:00:13.093620 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m19:00:13.094629 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m19:00:13.099500 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m19:00:13.110373 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m19:00:13.115412 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m19:00:13.125360 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m19:00:13.126202 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    -- models/marts/gold_rocket_performance.sql

WITH rockets AS (
    SELECT 
        rocket_id,
        rocket_name
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket AS rocket_id,
        success
    FROM "spacex_db"."analytics"."fct_launches"
)
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    ROUND(
        AVG(CASE WHEN l.success = TRUE THEN 1.0 ELSE 0.0 END)::numeric * 100, 
        2
    ) AS success_rate_pct
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
  );
[0m19:00:13.127004 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:00:13.141289 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "rocket" does not exist
LINE 18:         rocket AS rocket_id,
                 ^

[0m19:00:13.142480 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m19:00:13.143812 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m19:00:13.150150 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket" does not exist
  LINE 18:         rocket AS rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:00:13.151596 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4eebeea-598e-484c-a11c-442094649221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc4182ea0>]}
[0m19:00:13.152930 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m19:00:13.154127 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m19:00:13.155416 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket" does not exist
  LINE 18:         rocket AS rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m19:00:13.159741 [debug] [MainThread]: On master: COMMIT
[0m19:00:13.160840 [debug] [MainThread]: Using postgres connection "master"
[0m19:00:13.161578 [debug] [MainThread]: On master: COMMIT
[0m19:00:13.162236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:00:13.176943 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m19:00:13.177867 [debug] [MainThread]: On master: Close
[0m19:00:13.178851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:13.181745 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m19:00:13.182476 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m19:00:13.183138 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m19:00:13.184464 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m19:00:13.185628 [info ] [MainThread]: 
[0m19:00:13.186418 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m19:00:13.188811 [debug] [MainThread]: Command end result
[0m19:00:13.239925 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:00:13.247176 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:00:13.260304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m19:00:13.261080 [info ] [MainThread]: 
[0m19:00:13.261889 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:00:13.262610 [info ] [MainThread]: 
[0m19:00:13.263404 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m19:00:13.264224 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket" does not exist
  LINE 18:         rocket AS rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:00:13.264893 [info ] [MainThread]: 
[0m19:00:13.265647 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:00:13.266306 [info ] [MainThread]: 
[0m19:00:13.267010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m19:00:13.269482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9480674, "process_in_blocks": "0", "process_kernel_time": 0.771026, "process_mem_max_rss": "138224", "process_out_blocks": "0", "process_user_time": 7.342728}
[0m19:00:13.270564 [debug] [MainThread]: Command `dbt run` failed at 19:00:13.270384 after 2.95 seconds
[0m19:00:13.271398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbcbb3ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc9158b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cbc915b260>]}
[0m19:00:13.272174 [debug] [MainThread]: Flushing usage events
[0m19:00:13.891695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:35.576992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3e11fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3d225e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3d30cc20>]}


============================== 19:04:35.648102 | 53148fe4-f513-4a18-b054-337ab9eb889e ==============================
[0m19:04:35.648102 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:04:35.649243 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None'}
[0m19:04:35.898820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53148fe4-f513-4a18-b054-337ab9eb889e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3f96c5c0>]}
[0m19:04:35.974142 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:04:35.982976 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:04:35.985717 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5392019, "process_in_blocks": "4120", "process_kernel_time": 0.599431, "process_mem_max_rss": "124232", "process_out_blocks": "0", "process_user_time": 5.081089}
[0m19:04:35.986611 [debug] [MainThread]: Command `dbt deps` succeeded at 19:04:35.986459 after 0.54 seconds
[0m19:04:35.987547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3e11fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3cb57710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bac3caad1f0>]}
[0m19:04:35.988353 [debug] [MainThread]: Flushing usage events
[0m19:04:36.786102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:42.780646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d435aacbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4369a02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d4379080b0>]}


============================== 19:04:42.844655 | dc73b258-03e6-4b5b-9902-82583b0b17b7 ==============================
[0m19:04:42.844655 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:04:42.845964 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True'}
[0m19:04:42.900051 [info ] [MainThread]: dbt version: 1.11.6
[0m19:04:42.900911 [info ] [MainThread]: python version: 3.12.12
[0m19:04:42.901681 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:04:42.902412 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m19:04:43.004547 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m19:04:43.005684 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m19:04:43.006515 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:04:43.007729 [info ] [MainThread]: adapter type: postgres
[0m19:04:43.008497 [info ] [MainThread]: adapter version: 1.10.0
[0m19:04:43.206456 [info ] [MainThread]: Configuration:
[0m19:04:43.207680 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:04:43.208517 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:04:43.209364 [info ] [MainThread]: Required dependencies:
[0m19:04:43.210238 [debug] [MainThread]: Executing "git --help"
[0m19:04:43.213794 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:04:43.214709 [debug] [MainThread]: STDERR: "b''"
[0m19:04:43.215415 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:04:43.216300 [info ] [MainThread]: Connection:
[0m19:04:43.217105 [info ] [MainThread]:   host: db
[0m19:04:43.217828 [info ] [MainThread]:   port: 5432
[0m19:04:43.218570 [info ] [MainThread]:   user: postgres
[0m19:04:43.219294 [info ] [MainThread]:   database: spacex_db
[0m19:04:43.220021 [info ] [MainThread]:   schema: analytics
[0m19:04:43.220737 [info ] [MainThread]:   connect_timeout: 10
[0m19:04:43.221421 [info ] [MainThread]:   role: None
[0m19:04:43.222096 [info ] [MainThread]:   search_path: None
[0m19:04:43.222789 [info ] [MainThread]:   keepalives_idle: 0
[0m19:04:43.223442 [info ] [MainThread]:   sslmode: None
[0m19:04:43.224233 [info ] [MainThread]:   sslcert: None
[0m19:04:43.224887 [info ] [MainThread]:   sslkey: None
[0m19:04:43.225534 [info ] [MainThread]:   sslrootcert: None
[0m19:04:43.226424 [info ] [MainThread]:   application_name: dbt
[0m19:04:43.227195 [info ] [MainThread]:   retries: 1
[0m19:04:43.228200 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:04:43.377767 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:04:43.452401 [debug] [MainThread]: Using postgres connection "debug"
[0m19:04:43.453417 [debug] [MainThread]: On debug: select 1 as id
[0m19:04:43.454129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:43.476274 [debug] [MainThread]: SQL status: SELECT 1 in 0.022 seconds
[0m19:04:43.478047 [debug] [MainThread]: On debug: Close
[0m19:04:43.479560 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:04:43.480889 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:04:43.483559 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.82922083, "process_in_blocks": "608", "process_kernel_time": 0.658827, "process_mem_max_rss": "124132", "process_out_blocks": "0", "process_user_time": 5.49821}
[0m19:04:43.484820 [debug] [MainThread]: Command `dbt debug` succeeded at 19:04:43.484631 after 0.83 seconds
[0m19:04:43.485646 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:04:43.486404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d43607b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d435932270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d43569d910>]}
[0m19:04:43.487178 [debug] [MainThread]: Flushing usage events
[0m19:04:44.115307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:49.891681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fafaa7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773face09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773face0b260>]}


============================== 19:04:49.961628 | cf5e250d-e10a-4afe-84bb-39db94936bc0 ==============================
[0m19:04:49.961628 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:04:49.962736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/app/dbt', 'static_parser': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'debug': 'False'}
[0m19:04:50.299323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fae8fc590>]}
[0m19:04:50.422996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fabab8e00>]}
[0m19:04:50.424520 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:04:50.589979 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:04:50.890054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:04:50.891277 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/gold_rocket_performance.sql
[0m19:04:51.391137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773faa324500>]}
[0m19:04:51.539940 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:04:51.547387 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:04:51.635874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa9f46c00>]}
[0m19:04:51.636751 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m19:04:51.637520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773faa35a210>]}
[0m19:04:51.640299 [info ] [MainThread]: 
[0m19:04:51.641114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:04:51.641900 [info ] [MainThread]: 
[0m19:04:51.643037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:04:51.648853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m19:04:51.735379 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m19:04:51.736631 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m19:04:51.737441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:51.756302 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m19:04:51.758507 [debug] [ThreadPool]: On list_spacex_db: Close
[0m19:04:51.761188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m19:04:51.771916 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m19:04:51.773088 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:04:51.773895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:51.802970 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m19:04:51.805336 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m19:04:51.806414 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m19:04:51.814141 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:51.815150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:04:51.816119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:51.843988 [debug] [MainThread]: SQL status: SELECT 4 in 0.028 seconds
[0m19:04:51.846204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa87292e0>]}
[0m19:04:51.847159 [debug] [MainThread]: On master: ROLLBACK
[0m19:04:51.848084 [debug] [MainThread]: On master: COMMIT
[0m19:04:51.848993 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:51.849698 [debug] [MainThread]: On master: COMMIT
[0m19:04:51.850789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:04:51.851445 [debug] [MainThread]: On master: Close
[0m19:04:51.859518 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m19:04:51.860294 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m19:04:51.861130 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m19:04:51.862213 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m19:04:51.863245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m19:04:51.864281 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m19:04:51.865178 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m19:04:51.865989 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m19:04:51.881408 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m19:04:51.883981 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m19:04:51.892431 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m19:04:51.902525 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m19:04:51.999790 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m19:04:52.000703 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m19:04:52.006168 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:04:52.007039 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)
SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal,
    NOW() AS stg_updated_at
FROM source
  );
[0m19:04:52.007717 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:04:52.008249 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:04:52.009086 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_launches"
)

SELECT
    launch_id,
    name AS launch_name,
    date_utc,
    rocket AS rocket_id,
    success AS is_success,
    flight_number,
    NOW() AS stg_updated_at
FROM "spacex_db"."public"."silver_launches"
  );
[0m19:04:52.010337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:52.036012 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m19:04:52.036818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m19:04:52.047752 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:04:52.051964 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:04:52.052865 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m19:04:52.053707 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m19:04:52.056984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:04:52.057613 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:04:52.061779 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:04:52.065987 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:04:52.066828 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m19:04:52.067662 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m19:04:52.069549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.070114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.106402 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:04:52.110515 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m19:04:52.111093 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:04:52.111922 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:04:52.112755 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:04:52.113701 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m19:04:52.116622 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:04:52.123042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m19:04:52.126876 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m19:04:52.130190 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m19:04:52.139721 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:04:52.140803 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:04:52.141850 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m19:04:52.142861 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m19:04:52.151461 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m19:04:52.155412 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m19:04:52.156122 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m19:04:52.158813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fae909fd0>]}
[0m19:04:52.162094 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m19:04:52.163441 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m19:04:52.164669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa87dcd10>]}
[0m19:04:52.165610 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m19:04:52.166798 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m19:04:52.168389 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m19:04:52.169210 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m19:04:52.170358 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m19:04:52.171422 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m19:04:52.172138 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m19:04:52.176672 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m19:04:52.187017 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m19:04:52.220224 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m19:04:52.230855 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:04:52.231674 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m19:04:52.232581 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:04:52.259251 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.026 seconds
[0m19:04:52.268697 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:04:52.269743 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m19:04:52.271528 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.278714 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:04:52.279824 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m19:04:52.281594 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.283989 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:04:52.284817 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:04:52.285627 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:04:52.288373 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m19:04:52.375960 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m19:04:52.381240 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:04:52.382216 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m19:04:52.389089 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m19:04:52.391470 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m19:04:52.392640 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa867b2c0>]}
[0m19:04:52.393976 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.22s]
[0m19:04:52.395357 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m19:04:52.397411 [debug] [Thread-2 (]: Began running node model.spacex_analytics.fct_launches
[0m19:04:52.398425 [info ] [Thread-2 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m19:04:52.399391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_rockets, now model.spacex_analytics.fct_launches)
[0m19:04:52.400154 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.fct_launches
[0m19:04:52.404887 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m19:04:52.415427 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.fct_launches
[0m19:04:52.421582 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m19:04:52.432285 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:04:52.433137 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches" -- Use a staging já limpa
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r ON l.rocket_id = r.rocket_id -- JOIN padronizado
  );
  
[0m19:04:52.433872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:04:52.462420 [debug] [Thread-2 (]: SQL status: SELECT 205 in 0.028 seconds
[0m19:04:52.467607 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:04:52.468844 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m19:04:52.470756 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.475247 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:04:52.476125 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m19:04:52.477764 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:04:52.480009 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m19:04:52.480769 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:04:52.481568 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m19:04:52.484071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:04:52.487632 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m19:04:52.489120 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m19:04:52.489915 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m19:04:52.496173 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:04:52.498546 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: Close
[0m19:04:52.499657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fac1058e0>]}
[0m19:04:52.503302 [info ] [Thread-2 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m19:04:52.505190 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.fct_launches
[0m19:04:52.507329 [debug] [Thread-1 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m19:04:52.508657 [info ] [Thread-1 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m19:04:52.509728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.gold_rocket_performance)
[0m19:04:52.510690 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m19:04:52.515229 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m19:04:52.525424 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m19:04:52.530489 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m19:04:52.541645 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m19:04:52.542525 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    WITH rockets AS (
    SELECT 
        rocket_id,
        rocket_name
    FROM "spacex_db"."analytics"."dim_rockets"
),
launches AS (
    SELECT 
        launch_id,
        rocket_id,
        is_success AS success
    FROM "spacex_db"."analytics"."fct_launches"
)
SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    ROUND(
        AVG(CASE WHEN l.success = TRUE THEN 1.0 ELSE 0.0 END)::numeric * 100, 
        2
    ) AS success_rate_pct
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
  );
[0m19:04:52.543299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:52.557740 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rocket_id" does not exist
LINE 16:         rocket_id,
                 ^

[0m19:04:52.558793 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m19:04:52.559984 [debug] [Thread-1 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m19:04:52.565649 [debug] [Thread-1 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket_id" does not exist
  LINE 16:         rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:04:52.566785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e250d-e10a-4afe-84bb-39db94936bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa870c950>]}
[0m19:04:52.567947 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m19:04:52.569255 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m19:04:52.570392 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket_id" does not exist
  LINE 16:         rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m19:04:52.574688 [debug] [MainThread]: On master: COMMIT
[0m19:04:52.575422 [debug] [MainThread]: Using postgres connection "master"
[0m19:04:52.576104 [debug] [MainThread]: On master: COMMIT
[0m19:04:52.576740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:52.590449 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m19:04:52.591401 [debug] [MainThread]: On master: Close
[0m19:04:52.592510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:52.593461 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m19:04:52.594248 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m19:04:52.594919 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m19:04:52.595933 [info ] [MainThread]: 
[0m19:04:52.596784 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m19:04:52.599189 [debug] [MainThread]: Command end result
[0m19:04:52.652165 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:04:52.659542 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:04:52.673597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m19:04:52.674423 [info ] [MainThread]: 
[0m19:04:52.675257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:04:52.676049 [info ] [MainThread]: 
[0m19:04:52.677003 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m19:04:52.677842 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column "rocket_id" does not exist
  LINE 16:         rocket_id,
                   ^
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:04:52.678550 [info ] [MainThread]: 
[0m19:04:52.679354 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m19:04:52.680044 [info ] [MainThread]: 
[0m19:04:52.680786 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m19:04:52.682934 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9494405, "process_in_blocks": "336", "process_kernel_time": 0.631767, "process_mem_max_rss": "138340", "process_out_blocks": "0", "process_user_time": 6.981435}
[0m19:04:52.683823 [debug] [MainThread]: Command `dbt run` failed at 19:04:52.683681 after 2.95 seconds
[0m19:04:52.684550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fac253aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fafaa7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773fa9f56180>]}
[0m19:04:52.685367 [debug] [MainThread]: Flushing usage events
[0m19:04:53.314528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:27.534857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0169f856d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c016bfe1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0169765ca0>]}


============================== 19:12:27.605384 | 113d2f1c-e6b9-46a9-84fa-26f82cc1138c ==============================
[0m19:12:27.605384 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:12:27.606686 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'static_parser': 'True'}
[0m19:12:27.850499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '113d2f1c-e6b9-46a9-84fa-26f82cc1138c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c01698c68a0>]}
[0m19:12:27.920570 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:12:27.928957 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:12:27.931500 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.53169084, "process_in_blocks": "1384", "process_kernel_time": 0.506749, "process_mem_max_rss": "124796", "process_out_blocks": "0", "process_user_time": 5.366752}
[0m19:12:27.932346 [debug] [MainThread]: Command `dbt deps` succeeded at 19:12:27.932200 after 0.53 seconds
[0m19:12:27.933098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0168f52450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0168b066c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0168bebf50>]}
[0m19:12:27.933894 [debug] [MainThread]: Flushing usage events
[0m19:12:28.733967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:34.829590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755628cf6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7556291270e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755629318c20>]}


============================== 19:12:34.901509 | 28664a22-41d6-446f-8582-ef129d87c507 ==============================
[0m19:12:34.901509 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:12:34.902701 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt debug', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'write_json': 'True'}
[0m19:12:34.958252 [info ] [MainThread]: dbt version: 1.11.6
[0m19:12:34.959228 [info ] [MainThread]: python version: 3.12.12
[0m19:12:34.960035 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:12:34.960819 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m19:12:35.069882 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m19:12:35.070893 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m19:12:35.071647 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:12:35.072771 [info ] [MainThread]: adapter type: postgres
[0m19:12:35.073499 [info ] [MainThread]: adapter version: 1.10.0
[0m19:12:35.267364 [info ] [MainThread]: Configuration:
[0m19:12:35.268419 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:12:35.269277 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:12:35.270131 [info ] [MainThread]: Required dependencies:
[0m19:12:35.271104 [debug] [MainThread]: Executing "git --help"
[0m19:12:35.274714 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:12:35.275730 [debug] [MainThread]: STDERR: "b''"
[0m19:12:35.276509 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:12:35.277269 [info ] [MainThread]: Connection:
[0m19:12:35.278071 [info ] [MainThread]:   host: db
[0m19:12:35.278854 [info ] [MainThread]:   port: 5432
[0m19:12:35.279577 [info ] [MainThread]:   user: postgres
[0m19:12:35.280248 [info ] [MainThread]:   database: spacex_db
[0m19:12:35.280941 [info ] [MainThread]:   schema: analytics
[0m19:12:35.281605 [info ] [MainThread]:   connect_timeout: 10
[0m19:12:35.282323 [info ] [MainThread]:   role: None
[0m19:12:35.283078 [info ] [MainThread]:   search_path: None
[0m19:12:35.283792 [info ] [MainThread]:   keepalives_idle: 0
[0m19:12:35.284486 [info ] [MainThread]:   sslmode: None
[0m19:12:35.285234 [info ] [MainThread]:   sslcert: None
[0m19:12:35.285963 [info ] [MainThread]:   sslkey: None
[0m19:12:35.286699 [info ] [MainThread]:   sslrootcert: None
[0m19:12:35.287573 [info ] [MainThread]:   application_name: dbt
[0m19:12:35.288266 [info ] [MainThread]:   retries: 1
[0m19:12:35.289356 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:12:35.447171 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:12:35.527255 [debug] [MainThread]: Using postgres connection "debug"
[0m19:12:35.528126 [debug] [MainThread]: On debug: select 1 as id
[0m19:12:35.528861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:35.548808 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m19:12:35.550422 [debug] [MainThread]: On debug: Close
[0m19:12:35.551272 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:12:35.551965 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:12:35.554056 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8570845, "process_in_blocks": "56", "process_kernel_time": 0.67337, "process_mem_max_rss": "124652", "process_out_blocks": "0", "process_user_time": 5.587369}
[0m19:12:35.555974 [debug] [MainThread]: Command `dbt debug` succeeded at 19:12:35.555370 after 0.86 seconds
[0m19:12:35.557040 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:12:35.557961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7556296a73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755628fe4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755629489100>]}
[0m19:12:35.558848 [debug] [MainThread]: Flushing usage events
[0m19:12:36.183689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:42.143698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec253981220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec253849fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec253f11400>]}


============================== 19:12:42.218141 | d50876af-5210-483f-8909-f9cf934fb228 ==============================
[0m19:12:42.218141 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:12:42.219247 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True'}
[0m19:12:42.564089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec255cfc590>]}
[0m19:12:42.686632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2530e84d0>]}
[0m19:12:42.688129 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:12:42.858414 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:12:43.124913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:12:43.126192 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/marts/fct_launches.sql
[0m19:12:43.127366 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m19:12:43.128379 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/gold/gold_rocket_performance.sql
[0m19:12:43.657358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec252ebb320>]}
[0m19:12:43.812546 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:12:43.820599 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:12:43.915145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec25134b530>]}
[0m19:12:43.916055 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m19:12:43.916771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec25134cb00>]}
[0m19:12:43.919951 [info ] [MainThread]: 
[0m19:12:43.920942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:43.921674 [info ] [MainThread]: 
[0m19:12:43.922723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:12:43.928552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m19:12:44.013471 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m19:12:44.014748 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m19:12:44.015566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:44.036536 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m19:12:44.039007 [debug] [ThreadPool]: On list_spacex_db: Close
[0m19:12:44.041817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m19:12:44.053122 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m19:12:44.054609 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m19:12:44.055381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:12:44.095889 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m19:12:44.098526 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m19:12:44.099914 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m19:12:44.111198 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:44.112641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:12:44.114090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:44.155718 [debug] [MainThread]: SQL status: SELECT 4 in 0.042 seconds
[0m19:12:44.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2517de9f0>]}
[0m19:12:44.160981 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:44.162373 [debug] [MainThread]: On master: COMMIT
[0m19:12:44.163158 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:44.163778 [debug] [MainThread]: On master: COMMIT
[0m19:12:44.164761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:12:44.165386 [debug] [MainThread]: On master: Close
[0m19:12:44.175676 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m19:12:44.177187 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m19:12:44.181884 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m19:12:44.183065 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m19:12:44.183918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m19:12:44.184849 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m19:12:44.185676 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m19:12:44.186454 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m19:12:44.198376 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m19:12:44.202518 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m19:12:44.216639 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m19:12:44.224638 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m19:12:44.320325 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m19:12:44.328965 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m19:12:44.495389 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m19:12:44.516201 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

WITH raw AS (
    SELECT
        id AS launch_id,
        name AS launch_name,
        date_utc,
        success AS is_success,
        rocket AS rocket_id  -- Mapeando rocket_id da API
    FROM "spacex_db"."public"."silver_launches"
)

SELECT *
FROM raw
  );
[0m19:12:44.521304 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:12:44.522218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:44.523720 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    WITH source AS (
    SELECT * FROM "spacex_db"."public"."silver_rockets"
)
SELECT
    rocket_id,
    name AS rocket_name,
    active AS is_active,
    CAST(cost_per_launch AS BIGINT) AS cost_per_launch,
    success_rate_pct / 100 AS success_rate_decimal,
    NOW() AS stg_updated_at
FROM source
  );
[0m19:12:44.560296 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 11:         id AS launch_id,
                 ^

[0m19:12:44.568337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:12:44.593607 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: ROLLBACK
[0m19:12:44.600971 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m19:12:44.607716 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 11:         id AS launch_id,
                   ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql
[0m19:12:44.612068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec254116c90>]}
[0m19:12:44.615909 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model analytics.stg_launches .................... [[31mERROR[0m in 0.43s]
[0m19:12:44.619463 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m19:12:44.621114 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 11:         id AS launch_id,
                   ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql.
[0m19:12:44.647240 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.079 seconds
[0m19:12:44.659842 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:12:44.660980 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m19:12:44.686061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:12:44.706257 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:12:44.707314 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m19:12:44.709308 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:44.733787 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:12:44.734782 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:12:44.735487 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m19:12:44.749556 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m19:12:44.760854 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m19:12:44.773424 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m19:12:44.774814 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m19:12:44.784400 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m19:12:44.788237 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m19:12:44.789997 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec255d09c40>]}
[0m19:12:44.791616 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.61s]
[0m19:12:44.792919 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m19:12:44.794826 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m19:12:44.795816 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m19:12:44.796826 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m19:12:44.797543 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m19:12:44.802252 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m19:12:44.811787 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m19:12:44.843418 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m19:12:44.853576 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:12:44.854405 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    rocket_id,
    rocket_name, -- Nome vindo da stg_rockets
    is_active,
    cost_per_launch,
    success_rate_decimal,
    NOW() AS gold_processed_at
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m19:12:44.855189 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:12:44.883472 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.028 seconds
[0m19:12:44.893736 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:12:44.894670 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m19:12:44.896427 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:44.902185 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:12:44.903229 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m19:12:44.904879 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:44.907367 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:12:44.908190 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:12:44.908989 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m19:12:44.911959 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m19:12:44.915917 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m19:12:44.920606 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m19:12:44.921631 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m19:12:44.928068 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:12:44.930378 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m19:12:44.931470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd50876af-5210-483f-8909-f9cf934fb228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec24f5365d0>]}
[0m19:12:44.935070 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.13s]
[0m19:12:44.936280 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m19:12:44.938136 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m19:12:44.939003 [info ] [Thread-1 (]: 4 of 5 SKIP relation analytics.fct_launches .................................... [[33mSKIP[0m]
[0m19:12:44.939889 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m19:12:44.941198 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m19:12:44.942126 [info ] [Thread-3 (]: 5 of 5 SKIP relation analytics.gold_rocket_performance ......................... [[33mSKIP[0m]
[0m19:12:44.943001 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m19:12:44.945799 [debug] [MainThread]: On master: COMMIT
[0m19:12:44.946519 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:44.947189 [debug] [MainThread]: On master: COMMIT
[0m19:12:44.947812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:44.961531 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m19:12:44.962502 [debug] [MainThread]: On master: Close
[0m19:12:44.963565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:44.964192 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_launches' was properly closed.
[0m19:12:44.964816 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m19:12:44.965565 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m19:12:44.966424 [info ] [MainThread]: 
[0m19:12:44.967278 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m19:12:44.969125 [debug] [MainThread]: Command end result
[0m19:12:45.097298 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m19:12:45.104148 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m19:12:45.118284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m19:12:45.119328 [info ] [MainThread]: 
[0m19:12:45.120176 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:12:45.121007 [info ] [MainThread]: 
[0m19:12:45.121868 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m19:12:45.122704 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 11:         id AS launch_id,
                   ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql
[0m19:12:45.123388 [info ] [MainThread]: 
[0m19:12:45.124135 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/staging/stg_launches.sql
[0m19:12:45.124797 [info ] [MainThread]: 
[0m19:12:45.125517 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m19:12:45.127785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.112592, "process_in_blocks": "80", "process_kernel_time": 0.733074, "process_mem_max_rss": "138624", "process_out_blocks": "0", "process_user_time": 7.012539}
[0m19:12:45.128640 [debug] [MainThread]: Command `dbt run` failed at 19:12:45.128493 after 3.11 seconds
[0m19:12:45.129373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec25745e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2561f2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec2561f2780>]}
[0m19:12:45.130061 [debug] [MainThread]: Flushing usage events
[0m19:12:45.809937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:26.103998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912fe13b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912f229040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912f07bf80>]}


============================== 19:25:26.198397 | 87f3137e-1f9f-4f62-8d01-70a999159d06 ==============================
[0m19:25:26.198397 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:25:26.199712 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:25:26.475351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87f3137e-1f9f-4f62-8d01-70a999159d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789130fe8560>]}
[0m19:25:26.555485 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:25:26.563122 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:25:26.566364 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6341341, "process_in_blocks": "1384", "process_kernel_time": 0.627454, "process_mem_max_rss": "125048", "process_out_blocks": "0", "process_user_time": 5.331362}
[0m19:25:26.567420 [debug] [MainThread]: Command `dbt deps` succeeded at 19:25:26.567229 after 0.64 seconds
[0m19:25:26.568186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912e990680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912e1daf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78912e180e90>]}
[0m19:25:26.568942 [debug] [MainThread]: Flushing usage events
[0m19:25:27.217269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:33.119905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d24f3a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d2568b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d25374530>]}


============================== 19:25:33.191637 | b33ac8b1-26ed-4a55-b03a-74a840762383 ==============================
[0m19:25:33.191637 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:25:33.192755 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False'}
[0m19:25:33.249284 [info ] [MainThread]: dbt version: 1.11.6
[0m19:25:33.250199 [info ] [MainThread]: python version: 3.12.12
[0m19:25:33.250934 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:25:33.251860 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m19:25:33.365462 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m19:25:33.366716 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m19:25:33.367862 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m19:25:33.369449 [info ] [MainThread]: adapter type: postgres
[0m19:25:33.370346 [info ] [MainThread]: adapter version: 1.10.0
[0m19:25:33.580247 [info ] [MainThread]: Configuration:
[0m19:25:33.581287 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:25:33.582082 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:25:33.583067 [info ] [MainThread]: Required dependencies:
[0m19:25:33.583857 [debug] [MainThread]: Executing "git --help"
[0m19:25:33.587724 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:25:33.588819 [debug] [MainThread]: STDERR: "b''"
[0m19:25:33.589544 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:25:33.590287 [info ] [MainThread]: Connection:
[0m19:25:33.591011 [info ] [MainThread]:   host: db
[0m19:25:33.591730 [info ] [MainThread]:   port: 5432
[0m19:25:33.592429 [info ] [MainThread]:   user: postgres
[0m19:25:33.593128 [info ] [MainThread]:   database: spacex_db
[0m19:25:33.593816 [info ] [MainThread]:   schema: analytics
[0m19:25:33.594549 [info ] [MainThread]:   connect_timeout: 10
[0m19:25:33.595226 [info ] [MainThread]:   role: None
[0m19:25:33.595884 [info ] [MainThread]:   search_path: None
[0m19:25:33.596587 [info ] [MainThread]:   keepalives_idle: 0
[0m19:25:33.597247 [info ] [MainThread]:   sslmode: None
[0m19:25:33.597911 [info ] [MainThread]:   sslcert: None
[0m19:25:33.598598 [info ] [MainThread]:   sslkey: None
[0m19:25:33.599260 [info ] [MainThread]:   sslrootcert: None
[0m19:25:33.599945 [info ] [MainThread]:   application_name: dbt
[0m19:25:33.600644 [info ] [MainThread]:   retries: 1
[0m19:25:33.601511 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:25:33.759272 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:25:33.837270 [debug] [MainThread]: Using postgres connection "debug"
[0m19:25:33.838318 [debug] [MainThread]: On debug: select 1 as id
[0m19:25:33.839686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:33.859012 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m19:25:33.860807 [debug] [MainThread]: On debug: Close
[0m19:25:33.861606 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:25:33.862391 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:25:33.864883 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8727469, "process_in_blocks": "56", "process_kernel_time": 0.618567, "process_mem_max_rss": "124284", "process_out_blocks": "0", "process_user_time": 5.487295}
[0m19:25:33.865926 [debug] [MainThread]: Command `dbt debug` succeeded at 19:25:33.865772 after 0.87 seconds
[0m19:25:33.866672 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:25:33.867381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d253bdd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d25edbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783d26196d80>]}
[0m19:25:33.868165 [debug] [MainThread]: Flushing usage events
[0m19:25:34.491282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:40.488570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70600508d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060062dbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060062da660>]}


============================== 19:25:40.555943 | 30e7f5f1-aa89-46a0-a896-715987aa5ff6 ==============================
[0m19:25:40.555943 [info ] [MainThread]: Running with dbt=1.11.6
[0m19:25:40.557065 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False'}
[0m19:25:40.939685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30e7f5f1-aa89-46a0-a896-715987aa5ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706005dda1b0>]}
[0m19:25:41.063998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30e7f5f1-aa89-46a0-a896-715987aa5ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706005a4d580>]}
[0m19:25:41.065624 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m19:25:41.236972 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m19:25:41.540514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:25:41.541776 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m19:25:41.913458 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_analytics.stg_launches' (models/staging/stg_launches.sql) depends on a node named 'silver_launches' which was not found
[0m19:25:41.916365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.559092, "process_in_blocks": "0", "process_kernel_time": 0.580293, "process_mem_max_rss": "124352", "process_out_blocks": "0", "process_user_time": 6.179129}
[0m19:25:41.917463 [debug] [MainThread]: Command `dbt run` failed at 19:25:41.917291 after 1.56 seconds
[0m19:25:41.918342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7060062dbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706003f3f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706006245910>]}
[0m19:25:41.919211 [debug] [MainThread]: Flushing usage events
[0m19:25:42.579066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:48.273898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2677F9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2655ECA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B269C27B10>]}


============================== 16:56:48.379442 | 97c4ae5a-a53c-4d00-84f0-b3492842e1aa ==============================
[0m16:56:48.379442 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:56:48.380470 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt\\logs'}
[0m16:56:48.790564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97c4ae5a-a53c-4d00-84f0-b3492842e1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B267EB6780>]}
[0m16:56:49.548836 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:56:49.550610 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:56:49.552637 [debug] [MainThread]: Command `dbt deps` succeeded at 16:56:49.552411 after 1.67 seconds
[0m16:56:49.553237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B269E3C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B269E3F020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B269B09650>]}
[0m16:56:49.553793 [debug] [MainThread]: Flushing usage events
[0m16:56:50.788805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:05.201695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C34D7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C4927D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C49279D0>]}


============================== 16:58:05.216676 | fa8172fd-a93d-41a0-b3d0-0eddf37fcc8c ==============================
[0m16:58:05.216676 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:58:05.217573 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_path': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt\\logs'}
[0m16:58:05.644597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa8172fd-a93d-41a0-b3d0-0eddf37fcc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C3C26190>]}
[0m16:58:06.107024 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:58:06.109056 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:58:06.111467 [debug] [MainThread]: Command `dbt deps` succeeded at 16:58:06.111214 after 1.23 seconds
[0m16:58:06.112076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C5A9DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C5BA0F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C4884B50>]}
[0m16:58:06.112623 [debug] [MainThread]: Flushing usage events
[0m16:58:07.188528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:23.304471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33E7B7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33FC0BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33FC0B9D0>]}


============================== 16:58:23.311072 | 8d57856b-5d57-4679-a396-fcc6f2054329 ==============================
[0m16:58:23.311072 [info ] [MainThread]: Running with dbt=1.11.6
[0m16:58:23.312031 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt\\logs'}
[0m16:58:24.288375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d57856b-5d57-4679-a396-fcc6f2054329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33EF06190>]}
[0m16:58:24.454252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d57856b-5d57-4679-a396-fcc6f2054329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33CD25590>]}
[0m16:58:24.464792 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:58:25.189754 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m16:58:25.455144 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:58:25.455991 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:58:25.456586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d57856b-5d57-4679-a396-fcc6f2054329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34115D050>]}
[0m16:58:28.680345 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.spacex_analytics.stg_launches' (models\staging\stg_launches.sql) depends on a source named 'spacex.silver_launches' which was not found
[0m16:58:28.682589 [debug] [MainThread]: Command `dbt run` failed at 16:58:28.682399 after 5.69 seconds
[0m16:58:28.683161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34117B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3415B0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F33FBEBE70>]}
[0m16:58:28.683712 [debug] [MainThread]: Flushing usage events
[0m16:58:29.846904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:18.332279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555BF27620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555E357D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555E3579D0>]}


============================== 17:00:18.338227 | 1f410a3a-6041-47dc-9e4c-fb074553a9c8 ==============================
[0m17:00:18.338227 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:00:18.339406 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_path': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt\\logs'}
[0m17:00:18.633370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f410a3a-6041-47dc-9e4c-fb074553a9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555C686190>]}
[0m17:00:18.664287 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:18.666035 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:18.668673 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:18.668412 after 0.70 seconds
[0m17:00:18.669291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555E57DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555E668F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002555D2E8B50>]}
[0m17:00:18.669843 [debug] [MainThread]: Flushing usage events
[0m17:00:19.674224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:23.714246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA6097620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA74FBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA74FB9D0>]}


============================== 17:00:23.719931 | 4c54d7c1-bf5b-47e7-bd01-d6771691375c ==============================
[0m17:00:23.719931 [info ] [MainThread]: Running with dbt=1.11.6
[0m17:00:23.720912 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'D:\\Documentos\\VsCode\\projetos_git\\spacex_etl_pipeline\\dbt\\logs'}
[0m17:00:24.235744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA67F6190>]}
[0m17:00:24.367702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA4605590>]}
[0m17:00:24.376602 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:00:24.824394 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m17:00:25.011774 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:00:25.012512 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:00:25.013076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8A40E50>]}
[0m17:00:27.424482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m17:00:27.451516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8A14E60>]}
[0m17:00:27.624081 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\VsCode\projetos_git\spacex_etl_pipeline\dbt\target\manifest.json
[0m17:00:27.642659 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\VsCode\projetos_git\spacex_etl_pipeline\dbt\target\semantic_manifest.json
[0m17:00:27.836487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8F91710>]}
[0m17:00:27.837246 [info ] [MainThread]: Found 7 models, 4 data tests, 2 sources, 464 macros
[0m17:00:27.837943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c54d7c1-bf5b-47e7-bd01-d6771691375c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8B17520>]}
[0m17:00:27.841054 [info ] [MainThread]: 
[0m17:00:27.841755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:27.842363 [info ] [MainThread]: 
[0m17:00:27.843323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:27.852579 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m17:00:28.273675 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m17:00:28.274246 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m17:00:28.274706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:32.339292 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

[0m17:00:36.390530 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m17:00:36.391329 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:00:36.392045 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:00:36.392645 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:00:36.393272 [debug] [ThreadPool]: On list_spacex_db: No close available on handle
[0m17:00:36.396412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:36.397201 [debug] [MainThread]: Connection 'list_spacex_db' was properly closed.
[0m17:00:36.397825 [info ] [MainThread]: 
[0m17:00:36.398919 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m17:00:36.400281 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m17:00:36.405847 [debug] [MainThread]: Command `dbt run` failed at 17:00:36.405370 after 12.96 seconds
[0m17:00:36.407558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA750D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8F4F540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA8F4F5F0>]}
[0m17:00:36.410163 [debug] [MainThread]: Flushing usage events
[0m17:00:37.377135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:04.629845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae44f390ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae451bc8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae44f06fa70>]}


============================== 20:04:04.698057 | 8cf23a5a-c58d-488a-9ff6-1480063dc58c ==============================
[0m20:04:04.698057 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:04:04.699182 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'printer_width': '80'}
[0m20:04:04.936735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cf23a5a-c58d-488a-9ff6-1480063dc58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4516ccd70>]}
[0m20:04:05.005759 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:05.014599 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:04:05.017279 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5139516, "process_in_blocks": "1384", "process_kernel_time": 0.516188, "process_mem_max_rss": "124576", "process_out_blocks": "0", "process_user_time": 4.969818}
[0m20:04:05.018178 [debug] [MainThread]: Command `dbt deps` succeeded at 20:04:05.018033 after 0.52 seconds
[0m20:04:05.018977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae44f11ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae44e81a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae44ef32b40>]}
[0m20:04:05.019718 [debug] [MainThread]: Flushing usage events
[0m20:04:05.830190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:11.483570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717d031b3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717d00480350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717d008cf350>]}


============================== 20:04:11.553155 | 9071eaa8-10e5-4d41-8018-1ddcbbfe677f ==============================
[0m20:04:11.553155 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:04:11.554253 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80'}
[0m20:04:11.608916 [info ] [MainThread]: dbt version: 1.11.6
[0m20:04:11.609912 [info ] [MainThread]: python version: 3.12.12
[0m20:04:11.610737 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:04:11.611464 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:04:11.715394 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m20:04:11.716438 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m20:04:11.717301 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:04:11.718338 [info ] [MainThread]: adapter type: postgres
[0m20:04:11.719135 [info ] [MainThread]: adapter version: 1.10.0
[0m20:04:11.907363 [info ] [MainThread]: Configuration:
[0m20:04:11.908415 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:04:11.909165 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:04:11.909903 [info ] [MainThread]: Required dependencies:
[0m20:04:11.910690 [debug] [MainThread]: Executing "git --help"
[0m20:04:11.914561 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:04:11.915580 [debug] [MainThread]: STDERR: "b''"
[0m20:04:11.916241 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:04:11.916942 [info ] [MainThread]: Connection:
[0m20:04:11.917710 [info ] [MainThread]:   host: db
[0m20:04:11.918448 [info ] [MainThread]:   port: 5432
[0m20:04:11.919135 [info ] [MainThread]:   user: postgres
[0m20:04:11.919824 [info ] [MainThread]:   database: spacex_db
[0m20:04:11.920494 [info ] [MainThread]:   schema: analytics
[0m20:04:11.921178 [info ] [MainThread]:   connect_timeout: 10
[0m20:04:11.921824 [info ] [MainThread]:   role: None
[0m20:04:11.922499 [info ] [MainThread]:   search_path: None
[0m20:04:11.923204 [info ] [MainThread]:   keepalives_idle: 0
[0m20:04:11.924021 [info ] [MainThread]:   sslmode: None
[0m20:04:11.924694 [info ] [MainThread]:   sslcert: None
[0m20:04:11.925355 [info ] [MainThread]:   sslkey: None
[0m20:04:11.925993 [info ] [MainThread]:   sslrootcert: None
[0m20:04:11.926698 [info ] [MainThread]:   application_name: dbt
[0m20:04:11.927403 [info ] [MainThread]:   retries: 1
[0m20:04:11.928252 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:04:12.081138 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:04:12.155841 [debug] [MainThread]: Using postgres connection "debug"
[0m20:04:12.156748 [debug] [MainThread]: On debug: select 1 as id
[0m20:04:12.157493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:12.174772 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m20:04:12.177027 [debug] [MainThread]: On debug: Close
[0m20:04:12.178130 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:04:12.181332 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:04:12.183680 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8233509, "process_in_blocks": "56", "process_kernel_time": 0.574765, "process_mem_max_rss": "124480", "process_out_blocks": "0", "process_user_time": 5.292629}
[0m20:04:12.184614 [debug] [MainThread]: Command `dbt debug` succeeded at 20:04:12.184467 after 0.82 seconds
[0m20:04:12.185302 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:04:12.186076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717cffe2f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717d005bee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717d00462330>]}
[0m20:04:12.186988 [debug] [MainThread]: Flushing usage events
[0m20:04:12.812973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:04:18.745881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e743a4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e73d3c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e743a7b00>]}


============================== 20:04:18.813555 | 0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5 ==============================
[0m20:04:18.813555 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:04:18.814830 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False'}
[0m20:04:19.172413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e730cc140>]}
[0m20:04:19.320607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e730cd2e0>]}
[0m20:04:19.322138 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:04:19.488343 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:04:19.644512 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:04:19.645483 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:04:19.646314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e72141a00>]}
[0m20:04:21.807439 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m20:04:21.824566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e7215df70>]}
[0m20:04:21.964859 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:04:21.972683 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:04:22.061569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e715b01d0>]}
[0m20:04:22.062497 [info ] [MainThread]: Found 7 models, 4 data tests, 2 sources, 464 macros
[0m20:04:22.063237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e731d9fa0>]}
[0m20:04:22.066433 [info ] [MainThread]: 
[0m20:04:22.067277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:22.068047 [info ] [MainThread]: 
[0m20:04:22.069021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:22.075283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m20:04:22.155964 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m20:04:22.157008 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m20:04:22.157813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:22.177741 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m20:04:22.180009 [debug] [ThreadPool]: On list_spacex_db: Close
[0m20:04:22.183101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m20:04:22.191466 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m20:04:22.192476 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:04:22.193331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:22.220228 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m20:04:22.222522 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m20:04:22.223548 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m20:04:22.231710 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:22.232777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:04:22.233636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:22.257419 [debug] [MainThread]: SQL status: SELECT 4 in 0.024 seconds
[0m20:04:22.260040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e715b3da0>]}
[0m20:04:22.261196 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:22.262275 [debug] [MainThread]: On master: COMMIT
[0m20:04:22.263046 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:22.263785 [debug] [MainThread]: On master: COMMIT
[0m20:04:22.264936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:04:22.265653 [debug] [MainThread]: On master: Close
[0m20:04:22.273224 [debug] [Thread-1 (]: Began running node model.spacex_analytics.silver_launches
[0m20:04:22.273959 [debug] [Thread-2 (]: Began running node model.spacex_analytics.silver_rockets
[0m20:04:22.274768 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics.silver_launches ......................... [RUN]
[0m20:04:22.276069 [info ] [Thread-2 (]: 2 of 7 START sql table model analytics.silver_rockets .......................... [RUN]
[0m20:04:22.277052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.silver_launches)
[0m20:04:22.278049 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.silver_rockets'
[0m20:04:22.278906 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.silver_launches
[0m20:04:22.279773 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.silver_rockets
[0m20:04:22.294148 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.silver_rockets"
[0m20:04:22.295296 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.silver_launches"
[0m20:04:22.319723 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.silver_rockets
[0m20:04:22.339175 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.silver_launches
[0m20:04:22.405775 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.silver_rockets"
[0m20:04:22.408312 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.silver_launches"
[0m20:04:22.419120 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.silver_rockets"
[0m20:04:22.420122 [debug] [Thread-2 (]: On model.spacex_analytics.silver_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.silver_rockets"} */

  
    

  create  table "spacex_db"."analytics"."silver_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM raw_rockets
  );
  
[0m20:04:22.420979 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:04:22.423911 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.silver_launches"
[0m20:04:22.424788 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.silver_launches"} */

  
    

  create  table "spacex_db"."analytics"."silver_launches__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM raw_launches
  );
  
[0m20:04:22.425542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:22.436333 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw_rockets" does not exist
LINE 15: FROM raw_rockets
              ^

[0m20:04:22.437310 [debug] [Thread-2 (]: On model.spacex_analytics.silver_rockets: ROLLBACK
[0m20:04:22.438424 [debug] [Thread-2 (]: On model.spacex_analytics.silver_rockets: Close
[0m20:04:22.441768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_launches" does not exist
LINE 15: FROM raw_launches
              ^

[0m20:04:22.443115 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: ROLLBACK
[0m20:04:22.444443 [debug] [Thread-1 (]: On model.spacex_analytics.silver_launches: Close
[0m20:04:22.447020 [debug] [Thread-2 (]: Database Error in model silver_rockets (models/silver/silver_rockets.sql)
  relation "raw_rockets" does not exist
  LINE 15: FROM raw_rockets
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_rockets.sql
[0m20:04:22.450266 [debug] [Thread-1 (]: Database Error in model silver_launches (models/silver/silver_launches.sql)
  relation "raw_launches" does not exist
  LINE 15: FROM raw_launches
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_launches.sql
[0m20:04:22.452901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e715b33e0>]}
[0m20:04:22.453662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b0a32c8-3d4e-4f65-9eb5-56b6f68edae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e6b3561e0>]}
[0m20:04:22.455321 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model analytics.silver_rockets ................. [[31mERROR[0m in 0.17s]
[0m20:04:22.456752 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model analytics.silver_launches ................ [[31mERROR[0m in 0.18s]
[0m20:04:22.458233 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.silver_rockets
[0m20:04:22.459446 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.silver_launches
[0m20:04:22.460926 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.silver_rockets' to be skipped because of status 'error'.  Reason: Database Error in model silver_rockets (models/silver/silver_rockets.sql)
  relation "raw_rockets" does not exist
  LINE 15: FROM raw_rockets
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_rockets.sql.
[0m20:04:22.463475 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.silver_launches' to be skipped because of status 'error'.  Reason: Database Error in model silver_launches (models/silver/silver_launches.sql)
  relation "raw_launches" does not exist
  LINE 15: FROM raw_launches
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_launches.sql.
[0m20:04:22.464480 [debug] [Thread-4 (]: Began running node model.spacex_analytics.stg_rockets
[0m20:04:22.465612 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_launches
[0m20:04:22.466273 [info ] [Thread-4 (]: 3 of 7 SKIP relation analytics.stg_rockets ..................................... [[33mSKIP[0m]
[0m20:04:22.467245 [info ] [Thread-2 (]: 4 of 7 SKIP relation analytics.stg_launches .................................... [[33mSKIP[0m]
[0m20:04:22.468109 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.stg_rockets
[0m20:04:22.469148 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_launches
[0m20:04:22.470732 [debug] [Thread-2 (]: Began running node model.spacex_analytics.dim_rockets
[0m20:04:22.471753 [info ] [Thread-2 (]: 5 of 7 SKIP relation analytics.dim_rockets ..................................... [[33mSKIP[0m]
[0m20:04:22.472748 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.dim_rockets
[0m20:04:22.474452 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m20:04:22.475242 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics.fct_launches .................................... [[33mSKIP[0m]
[0m20:04:22.476103 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m20:04:22.477593 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m20:04:22.478425 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics.gold_rocket_performance ......................... [[33mSKIP[0m]
[0m20:04:22.479323 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m20:04:22.482204 [debug] [MainThread]: On master: COMMIT
[0m20:04:22.482919 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:22.483550 [debug] [MainThread]: On master: COMMIT
[0m20:04:22.484225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:22.498435 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m20:04:22.499358 [debug] [MainThread]: On master: Close
[0m20:04:22.500386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:22.501827 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_launches' was properly closed.
[0m20:04:22.502873 [debug] [MainThread]: Connection 'model.spacex_analytics.silver_rockets' was properly closed.
[0m20:04:22.503885 [info ] [MainThread]: 
[0m20:04:22.504775 [info ] [MainThread]: Finished running 4 table models, 3 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m20:04:22.506527 [debug] [MainThread]: Command end result
[0m20:04:22.563026 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:04:22.570552 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:04:22.583502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m20:04:22.584291 [info ] [MainThread]: 
[0m20:04:22.585055 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:04:22.585768 [info ] [MainThread]: 
[0m20:04:22.586566 [error] [MainThread]: [31mFailure in model silver_rockets (models/silver/silver_rockets.sql)[0m
[0m20:04:22.587351 [error] [MainThread]:   Database Error in model silver_rockets (models/silver/silver_rockets.sql)
  relation "raw_rockets" does not exist
  LINE 15: FROM raw_rockets
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_rockets.sql
[0m20:04:22.588125 [info ] [MainThread]: 
[0m20:04:22.588927 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/silver/silver_rockets.sql
[0m20:04:22.589605 [info ] [MainThread]: 
[0m20:04:22.590370 [error] [MainThread]: [31mFailure in model silver_launches (models/silver/silver_launches.sql)[0m
[0m20:04:22.591134 [error] [MainThread]:   Database Error in model silver_launches (models/silver/silver_launches.sql)
  relation "raw_launches" does not exist
  LINE 15: FROM raw_launches
                ^
  compiled code at target/run/spacex_analytics/models/silver/silver_launches.sql
[0m20:04:22.591839 [info ] [MainThread]: 
[0m20:04:22.592586 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/silver/silver_launches.sql
[0m20:04:22.593283 [info ] [MainThread]: 
[0m20:04:22.593989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=5 NO-OP=0 TOTAL=7
[0m20:04:22.596394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9729078, "process_in_blocks": "80", "process_kernel_time": 0.700569, "process_mem_max_rss": "138628", "process_out_blocks": "0", "process_user_time": 8.2387}
[0m20:04:22.597257 [debug] [MainThread]: Command `dbt run` failed at 20:04:22.597116 after 3.97 seconds
[0m20:04:22.597996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e736f05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e719efad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704e71d0c680>]}
[0m20:04:22.598727 [debug] [MainThread]: Flushing usage events
[0m20:04:23.236346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:56.541548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929e509970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929e50a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929e508b60>]}


============================== 20:26:56.610134 | cdcb0645-4417-4317-aed2-6dc4db8c13fa ==============================
[0m20:26:56.610134 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:26:56.611323 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False'}
[0m20:26:56.846620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdcb0645-4417-4317-aed2-6dc4db8c13fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929efd4ef0>]}
[0m20:26:56.915498 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:26:56.924243 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:26:56.927208 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5119795, "process_in_blocks": "1384", "process_kernel_time": 0.511564, "process_mem_max_rss": "124996", "process_out_blocks": "0", "process_user_time": 4.991753}
[0m20:26:56.928061 [debug] [MainThread]: Command `dbt deps` succeeded at 20:26:56.927915 after 0.51 seconds
[0m20:26:56.928778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929f631fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929eb773e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74929e359310>]}
[0m20:26:56.929483 [debug] [MainThread]: Flushing usage events
[0m20:26:57.817504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:03.491589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d646027b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6462ad44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d646080f8c0>]}


============================== 20:27:03.560798 | 42d69b0f-2e2f-4b0a-a341-a8cc3cc10115 ==============================
[0m20:27:03.560798 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:27:03.562011 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'version_check': 'True'}
[0m20:27:03.615349 [info ] [MainThread]: dbt version: 1.11.6
[0m20:27:03.616159 [info ] [MainThread]: python version: 3.12.12
[0m20:27:03.616920 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:27:03.617643 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:27:03.735677 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m20:27:03.736704 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m20:27:03.737481 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:27:03.738571 [info ] [MainThread]: adapter type: postgres
[0m20:27:03.739415 [info ] [MainThread]: adapter version: 1.10.0
[0m20:27:03.927410 [info ] [MainThread]: Configuration:
[0m20:27:03.928402 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:27:03.929223 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:27:03.929997 [info ] [MainThread]: Required dependencies:
[0m20:27:03.930800 [debug] [MainThread]: Executing "git --help"
[0m20:27:03.934377 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:27:03.935411 [debug] [MainThread]: STDERR: "b''"
[0m20:27:03.936123 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:27:03.936856 [info ] [MainThread]: Connection:
[0m20:27:03.937600 [info ] [MainThread]:   host: db
[0m20:27:03.938311 [info ] [MainThread]:   port: 5432
[0m20:27:03.939056 [info ] [MainThread]:   user: postgres
[0m20:27:03.939870 [info ] [MainThread]:   database: spacex_db
[0m20:27:03.940616 [info ] [MainThread]:   schema: analytics
[0m20:27:03.941307 [info ] [MainThread]:   connect_timeout: 10
[0m20:27:03.942005 [info ] [MainThread]:   role: None
[0m20:27:03.942672 [info ] [MainThread]:   search_path: None
[0m20:27:03.943393 [info ] [MainThread]:   keepalives_idle: 0
[0m20:27:03.944056 [info ] [MainThread]:   sslmode: None
[0m20:27:03.944726 [info ] [MainThread]:   sslcert: None
[0m20:27:03.945393 [info ] [MainThread]:   sslkey: None
[0m20:27:03.946085 [info ] [MainThread]:   sslrootcert: None
[0m20:27:03.946747 [info ] [MainThread]:   application_name: dbt
[0m20:27:03.947460 [info ] [MainThread]:   retries: 1
[0m20:27:03.948319 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:27:04.105776 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:27:04.177309 [debug] [MainThread]: Using postgres connection "debug"
[0m20:27:04.178234 [debug] [MainThread]: On debug: select 1 as id
[0m20:27:04.179384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:04.196202 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m20:27:04.197904 [debug] [MainThread]: On debug: Close
[0m20:27:04.198671 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:27:04.199682 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:27:04.201945 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8317937, "process_in_blocks": "56", "process_kernel_time": 0.615155, "process_mem_max_rss": "124972", "process_out_blocks": "0", "process_user_time": 5.26877}
[0m20:27:04.202895 [debug] [MainThread]: Command `dbt debug` succeeded at 20:27:04.202733 after 0.83 seconds
[0m20:27:04.203623 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:27:04.204314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d645fe29400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d645f7017c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d646027b020>]}
[0m20:27:04.205082 [debug] [MainThread]: Flushing usage events
[0m20:27:04.849695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:10.650515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4d940d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d50177cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4d943a40>]}


============================== 20:27:10.718610 | 36e52fde-0aa4-4d67-b76f-66d1926bacc5 ==============================
[0m20:27:10.718610 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:27:10.719705 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False'}
[0m20:27:11.045530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4fc84770>]}
[0m20:27:11.170329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4e17cef0>]}
[0m20:27:11.171935 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:27:11.341232 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:27:11.646807 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 2 files changed.
[0m20:27:11.648220 [debug] [MainThread]: Partial parsing: deleted file: spacex_analytics://models/silver/silver_rockets.sql
[0m20:27:11.649144 [debug] [MainThread]: Partial parsing: deleted file: spacex_analytics://models/silver/silver_launches.sql
[0m20:27:11.650008 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m20:27:11.650821 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_rockets.sql
[0m20:27:12.147615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m20:27:12.171702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4bbb46b0>]}
[0m20:27:12.313098 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:27:12.320014 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:27:12.410663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4b39fb90>]}
[0m20:27:12.411560 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m20:27:12.412242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4cdccc50>]}
[0m20:27:12.415006 [info ] [MainThread]: 
[0m20:27:12.415812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:12.416510 [info ] [MainThread]: 
[0m20:27:12.417423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:12.423322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m20:27:12.505573 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m20:27:12.506633 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m20:27:12.507514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:12.526682 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m20:27:12.529406 [debug] [ThreadPool]: On list_spacex_db: Close
[0m20:27:12.532369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m20:27:12.540682 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m20:27:12.541486 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:27:12.542346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:12.569837 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m20:27:12.572138 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m20:27:12.573136 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m20:27:12.581464 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:12.583061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:27:12.584055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:12.609137 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m20:27:12.611618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d49300fb0>]}
[0m20:27:12.612583 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:12.613599 [debug] [MainThread]: On master: COMMIT
[0m20:27:12.614338 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:12.615113 [debug] [MainThread]: On master: COMMIT
[0m20:27:12.616198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:12.616853 [debug] [MainThread]: On master: Close
[0m20:27:12.624523 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m20:27:12.625304 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m20:27:12.626136 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m20:27:12.627121 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m20:27:12.628100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m20:27:12.629046 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m20:27:12.629901 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m20:27:12.630688 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m20:27:12.641611 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m20:27:12.645362 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m20:27:12.652869 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m20:27:12.665732 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m20:27:12.735362 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m20:27:12.735977 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m20:27:12.743973 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:27:12.744854 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m20:27:12.745669 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:27:12.746557 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:27:12.747635 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m20:27:12.748434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:12.762838 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 10:     id::text AS launch_id,
             ^

[0m20:27:12.763613 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 10:     id::text AS rocket_id,
             ^

[0m20:27:12.764231 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: ROLLBACK
[0m20:27:12.765025 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: ROLLBACK
[0m20:27:12.766246 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m20:27:12.767177 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m20:27:12.778737 [debug] [Thread-1 (]: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 10:     id::text AS launch_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql
[0m20:27:12.780919 [debug] [Thread-2 (]: Database Error in model stg_rockets (models/staging/stg_rockets.sql)
  column "id" does not exist
  LINE 10:     id::text AS rocket_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_rockets.sql
[0m20:27:12.783742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d49242a20>]}
[0m20:27:12.784547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e52fde-0aa4-4d67-b76f-66d1926bacc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d49215820>]}
[0m20:27:12.786002 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model analytics.stg_launches .................... [[31mERROR[0m in 0.15s]
[0m20:27:12.787269 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model analytics.stg_rockets ..................... [[31mERROR[0m in 0.16s]
[0m20:27:12.788628 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m20:27:12.789698 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m20:27:12.790903 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.stg_launches' to be skipped because of status 'error'.  Reason: Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 10:     id::text AS launch_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql.
[0m20:27:12.793146 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.stg_rockets' to be skipped because of status 'error'.  Reason: Database Error in model stg_rockets (models/staging/stg_rockets.sql)
  column "id" does not exist
  LINE 10:     id::text AS rocket_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_rockets.sql.
[0m20:27:12.794909 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m20:27:12.795918 [info ] [Thread-4 (]: 3 of 5 SKIP relation analytics.dim_rockets ..................................... [[33mSKIP[0m]
[0m20:27:12.796771 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m20:27:12.798162 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m20:27:12.799093 [info ] [Thread-1 (]: 4 of 5 SKIP relation analytics.fct_launches .................................... [[33mSKIP[0m]
[0m20:27:12.800138 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m20:27:12.802321 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m20:27:12.803491 [info ] [Thread-3 (]: 5 of 5 SKIP relation analytics.gold_rocket_performance ......................... [[33mSKIP[0m]
[0m20:27:12.804453 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m20:27:12.807340 [debug] [MainThread]: On master: COMMIT
[0m20:27:12.808093 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:12.808746 [debug] [MainThread]: On master: COMMIT
[0m20:27:12.809391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:12.822875 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m20:27:12.823845 [debug] [MainThread]: On master: Close
[0m20:27:12.824954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:12.825745 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_launches' was properly closed.
[0m20:27:12.826423 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m20:27:12.827247 [info ] [MainThread]: 
[0m20:27:12.827990 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m20:27:12.829522 [debug] [MainThread]: Command end result
[0m20:27:12.877402 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:27:12.883475 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:27:12.895454 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m20:27:12.896188 [info ] [MainThread]: 
[0m20:27:12.896910 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:27:12.897579 [info ] [MainThread]: 
[0m20:27:12.898375 [error] [MainThread]: [31mFailure in model stg_launches (models/staging/stg_launches.sql)[0m
[0m20:27:12.899169 [error] [MainThread]:   Database Error in model stg_launches (models/staging/stg_launches.sql)
  column "id" does not exist
  LINE 10:     id::text AS launch_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_launches.sql
[0m20:27:12.899788 [info ] [MainThread]: 
[0m20:27:12.900485 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/staging/stg_launches.sql
[0m20:27:12.901107 [info ] [MainThread]: 
[0m20:27:12.901884 [error] [MainThread]: [31mFailure in model stg_rockets (models/staging/stg_rockets.sql)[0m
[0m20:27:12.902606 [error] [MainThread]:   Database Error in model stg_rockets (models/staging/stg_rockets.sql)
  column "id" does not exist
  LINE 10:     id::text AS rocket_id,
               ^
  compiled code at target/run/spacex_analytics/models/staging/stg_rockets.sql
[0m20:27:12.903235 [info ] [MainThread]: 
[0m20:27:12.903933 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/staging/stg_rockets.sql
[0m20:27:12.904640 [info ] [MainThread]: 
[0m20:27:12.905451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=5
[0m20:27:12.907831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3810506, "process_in_blocks": "80", "process_kernel_time": 0.629844, "process_mem_max_rss": "137908", "process_out_blocks": "0", "process_user_time": 6.585462}
[0m20:27:12.908826 [debug] [MainThread]: Command `dbt run` failed at 20:27:12.908662 after 2.38 seconds
[0m20:27:12.909559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d4d6ce0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d51836c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d51836c30>]}
[0m20:27:12.910259 [debug] [MainThread]: Flushing usage events
[0m20:27:13.562792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:29.802898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d5ee4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d5ee7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d5fbcc20>]}


============================== 20:40:29.881238 | a60c471e-690e-4c8f-b1ac-d5a7fd127b8d ==============================
[0m20:40:29.881238 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:40:29.882660 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'empty': 'None', 'log_path': '/app/dbt/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None'}
[0m20:40:30.123050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60c471e-690e-4c8f-b1ac-d5a7fd127b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d579a9f0>]}
[0m20:40:30.190173 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:40:30.198300 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:40:30.200880 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52295446, "process_in_blocks": "0", "process_kernel_time": 0.576173, "process_mem_max_rss": "124676", "process_out_blocks": "0", "process_user_time": 4.881465}
[0m20:40:30.201745 [debug] [MainThread]: Command `dbt deps` succeeded at 20:40:30.201600 after 0.52 seconds
[0m20:40:30.202482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d5a847a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d82208f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7363d579a9f0>]}
[0m20:40:30.203211 [debug] [MainThread]: Flushing usage events
[0m20:40:30.862819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:36.689109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7aeb47d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7afc4b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7aeb478c0>]}


============================== 20:40:36.759523 | b488283c-859b-4c32-989d-caf5ee55e2db ==============================
[0m20:40:36.759523 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:40:36.760624 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app/dbt'}
[0m20:40:36.815734 [info ] [MainThread]: dbt version: 1.11.6
[0m20:40:36.816737 [info ] [MainThread]: python version: 3.12.12
[0m20:40:36.817563 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:40:36.818372 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:40:36.922764 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m20:40:36.923788 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m20:40:36.924960 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:40:36.926507 [info ] [MainThread]: adapter type: postgres
[0m20:40:36.927503 [info ] [MainThread]: adapter version: 1.10.0
[0m20:40:37.119431 [info ] [MainThread]: Configuration:
[0m20:40:37.120491 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:37.121435 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:37.122320 [info ] [MainThread]: Required dependencies:
[0m20:40:37.123146 [debug] [MainThread]: Executing "git --help"
[0m20:40:37.126684 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:37.127696 [debug] [MainThread]: STDERR: "b''"
[0m20:40:37.128397 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:37.129283 [info ] [MainThread]: Connection:
[0m20:40:37.130411 [info ] [MainThread]:   host: db
[0m20:40:37.131439 [info ] [MainThread]:   port: 5432
[0m20:40:37.132414 [info ] [MainThread]:   user: postgres
[0m20:40:37.133284 [info ] [MainThread]:   database: spacex_db
[0m20:40:37.134109 [info ] [MainThread]:   schema: analytics
[0m20:40:37.134963 [info ] [MainThread]:   connect_timeout: 10
[0m20:40:37.135738 [info ] [MainThread]:   role: None
[0m20:40:37.136479 [info ] [MainThread]:   search_path: None
[0m20:40:37.137186 [info ] [MainThread]:   keepalives_idle: 0
[0m20:40:37.137931 [info ] [MainThread]:   sslmode: None
[0m20:40:37.138621 [info ] [MainThread]:   sslcert: None
[0m20:40:37.139345 [info ] [MainThread]:   sslkey: None
[0m20:40:37.140013 [info ] [MainThread]:   sslrootcert: None
[0m20:40:37.140796 [info ] [MainThread]:   application_name: dbt
[0m20:40:37.141550 [info ] [MainThread]:   retries: 1
[0m20:40:37.142845 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:40:37.298721 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:40:37.371379 [debug] [MainThread]: Using postgres connection "debug"
[0m20:40:37.372174 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:37.372897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:37.389657 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m20:40:37.391317 [debug] [MainThread]: On debug: Close
[0m20:40:37.392078 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:37.392894 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:37.395127 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.82837814, "process_in_blocks": "0", "process_kernel_time": 0.661684, "process_mem_max_rss": "124540", "process_out_blocks": "0", "process_user_time": 5.345609}
[0m20:40:37.396067 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:37.395907 after 0.83 seconds
[0m20:40:37.396796 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:37.397428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7b1d0bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7b09da870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a7af3a6e70>]}
[0m20:40:37.398246 [debug] [MainThread]: Flushing usage events
[0m20:40:38.044493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:43.836215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6eb378950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ec0fdb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ebc76900>]}


============================== 20:40:43.909114 | 9cdd9f6b-07c7-4478-9964-ec37c30275d7 ==============================
[0m20:40:43.909114 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:40:43.910137 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m20:40:44.227388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6eb1d7d40>]}
[0m20:40:44.350024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ebcd71d0>]}
[0m20:40:44.352398 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:40:44.529092 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:40:44.835486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:40:44.836597 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_rockets.sql
[0m20:40:44.837393 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m20:40:45.307614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m20:40:45.331174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6eae2c380>]}
[0m20:40:45.484691 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:40:45.490799 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:40:45.576820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e9d9f410>]}
[0m20:40:45.577848 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m20:40:45.578730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e9daa630>]}
[0m20:40:45.581999 [info ] [MainThread]: 
[0m20:40:45.582799 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:45.583476 [info ] [MainThread]: 
[0m20:40:45.584406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:45.590440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m20:40:45.672933 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m20:40:45.673953 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m20:40:45.674738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:45.694210 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m20:40:45.696369 [debug] [ThreadPool]: On list_spacex_db: Close
[0m20:40:45.698999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m20:40:45.707218 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m20:40:45.708070 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:40:45.708836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:45.734325 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m20:40:45.736532 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m20:40:45.737567 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m20:40:45.745117 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:45.746320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:40:45.747250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:45.774078 [debug] [MainThread]: SQL status: SELECT 4 in 0.027 seconds
[0m20:40:45.776397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e8d05460>]}
[0m20:40:45.777388 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:45.778494 [debug] [MainThread]: On master: COMMIT
[0m20:40:45.779286 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:45.780033 [debug] [MainThread]: On master: COMMIT
[0m20:40:45.781336 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:40:45.782093 [debug] [MainThread]: On master: Close
[0m20:40:45.789027 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m20:40:45.789822 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m20:40:45.790748 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m20:40:45.791814 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m20:40:45.792708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m20:40:45.793601 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m20:40:45.794514 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m20:40:45.795258 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m20:40:45.809994 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m20:40:45.806261 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m20:40:45.817143 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m20:40:45.828209 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m20:40:45.902736 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m20:40:45.903556 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m20:40:45.911789 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:40:45.912645 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:40:45.913276 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m20:40:45.914122 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m20:40:45.914975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:45.915753 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:40:45.944403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m20:40:45.945088 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m20:40:45.955041 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:40:45.961027 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:40:45.961683 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m20:40:45.962661 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m20:40:45.965427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:40:45.966069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:40:45.971201 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:40:45.976096 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:40:45.977265 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m20:40:45.978249 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m20:40:45.980340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:45.981067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:46.019231 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m20:40:46.020905 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m20:40:46.021490 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:40:46.022716 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:40:46.023610 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m20:40:46.024518 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m20:40:46.028272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:40:46.034519 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m20:40:46.038293 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m20:40:46.041428 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m20:40:46.051802 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:40:46.052954 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:40:46.054011 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m20:40:46.055015 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m20:40:46.064207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m20:40:46.067936 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m20:40:46.068528 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m20:40:46.072563 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m20:40:46.073579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ee04deb0>]}
[0m20:40:46.074485 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e89397c0>]}
[0m20:40:46.075411 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m20:40:46.076598 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m20:40:46.077764 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m20:40:46.078935 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m20:40:46.081644 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m20:40:46.082849 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m20:40:46.084222 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m20:40:46.085238 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m20:40:46.089931 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m20:40:46.106404 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m20:40:46.137487 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m20:40:46.152705 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:40:46.153506 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m20:40:46.154301 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:40:46.181236 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.027 seconds
[0m20:40:46.191015 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:40:46.192444 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m20:40:46.194818 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:46.199531 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:40:46.200408 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m20:40:46.202063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:46.204284 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m20:40:46.205099 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:40:46.206158 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m20:40:46.209256 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:46.214660 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m20:40:46.219560 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:40:46.220509 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m20:40:46.227765 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:40:46.230200 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m20:40:46.231341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e89eb860>]}
[0m20:40:46.232633 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.15s]
[0m20:40:46.234096 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m20:40:46.235918 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m20:40:46.236857 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m20:40:46.237921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m20:40:46.238682 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m20:40:46.323234 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m20:40:46.338532 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m20:40:46.343624 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m20:40:46.359202 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:40:46.360065 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_name,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m20:40:46.360904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:46.388055 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.027 seconds
[0m20:40:46.392981 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:40:46.394007 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m20:40:46.396153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:46.401054 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:40:46.402165 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m20:40:46.403867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:40:46.406276 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m20:40:46.407117 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:40:46.407968 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m20:40:46.410864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:40:46.415153 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m20:40:46.416721 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:40:46.417535 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m20:40:46.424431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:40:46.426781 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m20:40:46.427948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ea51f260>]}
[0m20:40:46.429102 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.19s]
[0m20:40:46.430369 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m20:40:46.431944 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m20:40:46.432961 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m20:40:46.434075 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m20:40:46.434838 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m20:40:46.439542 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m20:40:46.450198 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m20:40:46.455308 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m20:40:46.465675 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m20:40:46.466641 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m20:40:46.467485 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:46.483951 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column l.rocket_id does not exist
LINE 33:     ON r.rocket_id = l.rocket_id
                              ^
HINT:  Perhaps you meant to reference the column "r.rocket_id".

[0m20:40:46.485306 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: ROLLBACK
[0m20:40:46.486621 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m20:40:46.492224 [debug] [Thread-3 (]: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column l.rocket_id does not exist
  LINE 33:     ON r.rocket_id = l.rocket_id
                                ^
  HINT:  Perhaps you meant to reference the column "r.rocket_id".
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m20:40:46.493342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdd9f6b-07c7-4478-9964-ec37c30275d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6e8101820>]}
[0m20:40:46.494483 [error] [Thread-3 (]: 5 of 5 ERROR creating sql view model analytics.gold_rocket_performance ......... [[31mERROR[0m in 0.06s]
[0m20:40:46.495960 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m20:40:46.497224 [debug] [Thread-7 (]: Marking all children of 'model.spacex_analytics.gold_rocket_performance' to be skipped because of status 'error'.  Reason: Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column l.rocket_id does not exist
  LINE 33:     ON r.rocket_id = l.rocket_id
                                ^
  HINT:  Perhaps you meant to reference the column "r.rocket_id".
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql.
[0m20:40:46.497514 [debug] [MainThread]: On master: COMMIT
[0m20:40:46.501059 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:46.502190 [debug] [MainThread]: On master: COMMIT
[0m20:40:46.502949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:46.517649 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m20:40:46.518612 [debug] [MainThread]: On master: Close
[0m20:40:46.519540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:46.520287 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m20:40:46.521007 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m20:40:46.521753 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m20:40:46.522379 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m20:40:46.523225 [info ] [MainThread]: 
[0m20:40:46.523987 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m20:40:46.526370 [debug] [MainThread]: Command end result
[0m20:40:46.576012 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:40:46.582637 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:40:46.596822 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m20:40:46.597632 [info ] [MainThread]: 
[0m20:40:46.598428 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:40:46.599172 [info ] [MainThread]: 
[0m20:40:46.600007 [error] [MainThread]: [31mFailure in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)[0m
[0m20:40:46.600816 [error] [MainThread]:   Database Error in model gold_rocket_performance (models/gold/gold_rocket_performance.sql)
  column l.rocket_id does not exist
  LINE 33:     ON r.rocket_id = l.rocket_id
                                ^
  HINT:  Perhaps you meant to reference the column "r.rocket_id".
  compiled code at target/run/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m20:40:46.601489 [info ] [MainThread]: 
[0m20:40:46.602310 [info ] [MainThread]:   compiled code at target/compiled/spacex_analytics/models/gold/gold_rocket_performance.sql
[0m20:40:46.603032 [info ] [MainThread]: 
[0m20:40:46.603832 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m20:40:46.605892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.903083, "process_in_blocks": "0", "process_kernel_time": 0.717384, "process_mem_max_rss": "138848", "process_out_blocks": "0", "process_user_time": 6.890875}
[0m20:40:46.606835 [debug] [MainThread]: Command `dbt run` failed at 20:40:46.606669 after 2.90 seconds
[0m20:40:46.607576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6eb9e2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ebc76900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c6ec527b90>]}
[0m20:40:46.608255 [debug] [MainThread]: Flushing usage events
[0m20:40:47.238148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:10.784863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7eddb05640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7edeec83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ede673830>]}


============================== 20:58:10.856178 | 61b00c81-0110-4533-80d5-2dd9b89f0ff7 ==============================
[0m20:58:10.856178 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:58:10.857284 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None'}
[0m20:58:11.105880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b00c81-0110-4533-80d5-2dd9b89f0ff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ede2568a0>]}
[0m20:58:11.179277 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:58:11.187531 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:58:11.190041 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5268621, "process_in_blocks": "1384", "process_kernel_time": 0.518856, "process_mem_max_rss": "124616", "process_out_blocks": "0", "process_user_time": 4.925143}
[0m20:58:11.190893 [debug] [MainThread]: Command `dbt deps` succeeded at 20:58:11.190749 after 0.53 seconds
[0m20:58:11.191590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7edf790320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7eddb039b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7ede673830>]}
[0m20:58:11.192356 [debug] [MainThread]: Flushing usage events
[0m20:58:11.941927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:17.599088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374cf4c6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374ced18950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374ced1b350>]}


============================== 20:58:17.666287 | 69d477e9-2837-4f41-8fbc-7b066f6fdc44 ==============================
[0m20:58:17.666287 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:58:17.667326 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m20:58:17.722485 [info ] [MainThread]: dbt version: 1.11.6
[0m20:58:17.723357 [info ] [MainThread]: python version: 3.12.12
[0m20:58:17.724082 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:58:17.724865 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m20:58:17.826469 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m20:58:17.827664 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m20:58:17.828396 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m20:58:17.829471 [info ] [MainThread]: adapter type: postgres
[0m20:58:17.830231 [info ] [MainThread]: adapter version: 1.10.0
[0m20:58:18.023646 [info ] [MainThread]: Configuration:
[0m20:58:18.024665 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:58:18.025420 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:58:18.026218 [info ] [MainThread]: Required dependencies:
[0m20:58:18.026979 [debug] [MainThread]: Executing "git --help"
[0m20:58:18.030635 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:58:18.031574 [debug] [MainThread]: STDERR: "b''"
[0m20:58:18.032236 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:58:18.032901 [info ] [MainThread]: Connection:
[0m20:58:18.033903 [info ] [MainThread]:   host: db
[0m20:58:18.034793 [info ] [MainThread]:   port: 5432
[0m20:58:18.035546 [info ] [MainThread]:   user: postgres
[0m20:58:18.036282 [info ] [MainThread]:   database: spacex_db
[0m20:58:18.037111 [info ] [MainThread]:   schema: analytics
[0m20:58:18.037796 [info ] [MainThread]:   connect_timeout: 10
[0m20:58:18.038516 [info ] [MainThread]:   role: None
[0m20:58:18.039194 [info ] [MainThread]:   search_path: None
[0m20:58:18.039894 [info ] [MainThread]:   keepalives_idle: 0
[0m20:58:18.040573 [info ] [MainThread]:   sslmode: None
[0m20:58:18.041243 [info ] [MainThread]:   sslcert: None
[0m20:58:18.042070 [info ] [MainThread]:   sslkey: None
[0m20:58:18.042747 [info ] [MainThread]:   sslrootcert: None
[0m20:58:18.043399 [info ] [MainThread]:   application_name: dbt
[0m20:58:18.044108 [info ] [MainThread]:   retries: 1
[0m20:58:18.045005 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:58:18.208033 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:58:18.280957 [debug] [MainThread]: Using postgres connection "debug"
[0m20:58:18.281959 [debug] [MainThread]: On debug: select 1 as id
[0m20:58:18.282644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:18.299775 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m20:58:18.301410 [debug] [MainThread]: On debug: Close
[0m20:58:18.302274 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:58:18.305386 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:58:18.308257 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.82892984, "process_in_blocks": "56", "process_kernel_time": 0.647964, "process_mem_max_rss": "124452", "process_out_blocks": "0", "process_user_time": 5.219711}
[0m20:58:18.309344 [debug] [MainThread]: Command `dbt debug` succeeded at 20:58:18.309175 after 0.83 seconds
[0m20:58:18.310336 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:58:18.311035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374cebf5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374ce1812e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7374ce5ca270>]}
[0m20:58:18.311788 [debug] [MainThread]: Flushing usage events
[0m20:58:18.954763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:24.641937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2e961730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2e960a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2e961940>]}


============================== 20:58:24.710035 | 619b18bd-aba3-4248-b4d5-89673eb15860 ==============================
[0m20:58:24.710035 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:58:24.711080 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None'}
[0m20:58:25.046807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f31614890>]}
[0m20:58:25.168321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2ee6c0b0>]}
[0m20:58:25.169983 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:58:25.336945 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:58:25.648837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:58:25.650076 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/staging/stg_launches.sql
[0m20:58:25.650943 [debug] [MainThread]: Partial parsing: updated file: spacex_analytics://models/fct/fct_launches.sql
[0m20:58:26.138204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m20:58:26.160757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2d3de570>]}
[0m20:58:26.306739 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:58:26.313975 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:58:26.401927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2d3a7230>]}
[0m20:58:26.402796 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m20:58:26.403477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2d394ec0>]}
[0m20:58:26.406638 [info ] [MainThread]: 
[0m20:58:26.407722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:26.408482 [info ] [MainThread]: 
[0m20:58:26.409451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:26.415394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m20:58:26.496672 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m20:58:26.497624 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m20:58:26.498466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:26.518175 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m20:58:26.520419 [debug] [ThreadPool]: On list_spacex_db: Close
[0m20:58:26.523063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m20:58:26.531440 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m20:58:26.532345 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:58:26.533154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:26.562107 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m20:58:26.564464 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m20:58:26.565409 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m20:58:26.572845 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:26.573910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:58:26.574732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:26.600136 [debug] [MainThread]: SQL status: SELECT 4 in 0.025 seconds
[0m20:58:26.602462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2c301670>]}
[0m20:58:26.603351 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:26.604427 [debug] [MainThread]: On master: COMMIT
[0m20:58:26.605172 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:26.606003 [debug] [MainThread]: On master: COMMIT
[0m20:58:26.607098 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:26.607836 [debug] [MainThread]: On master: Close
[0m20:58:26.615662 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m20:58:26.616417 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m20:58:26.617200 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m20:58:26.618355 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m20:58:26.619309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m20:58:26.620289 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m20:58:26.621141 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m20:58:26.621935 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m20:58:26.636741 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m20:58:26.637682 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m20:58:26.644518 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m20:58:26.651196 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m20:58:26.734810 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m20:58:26.735715 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m20:58:26.743275 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:58:26.744165 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m20:58:26.745009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:58:26.745773 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:58:26.747050 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m20:58:26.747814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:26.774921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m20:58:26.775704 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m20:58:26.786016 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:58:26.789996 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:58:26.791135 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m20:58:26.792341 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m20:58:26.794736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:26.795387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:26.799667 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:58:26.803626 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:58:26.804594 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m20:58:26.805806 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m20:58:26.807662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:26.808210 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:26.847023 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m20:58:26.847627 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m20:58:26.848243 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:58:26.849181 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:58:26.850231 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m20:58:26.851192 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m20:58:26.854664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:58:26.861096 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m20:58:26.864758 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m20:58:26.867958 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m20:58:26.877144 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m20:58:26.878141 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m20:58:26.879109 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m20:58:26.880071 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m20:58:26.890270 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m20:58:26.891226 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m20:58:26.894621 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m20:58:26.896727 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m20:58:26.899517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f31636330>]}
[0m20:58:26.901702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2bf8b290>]}
[0m20:58:26.902729 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m20:58:26.904151 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m20:58:26.905390 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m20:58:26.906663 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m20:58:26.908221 [debug] [Thread-1 (]: Began running node model.spacex_analytics.dim_rockets
[0m20:58:26.909273 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m20:58:26.910244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.dim_rockets)
[0m20:58:26.910997 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m20:58:26.915126 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m20:58:26.925119 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.dim_rockets
[0m20:58:26.955914 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m20:58:26.966228 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:58:26.967002 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m20:58:26.967786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:26.994871 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.027 seconds
[0m20:58:27.003992 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:58:27.005031 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m20:58:27.006848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:27.012734 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:58:27.013766 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m20:58:27.015541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:27.017883 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m20:58:27.018736 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:58:27.019556 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m20:58:27.022648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:58:27.103317 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m20:58:27.110823 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m20:58:27.111963 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m20:58:27.118999 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:58:27.121310 [debug] [Thread-1 (]: On model.spacex_analytics.dim_rockets: Close
[0m20:58:27.122541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2bfeab70>]}
[0m20:58:27.123756 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.21s]
[0m20:58:27.125008 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.dim_rockets
[0m20:58:27.126753 [debug] [Thread-3 (]: Began running node model.spacex_analytics.fct_launches
[0m20:58:27.127831 [info ] [Thread-3 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m20:58:27.128913 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.fct_launches'
[0m20:58:27.129689 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.fct_launches
[0m20:58:27.134616 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m20:58:27.144631 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.fct_launches
[0m20:58:27.149925 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m20:58:27.160272 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:58:27.161140 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m20:58:27.161918 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:27.189658 [debug] [Thread-3 (]: SQL status: SELECT 205 in 0.028 seconds
[0m20:58:27.194538 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:58:27.195421 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m20:58:27.197185 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:27.201333 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:58:27.202248 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m20:58:27.203883 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:27.206319 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m20:58:27.207279 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:58:27.208078 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m20:58:27.210695 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:58:27.214816 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m20:58:27.216457 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m20:58:27.217338 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m20:58:27.223964 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m20:58:27.226283 [debug] [Thread-3 (]: On model.spacex_analytics.fct_launches: Close
[0m20:58:27.227440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2e4b7260>]}
[0m20:58:27.230389 [info ] [Thread-3 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m20:58:27.232119 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.fct_launches
[0m20:58:27.234346 [debug] [Thread-4 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m20:58:27.235442 [info ] [Thread-4 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m20:58:27.236514 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m20:58:27.237328 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m20:58:27.242037 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.252602 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m20:58:27.257352 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.268162 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.269052 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m20:58:27.269926 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:27.296462 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m20:58:27.302240 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.303209 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m20:58:27.305310 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:27.307732 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m20:58:27.308926 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.310095 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m20:58:27.314019 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:58:27.320364 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m20:58:27.321903 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m20:58:27.322874 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m20:58:27.324982 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:58:27.327144 [debug] [Thread-4 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m20:58:27.328244 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619b18bd-aba3-4248-b4d5-89673eb15860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2bf8b890>]}
[0m20:58:27.329398 [info ] [Thread-4 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.09s]
[0m20:58:27.330636 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m20:58:27.333860 [debug] [MainThread]: On master: COMMIT
[0m20:58:27.334616 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:27.335316 [debug] [MainThread]: On master: COMMIT
[0m20:58:27.335940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:27.349296 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m20:58:27.350310 [debug] [MainThread]: On master: Close
[0m20:58:27.351259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:27.351960 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m20:58:27.352631 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m20:58:27.353288 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m20:58:27.354139 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m20:58:27.354980 [info ] [MainThread]: 
[0m20:58:27.355847 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m20:58:27.358338 [debug] [MainThread]: Command end result
[0m20:58:27.406703 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:58:27.413908 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:58:27.426710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m20:58:27.427389 [info ] [MainThread]: 
[0m20:58:27.428126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:27.428790 [info ] [MainThread]: 
[0m20:58:27.429495 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m20:58:27.431479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.918978, "process_in_blocks": "80", "process_kernel_time": 0.706179, "process_mem_max_rss": "138112", "process_out_blocks": "0", "process_user_time": 6.79546}
[0m20:58:27.432283 [debug] [MainThread]: Command `dbt run` succeeded at 20:58:27.432152 after 2.92 seconds
[0m20:58:27.433001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f331c2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2bfc1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f2bfc1610>]}
[0m20:58:27.433734 [debug] [MainThread]: Flushing usage events
[0m20:58:28.196426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:34.209893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd421d0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd421d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd421d0b00>]}


============================== 20:58:34.311665 | 5aea4bec-93fc-45ad-908f-334c1baea8b4 ==============================
[0m20:58:34.311665 [info ] [MainThread]: Running with dbt=1.11.6
[0m20:58:34.312834 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m20:58:34.692963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd426e8200>]}
[0m20:58:34.815392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd43f72a20>]}
[0m20:58:34.816929 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m20:58:34.984811 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m20:58:35.287964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:35.288906 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:58:35.289715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:35.299009 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m20:58:35.360298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd42a1ca70>]}
[0m20:58:35.504629 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:58:35.511751 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:58:35.785927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd40df8ef0>]}
[0m20:58:35.786847 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m20:58:35.787591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd43567d40>]}
[0m20:58:35.790468 [info ] [MainThread]: 
[0m20:58:35.791222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:35.791945 [info ] [MainThread]: 
[0m20:58:35.792929 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:35.798879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m20:58:35.880025 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m20:58:35.881026 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:58:35.882521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:35.908971 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m20:58:35.911543 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m20:58:35.912953 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m20:58:35.921070 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:35.922331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:58:35.923238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:35.950189 [debug] [MainThread]: SQL status: SELECT 6 in 0.027 seconds
[0m20:58:35.953133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aea4bec-93fc-45ad-908f-334c1baea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd40dd86b0>]}
[0m20:58:35.954030 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:35.955089 [debug] [MainThread]: On master: COMMIT
[0m20:58:35.955914 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:35.956667 [debug] [MainThread]: On master: COMMIT
[0m20:58:35.957931 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:58:35.958718 [debug] [MainThread]: On master: Close
[0m20:58:35.965944 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m20:58:35.966721 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m20:58:35.967335 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m20:58:35.968406 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m20:58:35.967917 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m20:58:35.969325 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m20:58:35.970281 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m20:58:35.971114 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m20:58:35.972092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m20:58:35.973049 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m20:58:35.974065 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m20:58:35.975295 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m20:58:35.976290 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m20:58:35.977449 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m20:58:35.978627 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m20:58:35.979529 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m20:58:36.015407 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m20:58:36.012185 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m20:58:36.018299 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m20:58:36.023407 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m20:58:36.036062 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m20:58:36.060116 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m20:58:36.066486 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m20:58:36.067123 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m20:58:36.073137 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m20:58:36.075100 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m20:58:36.078466 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m20:58:36.081820 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m20:58:36.094382 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m20:58:36.095368 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:36.096506 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:58:36.097826 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m20:58:36.098551 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m20:58:36.099395 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:36.100198 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m20:58:36.100916 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:36.101877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:36.105955 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:36.106879 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:36.108379 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:36.118016 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m20:58:36.124229 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m20:58:36.125584 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m20:58:36.126877 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.15s]
[0m20:58:36.128753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m20:58:36.129446 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m20:58:36.130650 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m20:58:36.133044 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m20:58:36.133896 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m20:58:36.135734 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m20:58:36.137503 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m20:58:36.139411 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m20:58:36.140533 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m20:58:36.141619 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.17s]
[0m20:58:36.144375 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m20:58:36.143406 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.17s]
[0m20:58:36.142454 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m20:58:36.146104 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m20:58:36.147430 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.17s]
[0m20:58:36.148862 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m20:58:36.151781 [debug] [MainThread]: On master: COMMIT
[0m20:58:36.152547 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:36.153176 [debug] [MainThread]: On master: COMMIT
[0m20:58:36.153772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:36.167809 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m20:58:36.168809 [debug] [MainThread]: On master: Close
[0m20:58:36.169854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:36.170557 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m20:58:36.171261 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m20:58:36.171923 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m20:58:36.172567 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m20:58:36.173275 [info ] [MainThread]: 
[0m20:58:36.174039 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:58:36.176057 [debug] [MainThread]: Command end result
[0m20:58:36.222794 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m20:58:36.230691 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m20:58:36.246435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m20:58:36.247226 [info ] [MainThread]: 
[0m20:58:36.248070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:36.248800 [info ] [MainThread]: 
[0m20:58:36.249592 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:58:36.251650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.2124426, "process_in_blocks": "0", "process_kernel_time": 0.766868, "process_mem_max_rss": "161536", "process_out_blocks": "0", "process_user_time": 6.46418}
[0m20:58:36.252524 [debug] [MainThread]: Command `dbt test` succeeded at 20:58:36.252344 after 2.21 seconds
[0m20:58:36.253240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd421d3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd3f9e71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd4283b3e0>]}
[0m20:58:36.253962 [debug] [MainThread]: Flushing usage events
[0m20:58:37.013425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:57.006082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6ada86e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6ace280b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6ada86ed0>]}


============================== 21:58:57.080566 | 07a832d7-bc1b-4e7c-9572-3ab58a8632bd ==============================
[0m21:58:57.080566 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:58:57.081753 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'empty': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m21:58:57.372433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07a832d7-bc1b-4e7c-9572-3ab58a8632bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6acf31b20>]}
[0m21:58:57.454507 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:58:57.462695 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:58:57.465388 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5856586, "process_in_blocks": "28608", "process_kernel_time": 0.46562, "process_mem_max_rss": "124576", "process_out_blocks": "0", "process_user_time": 5.161965}
[0m21:58:57.466330 [debug] [MainThread]: Command `dbt deps` succeeded at 21:58:57.466153 after 0.59 seconds
[0m21:58:57.467059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6ad351280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6ace49700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a6acf31b20>]}
[0m21:58:57.467816 [debug] [MainThread]: Flushing usage events
[0m21:58:58.110458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:03.744228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5b4a6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5d3bab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5ad390a0>]}


============================== 21:59:03.811927 | 6f6d4165-189d-4a3e-85ba-6f2e0d326098 ==============================
[0m21:59:03.811927 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:59:03.813143 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'empty': 'None', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt debug'}
[0m21:59:03.868860 [info ] [MainThread]: dbt version: 1.11.6
[0m21:59:03.869789 [info ] [MainThread]: python version: 3.12.12
[0m21:59:03.870628 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:59:03.871415 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m21:59:04.004223 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m21:59:04.005274 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m21:59:04.006286 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m21:59:04.007985 [info ] [MainThread]: adapter type: postgres
[0m21:59:04.008805 [info ] [MainThread]: adapter version: 1.10.0
[0m21:59:04.197821 [info ] [MainThread]: Configuration:
[0m21:59:04.198930 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:59:04.199746 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:59:04.200569 [info ] [MainThread]: Required dependencies:
[0m21:59:04.201403 [debug] [MainThread]: Executing "git --help"
[0m21:59:04.215716 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:59:04.216618 [debug] [MainThread]: STDERR: "b''"
[0m21:59:04.217381 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:59:04.218107 [info ] [MainThread]: Connection:
[0m21:59:04.218904 [info ] [MainThread]:   host: db
[0m21:59:04.219598 [info ] [MainThread]:   port: 5432
[0m21:59:04.220281 [info ] [MainThread]:   user: postgres
[0m21:59:04.221026 [info ] [MainThread]:   database: spacex_db
[0m21:59:04.221715 [info ] [MainThread]:   schema: analytics
[0m21:59:04.222445 [info ] [MainThread]:   connect_timeout: 10
[0m21:59:04.223136 [info ] [MainThread]:   role: None
[0m21:59:04.223816 [info ] [MainThread]:   search_path: None
[0m21:59:04.224497 [info ] [MainThread]:   keepalives_idle: 0
[0m21:59:04.225171 [info ] [MainThread]:   sslmode: None
[0m21:59:04.225875 [info ] [MainThread]:   sslcert: None
[0m21:59:04.226621 [info ] [MainThread]:   sslkey: None
[0m21:59:04.227298 [info ] [MainThread]:   sslrootcert: None
[0m21:59:04.227946 [info ] [MainThread]:   application_name: dbt
[0m21:59:04.228644 [info ] [MainThread]:   retries: 1
[0m21:59:04.229513 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:59:04.376960 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:59:04.456388 [debug] [MainThread]: Using postgres connection "debug"
[0m21:59:04.457158 [debug] [MainThread]: On debug: select 1 as id
[0m21:59:04.457778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:04.488846 [debug] [MainThread]: SQL status: SELECT 1 in 0.031 seconds
[0m21:59:04.490649 [debug] [MainThread]: On debug: Close
[0m21:59:04.491448 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:59:04.492221 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:59:04.494409 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.88162404, "process_in_blocks": "19432", "process_kernel_time": 0.641252, "process_mem_max_rss": "124724", "process_out_blocks": "0", "process_user_time": 5.185779}
[0m21:59:04.495298 [debug] [MainThread]: Command `dbt debug` succeeded at 21:59:04.495150 after 0.88 seconds
[0m21:59:04.495930 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:59:04.496581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5b3c7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c5b3c70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c59127bc0>]}
[0m21:59:04.497327 [debug] [MainThread]: Flushing usage events
[0m21:59:05.135051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:10.848873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cecdcd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ced39bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cecdcdb50>]}


============================== 21:59:10.919144 | d26f47c4-d8f9-4323-bd22-807328858b60 ==============================
[0m21:59:10.919144 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:59:10.920303 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'empty': 'False'}
[0m21:59:11.249492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ceccc3920>]}
[0m21:59:11.369041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ced78c530>]}
[0m21:59:11.370787 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:59:11.536822 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:59:11.887580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:59:11.888586 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:59:11.889280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:59:11.898455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m21:59:11.958836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ceccc2330>]}
[0m21:59:12.117567 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:59:12.126372 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:59:12.216584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ceb9ef950>]}
[0m21:59:12.217496 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m21:59:12.218228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ceb9cf920>]}
[0m21:59:12.220922 [info ] [MainThread]: 
[0m21:59:12.222610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:59:12.223334 [info ] [MainThread]: 
[0m21:59:12.224264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:12.230081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m21:59:12.315090 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m21:59:12.316115 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m21:59:12.317027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:12.335725 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m21:59:12.337885 [debug] [ThreadPool]: On list_spacex_db: Close
[0m21:59:12.340585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m21:59:12.349327 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m21:59:12.350449 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:59:12.351516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:12.375987 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m21:59:12.378389 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m21:59:12.379482 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m21:59:12.387461 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.388517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:59:12.389375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:12.415695 [debug] [MainThread]: SQL status: SELECT 6 in 0.026 seconds
[0m21:59:12.418647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cecbda750>]}
[0m21:59:12.419590 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:12.420686 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.421481 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.422310 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.423554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:12.424451 [debug] [MainThread]: On master: Close
[0m21:59:12.432709 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m21:59:12.433468 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m21:59:12.434306 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m21:59:12.435377 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m21:59:12.436308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m21:59:12.437283 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m21:59:12.438384 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m21:59:12.439194 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m21:59:12.449965 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m21:59:12.453842 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m21:59:12.462234 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m21:59:12.468305 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m21:59:12.554493 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m21:59:12.555028 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m21:59:12.562516 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m21:59:12.563356 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m21:59:12.563984 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m21:59:12.564500 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:59:12.565331 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m21:59:12.566696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:12.586942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m21:59:12.587741 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m21:59:12.596758 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m21:59:12.602187 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m21:59:12.603085 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m21:59:12.604406 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m21:59:12.606795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.612963 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m21:59:12.613640 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:59:12.614316 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m21:59:12.618440 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m21:59:12.619893 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m21:59:12.620552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.622012 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.656348 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m21:59:12.659929 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m21:59:12.660505 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m21:59:12.661476 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m21:59:12.662407 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m21:59:12.663339 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m21:59:12.668341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:59:12.674527 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m21:59:12.678408 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m21:59:12.681531 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m21:59:12.690647 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m21:59:12.691601 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m21:59:12.692528 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m21:59:12.693452 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m21:59:12.699847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:59:12.703954 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m21:59:12.704585 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m21:59:12.708504 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m21:59:12.710076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cefaa5fa0>]}
[0m21:59:12.711007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cea54ad80>]}
[0m21:59:12.713462 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.27s]
[0m21:59:12.715024 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m21:59:12.716582 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m21:59:12.717967 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m21:59:12.720398 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m21:59:12.721470 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m21:59:12.722587 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m21:59:12.723323 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m21:59:12.727839 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m21:59:12.738023 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m21:59:12.769607 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m21:59:12.780715 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m21:59:12.781536 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m21:59:12.782357 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:59:12.811376 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.029 seconds
[0m21:59:12.820896 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m21:59:12.821796 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m21:59:12.824135 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.832913 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m21:59:12.834105 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m21:59:12.836027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.839335 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m21:59:12.840280 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m21:59:12.841120 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m21:59:12.844174 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:59:12.849903 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m21:59:12.855117 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m21:59:12.855985 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m21:59:12.865972 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m21:59:12.868383 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m21:59:12.869511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cea5f4770>]}
[0m21:59:12.870799 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.15s]
[0m21:59:12.872049 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m21:59:12.873568 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m21:59:12.874715 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m21:59:12.875608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m21:59:12.876354 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m21:59:12.881000 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m21:59:12.891431 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m21:59:12.896288 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m21:59:12.905776 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m21:59:12.906643 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m21:59:12.907376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:12.937315 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.030 seconds
[0m21:59:12.942072 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m21:59:12.943120 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m21:59:12.944797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.948991 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m21:59:12.949774 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m21:59:12.951313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:12.953413 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m21:59:12.954314 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m21:59:12.955104 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m21:59:12.959089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:59:12.962608 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m21:59:12.963764 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m21:59:12.964562 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m21:59:12.971082 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m21:59:12.973254 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m21:59:12.974407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cea5f6ba0>]}
[0m21:59:12.975599 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m21:59:12.976864 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m21:59:12.978524 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m21:59:12.979622 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m21:59:12.980744 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m21:59:12.981548 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m21:59:12.986515 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m21:59:12.996293 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m21:59:13.001089 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m21:59:13.011160 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m21:59:13.011962 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m21:59:13.012708 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:59:13.037052 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m21:59:13.043012 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m21:59:13.044009 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m21:59:13.046067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:59:13.048295 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m21:59:13.049215 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m21:59:13.049986 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m21:59:13.054472 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m21:59:13.058097 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m21:59:13.059410 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m21:59:13.060235 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m21:59:13.062118 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:59:13.064363 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m21:59:13.065425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd26f47c4-d8f9-4323-bd22-807328858b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cea93f500>]}
[0m21:59:13.066604 [info ] [Thread-3 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.08s]
[0m21:59:13.067813 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m21:59:13.070888 [debug] [MainThread]: On master: COMMIT
[0m21:59:13.071628 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:13.072312 [debug] [MainThread]: On master: COMMIT
[0m21:59:13.072934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:13.086488 [debug] [MainThread]: SQL status: COMMIT in 0.013 seconds
[0m21:59:13.087400 [debug] [MainThread]: On master: Close
[0m21:59:13.088331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:13.088971 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m21:59:13.089621 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m21:59:13.090328 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m21:59:13.090964 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m21:59:13.091840 [info ] [MainThread]: 
[0m21:59:13.092586 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m21:59:13.094849 [debug] [MainThread]: Command end result
[0m21:59:13.143967 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:59:13.218747 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:59:13.250471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:59:13.251260 [info ] [MainThread]: 
[0m21:59:13.252082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:13.252867 [info ] [MainThread]: 
[0m21:59:13.253698 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:59:13.255957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.533854, "process_in_blocks": "2064", "process_kernel_time": 0.7104, "process_mem_max_rss": "133504", "process_out_blocks": "0", "process_user_time": 6.326136}
[0m21:59:13.257113 [debug] [MainThread]: Command `dbt run` succeeded at 21:59:13.256918 after 2.54 seconds
[0m21:59:13.257927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ced2dd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740cecffa720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ced4d4620>]}
[0m21:59:13.268769 [debug] [MainThread]: Flushing usage events
[0m21:59:14.062524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:19.759939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79496382b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794963c16180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794963157620>]}


============================== 21:59:19.830006 | d54e61a5-ecb2-4e69-a9a6-d237fd418d04 ==============================
[0m21:59:19.830006 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:59:19.831066 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt test', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:59:20.159348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7949657c82f0>]}
[0m21:59:20.277783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794963128380>]}
[0m21:59:20.279284 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:59:20.449239 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:59:20.762659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:59:20.763677 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:59:20.764441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:59:20.773411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m21:59:20.833869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7949629079b0>]}
[0m21:59:20.986370 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:59:20.993727 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:59:21.261020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7949619a4d70>]}
[0m21:59:21.261960 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m21:59:21.262718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7949619857c0>]}
[0m21:59:21.265688 [info ] [MainThread]: 
[0m21:59:21.266443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:59:21.267183 [info ] [MainThread]: 
[0m21:59:21.268193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:21.274004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m21:59:21.353827 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m21:59:21.354871 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:59:21.355694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:21.383019 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m21:59:21.385514 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m21:59:21.386935 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m21:59:21.395884 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:21.396906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:59:21.397817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:21.424521 [debug] [MainThread]: SQL status: SELECT 6 in 0.027 seconds
[0m21:59:21.427479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54e61a5-ecb2-4e69-a9a6-d237fd418d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794961984050>]}
[0m21:59:21.428540 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:21.429595 [debug] [MainThread]: On master: COMMIT
[0m21:59:21.430385 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:21.431168 [debug] [MainThread]: On master: COMMIT
[0m21:59:21.432353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:21.433060 [debug] [MainThread]: On master: Close
[0m21:59:21.439852 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m21:59:21.440623 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m21:59:21.441236 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m21:59:21.442331 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m21:59:21.441834 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m21:59:21.443278 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m21:59:21.444125 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m21:59:21.445032 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m21:59:21.445934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m21:59:21.446899 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m21:59:21.447827 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m21:59:21.448913 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m21:59:21.449956 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m21:59:21.450774 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m21:59:21.451672 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m21:59:21.452485 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m21:59:21.493536 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m21:59:21.494243 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m21:59:21.495105 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m21:59:21.501130 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m21:59:21.508767 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m21:59:21.515413 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m21:59:21.521717 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m21:59:21.522240 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m21:59:21.575121 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m21:59:21.576591 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m21:59:21.577147 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m21:59:21.578300 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m21:59:21.586454 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m21:59:21.587340 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m21:59:21.587965 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:59:21.588552 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m21:59:21.589726 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m21:59:21.590726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:59:21.591367 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m21:59:21.592033 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:59:21.592941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:21.594825 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m21:59:21.597391 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:59:21.595887 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:59:21.616784 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m21:59:21.622594 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m21:59:21.623758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m21:59:21.624392 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.028 seconds
[0m21:59:21.624960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m21:59:21.625862 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m21:59:21.627899 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m21:59:21.629932 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m21:59:21.632079 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m21:59:21.633508 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.19s]
[0m21:59:21.634901 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m21:59:21.635481 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m21:59:21.636392 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m21:59:21.637308 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m21:59:21.638525 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.19s]
[0m21:59:21.642136 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.19s]
[0m21:59:21.643225 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.20s]
[0m21:59:21.645007 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m21:59:21.646128 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m21:59:21.647253 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m21:59:21.651362 [debug] [MainThread]: On master: COMMIT
[0m21:59:21.652072 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:21.652716 [debug] [MainThread]: On master: COMMIT
[0m21:59:21.653344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:21.667539 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m21:59:21.668538 [debug] [MainThread]: On master: Close
[0m21:59:21.669488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:21.670499 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m21:59:21.671174 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m21:59:21.671833 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m21:59:21.672610 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m21:59:21.673350 [info ] [MainThread]: 
[0m21:59:21.674126 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:59:21.676135 [debug] [MainThread]: Command end result
[0m21:59:21.723482 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:59:21.730460 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:59:21.744026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:59:21.744684 [info ] [MainThread]: 
[0m21:59:21.745433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:59:21.746098 [info ] [MainThread]: 
[0m21:59:21.746804 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:59:21.748801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.1158469, "process_in_blocks": "864", "process_kernel_time": 0.655377, "process_mem_max_rss": "163148", "process_out_blocks": "0", "process_user_time": 6.210102}
[0m21:59:21.749785 [debug] [MainThread]: Command `dbt test` succeeded at 21:59:21.749632 after 2.12 seconds
[0m21:59:21.750496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794967376c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79496382ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794963cc2c90>]}
[0m21:59:21.751181 [debug] [MainThread]: Flushing usage events
[0m21:59:22.594396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:45.066556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d393a32fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d393c42fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3939bbaf60>]}


============================== 22:59:45.136137 | 052e901a-e407-4658-be3c-a8eab74f6da9 ==============================
[0m22:59:45.136137 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:59:45.137515 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager'}
[0m22:59:45.393815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '052e901a-e407-4658-be3c-a8eab74f6da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d393a684a70>]}
[0m22:59:45.476696 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:45.484633 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:45.487512 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.54756224, "process_in_blocks": "28608", "process_kernel_time": 0.585271, "process_mem_max_rss": "124084", "process_out_blocks": "0", "process_user_time": 5.000689}
[0m22:59:45.488455 [debug] [MainThread]: Command `dbt deps` succeeded at 22:59:45.488309 after 0.55 seconds
[0m22:59:45.489220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d393daeec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3939138e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3939139f10>]}
[0m22:59:45.490014 [debug] [MainThread]: Flushing usage events
[0m22:59:46.128919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:51.812780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92df6e3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92dfd54c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92df6e3800>]}


============================== 22:59:51.881300 | 377e9347-d884-43b1-9043-48ab73a248ee ==============================
[0m22:59:51.881300 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:59:51.882589 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app/dbt', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'None', 'warn_error': 'None'}
[0m22:59:51.938963 [info ] [MainThread]: dbt version: 1.11.6
[0m22:59:51.939931 [info ] [MainThread]: python version: 3.12.12
[0m22:59:51.940683 [info ] [MainThread]: python path: /usr/local/bin/python
[0m22:59:51.941430 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m22:59:52.077047 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m22:59:52.078122 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m22:59:52.078956 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m22:59:52.080493 [info ] [MainThread]: adapter type: postgres
[0m22:59:52.081381 [info ] [MainThread]: adapter version: 1.10.0
[0m22:59:52.270912 [info ] [MainThread]: Configuration:
[0m22:59:52.271904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:59:52.272639 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:59:52.273389 [info ] [MainThread]: Required dependencies:
[0m22:59:52.274117 [debug] [MainThread]: Executing "git --help"
[0m22:59:52.287986 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:59:52.288879 [debug] [MainThread]: STDERR: "b''"
[0m22:59:52.289603 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:59:52.290296 [info ] [MainThread]: Connection:
[0m22:59:52.290983 [info ] [MainThread]:   host: db
[0m22:59:52.291620 [info ] [MainThread]:   port: 5432
[0m22:59:52.292321 [info ] [MainThread]:   user: postgres
[0m22:59:52.292952 [info ] [MainThread]:   database: spacex_db
[0m22:59:52.293650 [info ] [MainThread]:   schema: analytics
[0m22:59:52.294280 [info ] [MainThread]:   connect_timeout: 10
[0m22:59:52.294934 [info ] [MainThread]:   role: None
[0m22:59:52.295557 [info ] [MainThread]:   search_path: None
[0m22:59:52.296207 [info ] [MainThread]:   keepalives_idle: 0
[0m22:59:52.296836 [info ] [MainThread]:   sslmode: None
[0m22:59:52.297569 [info ] [MainThread]:   sslcert: None
[0m22:59:52.298302 [info ] [MainThread]:   sslkey: None
[0m22:59:52.298953 [info ] [MainThread]:   sslrootcert: None
[0m22:59:52.299658 [info ] [MainThread]:   application_name: dbt
[0m22:59:52.300305 [info ] [MainThread]:   retries: 1
[0m22:59:52.301120 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:59:52.455705 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:59:52.533661 [debug] [MainThread]: Using postgres connection "debug"
[0m22:59:52.534435 [debug] [MainThread]: On debug: select 1 as id
[0m22:59:52.535003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:52.564995 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m22:59:52.566741 [debug] [MainThread]: On debug: Close
[0m22:59:52.567517 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:59:52.568302 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:59:52.570510 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8953572, "process_in_blocks": "19432", "process_kernel_time": 0.619305, "process_mem_max_rss": "124904", "process_out_blocks": "0", "process_user_time": 5.223882}
[0m22:59:52.571429 [debug] [MainThread]: Command `dbt debug` succeeded at 22:59:52.571283 after 0.90 seconds
[0m22:59:52.572098 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:59:52.572782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92df5cadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92df9181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c92e081a270>]}
[0m22:59:52.573526 [debug] [MainThread]: Flushing usage events
[0m22:59:53.211855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:58.877005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606e98b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716070967ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606dfd4fb0>]}


============================== 22:59:58.947644 | 590ce9db-c759-421d-9661-52f2b34d7d65 ==============================
[0m22:59:58.947644 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:59:58.948797 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False'}
[0m22:59:59.298431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606ff4bef0>]}
[0m22:59:59.418255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606d96b380>]}
[0m22:59:59.419862 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:59:59.590982 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:59:59.944194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:59.945076 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:59:59.945900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:59.955248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m23:00:00.015939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606d1b03b0>]}
[0m23:00:00.161320 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:00:00.170303 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:00:00.260029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606c5a76b0>]}
[0m23:00:00.260946 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m23:00:00.261736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606c57ca40>]}
[0m23:00:00.264539 [info ] [MainThread]: 
[0m23:00:00.265308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:00.266023 [info ] [MainThread]: 
[0m23:00:00.267063 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:00.273950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:00:00.360380 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:00:00.361595 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:00:00.362353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:00.382506 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m23:00:00.384606 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:00:00.387340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m23:00:00.396765 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m23:00:00.397707 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:00:00.398415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:00.422697 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m23:00:00.424983 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m23:00:00.426530 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m23:00:00.434590 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:00.435615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:00:00.436562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:00.461149 [debug] [MainThread]: SQL status: SELECT 6 in 0.024 seconds
[0m23:00:00.464076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606d637fe0>]}
[0m23:00:00.464971 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:00.466113 [debug] [MainThread]: On master: COMMIT
[0m23:00:00.466871 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:00.467610 [debug] [MainThread]: On master: COMMIT
[0m23:00:00.468789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:00.469600 [debug] [MainThread]: On master: Close
[0m23:00:00.478423 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m23:00:00.479261 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m23:00:00.480069 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m23:00:00.481152 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m23:00:00.482122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m23:00:00.483081 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m23:00:00.484129 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m23:00:00.484971 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m23:00:00.495889 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m23:00:00.499662 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m23:00:00.507451 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m23:00:00.513499 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m23:00:00.605526 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m23:00:00.606681 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m23:00:00.615079 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:00:00.616561 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m23:00:00.617624 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:00:00.618214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:00:00.619092 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m23:00:00.621277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:00.650963 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.033 seconds
[0m23:00:00.666530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m23:00:00.667701 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:00:00.673987 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:00:00.674630 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m23:00:00.675803 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m23:00:00.678233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:00.683782 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:00:00.684533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:00:00.686391 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m23:00:00.691564 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:00:00.692901 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m23:00:00.693636 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:00.695187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:00.734988 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m23:00:00.735836 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m23:00:00.736398 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:00:00.737216 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:00:00.738036 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m23:00:00.738836 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m23:00:00.741746 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:00.747882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:00:00.751476 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m23:00:00.754838 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m23:00:00.765774 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:00:00.767162 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:00:00.767968 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m23:00:00.768731 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m23:00:00.774852 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:00:00.778560 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m23:00:00.779190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:00:00.782912 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m23:00:00.784579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606b5f5220>]}
[0m23:00:00.785249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160704864e0>]}
[0m23:00:00.788001 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m23:00:00.789149 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m23:00:00.790374 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m23:00:00.791415 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m23:00:00.792870 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m23:00:00.793789 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m23:00:00.794775 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m23:00:00.795459 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m23:00:00.799728 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m23:00:00.808750 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m23:00:00.840856 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m23:00:00.851232 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:00:00.852007 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m23:00:00.852719 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:00.880137 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.027 seconds
[0m23:00:00.890394 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:00:00.891342 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m23:00:00.893174 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:00.897773 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:00:00.898639 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m23:00:00.900214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:00.902478 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m23:00:00.903220 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:00:00.903949 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m23:00:00.906629 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:00.912437 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m23:00:00.917760 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:00:00.918644 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m23:00:00.930277 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m23:00:00.932469 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m23:00:00.933607 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606b1a8050>]}
[0m23:00:00.937170 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.14s]
[0m23:00:00.938709 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m23:00:00.940322 [debug] [Thread-2 (]: Began running node model.spacex_analytics.fct_launches
[0m23:00:00.941352 [info ] [Thread-2 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m23:00:00.942286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_rockets, now model.spacex_analytics.fct_launches)
[0m23:00:00.943126 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.fct_launches
[0m23:00:00.947552 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m23:00:00.957203 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.fct_launches
[0m23:00:00.962489 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m23:00:00.972203 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:00:00.973005 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m23:00:00.973951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:01.002815 [debug] [Thread-2 (]: SQL status: SELECT 205 in 0.029 seconds
[0m23:00:01.007946 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:00:01.009042 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m23:00:01.011156 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:01.016216 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:00:01.017504 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m23:00:01.019718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:01.022800 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m23:00:01.023944 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:00:01.024925 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m23:00:01.028298 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:01.032886 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m23:00:01.034645 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:00:01.035670 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m23:00:01.042720 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m23:00:01.045660 [debug] [Thread-2 (]: On model.spacex_analytics.fct_launches: Close
[0m23:00:01.047229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606b51ad80>]}
[0m23:00:01.048830 [info ] [Thread-2 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.10s]
[0m23:00:01.050335 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.fct_launches
[0m23:00:01.052398 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m23:00:01.053540 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m23:00:01.054609 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m23:00:01.055399 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m23:00:01.060762 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.071072 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m23:00:01.077518 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.088384 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.089532 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m23:00:01.090728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:01.121977 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m23:00:01.127591 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.128705 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m23:00:01.130792 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:01.134202 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m23:00:01.135496 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.136320 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m23:00:01.138985 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:01.143906 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m23:00:01.145868 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:00:01.146713 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m23:00:01.150625 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:00:01.153739 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m23:00:01.155184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590ce9db-c759-421d-9661-52f2b34d7d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606b5d8140>]}
[0m23:00:01.156350 [info ] [Thread-3 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.10s]
[0m23:00:01.157646 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m23:00:01.161082 [debug] [MainThread]: On master: COMMIT
[0m23:00:01.162080 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:01.162875 [debug] [MainThread]: On master: COMMIT
[0m23:00:01.163632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:01.179521 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m23:00:01.181764 [debug] [MainThread]: On master: Close
[0m23:00:01.183092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:01.183939 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_launches' was properly closed.
[0m23:00:01.184592 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m23:00:01.185398 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m23:00:01.186133 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m23:00:01.186966 [info ] [MainThread]: 
[0m23:00:01.187779 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m23:00:01.190469 [debug] [MainThread]: Command end result
[0m23:00:01.241562 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:00:01.248523 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:00:01.261937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m23:00:01.262755 [info ] [MainThread]: 
[0m23:00:01.263647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:01.264454 [info ] [MainThread]: 
[0m23:00:01.265317 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:00:01.267767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5191684, "process_in_blocks": "2064", "process_kernel_time": 0.654669, "process_mem_max_rss": "133944", "process_out_blocks": "0", "process_user_time": 6.391009}
[0m23:00:01.270396 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:01.268637 after 2.52 seconds
[0m23:00:01.271759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606e0fb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606dfd4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71606d658aa0>]}
[0m23:00:01.272903 [debug] [MainThread]: Flushing usage events
[0m23:00:02.035361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:08.042077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfd2365c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfd0207e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfcff3f680>]}


============================== 23:00:08.111736 | c9e15b49-a9de-451b-a803-e7052255ff60 ==============================
[0m23:00:08.111736 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:00:08.112818 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'profiles_dir': '/app/dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False'}
[0m23:00:08.447059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfcf3ea270>]}
[0m23:00:08.564628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfcfec29c0>]}
[0m23:00:08.566303 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:00:08.729729 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:00:09.035136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:09.036072 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:00:09.036861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:09.046540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m23:00:09.106333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfcf5b8a70>]}
[0m23:00:09.249062 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:00:09.255720 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:00:09.522964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfce1c1190>]}
[0m23:00:09.523837 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m23:00:09.524534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfce199790>]}
[0m23:00:09.527348 [info ] [MainThread]: 
[0m23:00:09.528118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:09.528819 [info ] [MainThread]: 
[0m23:00:09.529940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:09.535748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m23:00:09.624943 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m23:00:09.626087 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:00:09.626787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:09.664820 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m23:00:09.667369 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m23:00:09.668320 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m23:00:09.676239 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.677208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:00:09.678113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:09.706383 [debug] [MainThread]: SQL status: SELECT 6 in 0.028 seconds
[0m23:00:09.709200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e15b49-a9de-451b-a803-e7052255ff60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfce181520>]}
[0m23:00:09.710093 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:09.710982 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.711652 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.712297 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.713393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:09.714043 [debug] [MainThread]: On master: Close
[0m23:00:09.722547 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:00:09.723328 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:00:09.723963 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:00:09.725081 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:00:09.724574 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m23:00:09.726050 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m23:00:09.726864 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m23:00:09.727689 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m23:00:09.728733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m23:00:09.729763 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m23:00:09.730657 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m23:00:09.731744 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m23:00:09.732587 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:00:09.733416 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:00:09.734190 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:00:09.735114 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:00:09.772550 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:00:09.777577 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:00:09.780029 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:00:09.786349 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:00:09.796432 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:00:09.797330 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:00:09.808949 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:00:09.865073 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:00:09.868426 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:00:09.869200 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:00:09.870731 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:00:09.875683 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:00:09.881140 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:00:09.882188 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:00:09.883095 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:00:09.884027 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:00:09.884723 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:00:09.885308 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:09.885885 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:00:09.886723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:09.887523 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m23:00:09.888773 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m23:00:09.890348 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:00:09.891255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:09.908939 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m23:00:09.910107 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.020 seconds
[0m23:00:09.916819 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.031 seconds
[0m23:00:09.918901 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m23:00:09.917712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m23:00:09.920813 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m23:00:09.923314 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m23:00:09.926746 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m23:00:09.927454 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m23:00:09.928380 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m23:00:09.929207 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m23:00:09.930083 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m23:00:09.934317 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.21s]
[0m23:00:09.931995 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.20s]
[0m23:00:09.933384 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.20s]
[0m23:00:09.931097 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.20s]
[0m23:00:09.935509 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:00:09.936653 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:00:09.937759 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:00:09.938980 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:00:09.945298 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.946192 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:09.946822 [debug] [MainThread]: On master: COMMIT
[0m23:00:09.947404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:09.961810 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m23:00:09.962666 [debug] [MainThread]: On master: Close
[0m23:00:09.963513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:09.966550 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m23:00:09.967292 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m23:00:09.967956 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m23:00:09.968602 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m23:00:09.969359 [info ] [MainThread]: 
[0m23:00:09.970102 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:00:09.972202 [debug] [MainThread]: Command end result
[0m23:00:10.018376 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:00:10.026464 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:00:10.040400 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m23:00:10.041101 [info ] [MainThread]: 
[0m23:00:10.041934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:10.042632 [info ] [MainThread]: 
[0m23:00:10.043387 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:00:10.045468 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.127569, "process_in_blocks": "864", "process_kernel_time": 0.729339, "process_mem_max_rss": "162032", "process_out_blocks": "0", "process_user_time": 6.403761}
[0m23:00:10.046303 [debug] [MainThread]: Command `dbt test` succeeded at 23:00:10.046164 after 2.13 seconds
[0m23:00:10.046992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfd2365c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfd229dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddfd3e3ac00>]}
[0m23:00:10.047700 [debug] [MainThread]: Flushing usage events
[0m23:00:10.719842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:45.459507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c8cf8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c8255ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c64024b0>]}


============================== 23:37:45.521748 | fcdbd1eb-cfeb-4a86-885e-f818d8304644 ==============================
[0m23:37:45.521748 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:37:45.523223 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt deps'}
[0m23:37:45.831866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcdbd1eb-cfeb-4a86-885e-f818d8304644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c86f4620>]}
[0m23:37:45.931458 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:37:45.943563 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:37:45.946256 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.730304, "process_in_blocks": "1384", "process_kernel_time": 0.958612, "process_mem_max_rss": "124960", "process_out_blocks": "0", "process_user_time": 6.813458}
[0m23:37:45.947518 [debug] [MainThread]: Command `dbt deps` succeeded at 23:37:45.947312 after 0.73 seconds
[0m23:37:45.948322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c8255ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c86f4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255c5881580>]}
[0m23:37:45.949334 [debug] [MainThread]: Flushing usage events
[0m23:37:46.638385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:54.120987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf11039dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf0e6eb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf0e6eb620>]}


============================== 23:37:54.197260 | ab4f83e7-6d5c-420b-902b-b105466c9f96 ==============================
[0m23:37:54.197260 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:37:54.198479 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'profiles_dir': '/app/dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m23:37:54.260600 [info ] [MainThread]: dbt version: 1.11.6
[0m23:37:54.261679 [info ] [MainThread]: python version: 3.12.12
[0m23:37:54.262459 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:37:54.263259 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m23:37:54.406421 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m23:37:54.407484 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m23:37:54.408415 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m23:37:54.409662 [info ] [MainThread]: adapter type: postgres
[0m23:37:54.412946 [info ] [MainThread]: adapter version: 1.10.0
[0m23:37:54.632091 [info ] [MainThread]: Configuration:
[0m23:37:54.633268 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:37:54.634112 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:37:54.634807 [info ] [MainThread]: Required dependencies:
[0m23:37:54.635592 [debug] [MainThread]: Executing "git --help"
[0m23:37:54.639637 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:37:54.641275 [debug] [MainThread]: STDERR: "b''"
[0m23:37:54.642225 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:37:54.643745 [info ] [MainThread]: Connection:
[0m23:37:54.644465 [info ] [MainThread]:   host: db
[0m23:37:54.645131 [info ] [MainThread]:   port: 5432
[0m23:37:54.646064 [info ] [MainThread]:   user: postgres
[0m23:37:54.646892 [info ] [MainThread]:   database: spacex_db
[0m23:37:54.647817 [info ] [MainThread]:   schema: analytics
[0m23:37:54.648626 [info ] [MainThread]:   connect_timeout: 10
[0m23:37:54.649336 [info ] [MainThread]:   role: None
[0m23:37:54.650012 [info ] [MainThread]:   search_path: None
[0m23:37:54.650715 [info ] [MainThread]:   keepalives_idle: 0
[0m23:37:54.651437 [info ] [MainThread]:   sslmode: None
[0m23:37:54.652099 [info ] [MainThread]:   sslcert: None
[0m23:37:54.652794 [info ] [MainThread]:   sslkey: None
[0m23:37:54.653536 [info ] [MainThread]:   sslrootcert: None
[0m23:37:54.654335 [info ] [MainThread]:   application_name: dbt
[0m23:37:54.655341 [info ] [MainThread]:   retries: 1
[0m23:37:54.656910 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:37:54.840676 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:37:54.940359 [debug] [MainThread]: Using postgres connection "debug"
[0m23:37:54.941200 [debug] [MainThread]: On debug: select 1 as id
[0m23:37:54.941981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:37:54.965454 [debug] [MainThread]: SQL status: SELECT 1 in 0.023 seconds
[0m23:37:54.967319 [debug] [MainThread]: On debug: Close
[0m23:37:54.968176 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:37:54.971459 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:37:54.973993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.99056137, "process_in_blocks": "56", "process_kernel_time": 0.733888, "process_mem_max_rss": "125144", "process_out_blocks": "0", "process_user_time": 6.629736}
[0m23:37:54.975066 [debug] [MainThread]: Command `dbt debug` succeeded at 23:37:54.974843 after 0.99 seconds
[0m23:37:54.976121 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:37:54.976825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf0e5b8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf0df9a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcf0df9a840>]}
[0m23:37:54.977701 [debug] [MainThread]: Flushing usage events
[0m23:37:55.604722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:03.324150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fe5be900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a8005b79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fe5bfe00>]}


============================== 23:38:03.397829 | c7f4804f-5ce2-4d24-9cf5-77195c04d935 ==============================
[0m23:38:03.397829 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:38:03.398882 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None'}
[0m23:38:03.787949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fd108710>]}
[0m23:38:03.921693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fda56b40>]}
[0m23:38:03.923567 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:38:04.119563 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:38:04.513472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:38:04.514392 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:38:04.515012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:38:04.524832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m23:38:04.587897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fd206840>]}
[0m23:38:04.740451 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:38:04.748491 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:38:04.873744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fbfa3a40>]}
[0m23:38:04.875022 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m23:38:04.882364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fd4c0da0>]}
[0m23:38:04.945450 [info ] [MainThread]: 
[0m23:38:05.250224 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:05.332993 [info ] [MainThread]: 
[0m23:38:05.486509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:05.557497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m23:38:05.984214 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m23:38:05.995283 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m23:38:06.022517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:06.101643 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.079 seconds
[0m23:38:06.104103 [debug] [ThreadPool]: On list_spacex_db: Close
[0m23:38:06.107678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m23:38:06.137988 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m23:38:06.138980 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:38:06.139796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:06.196395 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m23:38:06.199082 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m23:38:06.200434 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m23:38:06.209015 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:06.210347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:38:06.215814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:06.247857 [debug] [MainThread]: SQL status: SELECT 6 in 0.033 seconds
[0m23:38:06.251576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fbfa1850>]}
[0m23:38:06.252709 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:06.253935 [debug] [MainThread]: On master: COMMIT
[0m23:38:06.254808 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:06.255651 [debug] [MainThread]: On master: COMMIT
[0m23:38:06.257002 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:38:06.257847 [debug] [MainThread]: On master: Close
[0m23:38:06.268177 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m23:38:06.269097 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m23:38:06.270003 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m23:38:06.270936 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m23:38:06.271968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m23:38:06.272950 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m23:38:06.274277 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m23:38:06.275109 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m23:38:06.288220 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m23:38:06.293401 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m23:38:06.301106 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m23:38:06.307634 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m23:38:06.414515 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m23:38:06.415274 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m23:38:06.430453 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:38:06.432033 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m23:38:06.433121 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:38:06.434104 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:06.435426 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m23:38:06.437980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:06.496395 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.058 seconds
[0m23:38:06.497191 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.063 seconds
[0m23:38:06.520298 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:38:06.524244 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:38:06.525558 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m23:38:06.527810 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m23:38:06.531124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.531945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:38:06.538360 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:38:06.542676 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:38:06.544068 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m23:38:06.545343 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m23:38:06.547686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.548698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:38:06.592769 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m23:38:06.592172 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m23:38:06.593893 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:38:06.595055 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:38:06.595959 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m23:38:06.596801 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m23:38:06.606374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:38:06.612925 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m23:38:06.617252 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m23:38:06.620798 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m23:38:06.631595 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m23:38:06.632788 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m23:38:06.633779 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m23:38:06.634638 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m23:38:06.644289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:38:06.645228 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m23:38:06.648975 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m23:38:06.651618 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m23:38:06.658233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a8000d5c10>]}
[0m23:38:06.659076 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fab43b00>]}
[0m23:38:06.660455 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.38s]
[0m23:38:06.661660 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.38s]
[0m23:38:06.662822 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m23:38:06.664024 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m23:38:06.666191 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m23:38:06.667240 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m23:38:06.668282 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m23:38:06.668999 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m23:38:06.673697 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m23:38:06.683985 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m23:38:06.719666 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m23:38:06.730286 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:38:06.731550 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m23:38:06.732674 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:06.762670 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.030 seconds
[0m23:38:06.772593 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:38:06.773717 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m23:38:06.775566 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.781293 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:38:06.782333 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m23:38:06.784155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.786666 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m23:38:06.787466 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:38:06.788162 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m23:38:06.790702 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:38:06.795678 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m23:38:06.801191 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m23:38:06.802189 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m23:38:06.813637 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m23:38:06.816203 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m23:38:06.817359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7faf28770>]}
[0m23:38:06.818585 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 4[0m in 0.15s]
[0m23:38:06.819823 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m23:38:06.821495 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m23:38:06.822666 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m23:38:06.823701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m23:38:06.824478 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m23:38:06.831248 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m23:38:06.840965 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m23:38:06.847290 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m23:38:06.858370 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:38:06.859322 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m23:38:06.860411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:06.891575 [debug] [Thread-1 (]: SQL status: SELECT 205 in 0.031 seconds
[0m23:38:06.896912 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:38:06.897874 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m23:38:06.899767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.904480 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:38:06.905851 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m23:38:06.909488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:06.912083 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m23:38:06.912940 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:38:06.913661 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m23:38:06.916000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:38:06.922220 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m23:38:06.926194 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m23:38:06.928147 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m23:38:06.937754 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m23:38:06.941454 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m23:38:06.943121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fab94aa0>]}
[0m23:38:06.946103 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 205[0m in 0.12s]
[0m23:38:06.948656 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m23:38:06.951946 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m23:38:06.953327 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m23:38:06.954540 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m23:38:06.955314 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m23:38:06.961425 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m23:38:06.971502 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m23:38:06.976725 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m23:38:06.987153 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:38:06.988228 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m23:38:06.989053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:07.027056 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m23:38:07.034063 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:38:07.035449 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m23:38:07.038017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:38:07.040492 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m23:38:07.041537 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:38:07.042332 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m23:38:07.048680 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:38:07.070577 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m23:38:07.092502 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m23:38:07.108870 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m23:38:07.126352 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:38:07.132803 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m23:38:07.134998 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f4804f-5ce2-4d24-9cf5-77195c04d935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fd207f20>]}
[0m23:38:07.140523 [info ] [Thread-3 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.18s]
[0m23:38:07.142323 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m23:38:07.146807 [debug] [MainThread]: On master: COMMIT
[0m23:38:07.147940 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:07.149262 [debug] [MainThread]: On master: COMMIT
[0m23:38:07.150188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:07.173771 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m23:38:07.178438 [debug] [MainThread]: On master: Close
[0m23:38:07.182498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:07.187271 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m23:38:07.189148 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m23:38:07.191025 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m23:38:07.202593 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m23:38:07.206998 [info ] [MainThread]: 
[0m23:38:07.208412 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m23:38:07.212117 [debug] [MainThread]: Command end result
[0m23:38:07.275652 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:38:07.282220 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:38:07.294488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m23:38:07.295275 [info ] [MainThread]: 
[0m23:38:07.296072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:07.297463 [info ] [MainThread]: 
[0m23:38:07.298293 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:38:07.300398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.248659, "process_in_blocks": "80", "process_kernel_time": 0.975205, "process_mem_max_rss": "134520", "process_out_blocks": "0", "process_user_time": 8.333576}
[0m23:38:07.301370 [debug] [MainThread]: Command `dbt run` succeeded at 23:38:07.301212 after 4.25 seconds
[0m23:38:07.302042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fda56360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fe5bf830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a7fe5be7e0>]}
[0m23:38:07.302702 [debug] [MainThread]: Flushing usage events
[0m23:38:08.011148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:15.960055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f3169610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f10e20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f10e30e0>]}


============================== 23:38:16.066794 | 225ac47a-957d-4d68-830b-d777e77f77ba ==============================
[0m23:38:16.066794 [info ] [MainThread]: Running with dbt=1.11.6
[0m23:38:16.067968 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'write_json': 'True'}
[0m23:38:16.416675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f0ebcef0>]}
[0m23:38:16.535933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f0ebdac0>]}
[0m23:38:16.537563 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:38:16.714208 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m23:38:17.034518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:38:17.035486 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:38:17.036200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:38:17.045722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m23:38:17.109265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2efd14530>]}
[0m23:38:17.252931 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:38:17.259595 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:38:17.554383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2ef1a9940>]}
[0m23:38:17.555416 [info ] [MainThread]: Found 4 data tests, 5 models, 2 sources, 464 macros
[0m23:38:17.556507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2efbe9160>]}
[0m23:38:17.560505 [info ] [MainThread]: 
[0m23:38:17.561514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:17.562290 [info ] [MainThread]: 
[0m23:38:17.563341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:17.570661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m23:38:17.670875 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m23:38:17.672575 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:38:17.674752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:17.714280 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m23:38:17.716709 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m23:38:17.717759 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m23:38:17.727245 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:17.729360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:38:17.730633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:17.762394 [debug] [MainThread]: SQL status: SELECT 6 in 0.032 seconds
[0m23:38:17.765482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '225ac47a-957d-4d68-830b-d777e77f77ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2efebccb0>]}
[0m23:38:17.766431 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:17.767430 [debug] [MainThread]: On master: COMMIT
[0m23:38:17.768135 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:17.768817 [debug] [MainThread]: On master: COMMIT
[0m23:38:17.769855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:38:17.770605 [debug] [MainThread]: On master: Close
[0m23:38:17.782902 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:38:17.783693 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:38:17.784368 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:38:17.784991 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:38:17.785601 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m23:38:17.786492 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m23:38:17.787356 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m23:38:17.788184 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m23:38:17.789201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m23:38:17.790565 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m23:38:17.792164 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m23:38:17.793588 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m23:38:17.795026 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:38:17.796500 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:38:17.797723 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:38:17.799248 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:38:17.853867 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:38:17.856042 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:38:17.859208 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:38:17.861149 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:38:17.865879 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:38:17.866567 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:38:17.878332 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:38:17.894593 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:38:17.929206 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:38:17.932053 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:38:17.932840 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:38:17.936213 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:38:17.943492 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m23:38:17.944601 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m23:38:17.945354 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m23:38:17.946157 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m23:38:17.946761 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:17.947726 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:38:17.948651 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m23:38:17.949249 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m23:38:17.950576 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:17.951416 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:17.952419 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m23:38:17.955596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:17.974380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m23:38:17.975122 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.024 seconds
[0m23:38:17.984453 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m23:38:17.981651 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.035 seconds
[0m23:38:17.982168 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m23:38:17.975691 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.025 seconds
[0m23:38:17.987573 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m23:38:17.988250 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m23:38:17.991443 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m23:38:17.992198 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m23:38:17.993121 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m23:38:17.994265 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.20s]
[0m23:38:17.995116 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m23:38:17.996753 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.21s]
[0m23:38:18.002808 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m23:38:17.998999 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.21s]
[0m23:38:17.997957 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m23:38:18.000836 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.21s]
[0m23:38:18.004863 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m23:38:18.006476 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m23:38:18.010832 [debug] [MainThread]: On master: COMMIT
[0m23:38:18.011796 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:18.013336 [debug] [MainThread]: On master: COMMIT
[0m23:38:18.014231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:18.031258 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m23:38:18.032135 [debug] [MainThread]: On master: Close
[0m23:38:18.033017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:18.033709 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m23:38:18.034373 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m23:38:18.035020 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m23:38:18.035687 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m23:38:18.036535 [info ] [MainThread]: 
[0m23:38:18.037384 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:38:18.041373 [debug] [MainThread]: Command end result
[0m23:38:18.093900 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m23:38:18.100457 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m23:38:18.117809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m23:38:18.118625 [info ] [MainThread]: 
[0m23:38:18.119370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:18.119979 [info ] [MainThread]: 
[0m23:38:18.120635 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m23:38:18.122729 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.473639, "process_in_blocks": "0", "process_kernel_time": 0.982753, "process_mem_max_rss": "161940", "process_out_blocks": "0", "process_user_time": 8.123263}
[0m23:38:18.124722 [debug] [MainThread]: Command `dbt test` succeeded at 23:38:18.124408 after 2.48 seconds
[0m23:38:18.125602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2effb7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f482ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2f482ac30>]}
[0m23:38:18.126288 [debug] [MainThread]: Flushing usage events
[0m23:38:18.968837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:07.637611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736192107020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7361942a3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736192107110>]}


============================== 15:46:07.904937 | fd12fc43-bb94-48bd-b7c0-f3530842f941 ==============================
[0m15:46:07.904937 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:46:07.906503 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'target_path': 'None'}
[0m15:46:08.504726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd12fc43-bb94-48bd-b7c0-f3530842f941', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736191b21880>]}
[0m15:46:08.646369 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:46:08.655508 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:46:08.658427 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3377559, "process_in_blocks": "1736", "process_kernel_time": 0.822017, "process_mem_max_rss": "121884", "process_out_blocks": "0", "process_user_time": 5.960662}
[0m15:46:08.659426 [debug] [MainThread]: Command `dbt deps` succeeded at 15:46:08.659222 after 1.34 seconds
[0m15:46:08.660129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736192032a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736191b2f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73619183dca0>]}
[0m15:46:08.660872 [debug] [MainThread]: Flushing usage events
[0m15:46:09.299506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:17.938413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b3b84290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b27b6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b3a9b080>]}


============================== 15:46:18.012966 | b8f9e2ed-763a-44a9-b846-ca0cbb6a74d2 ==============================
[0m15:46:18.012966 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:46:18.014279 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/app/dbt', 'empty': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/app/dbt/logs', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m15:46:18.071837 [info ] [MainThread]: dbt version: 1.10.19
[0m15:46:18.072695 [info ] [MainThread]: python version: 3.12.12
[0m15:46:18.073813 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:46:18.074542 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m15:46:18.197698 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m15:46:18.198899 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m15:46:18.199749 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m15:46:18.201505 [info ] [MainThread]: adapter type: postgres
[0m15:46:18.202328 [info ] [MainThread]: adapter version: 1.10.0
[0m15:46:18.414600 [info ] [MainThread]: Configuration:
[0m15:46:18.415729 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:46:18.416553 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:46:18.417435 [info ] [MainThread]: Required dependencies:
[0m15:46:18.418256 [debug] [MainThread]: Executing "git --help"
[0m15:46:18.436116 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:46:18.437178 [debug] [MainThread]: STDERR: "b''"
[0m15:46:18.437841 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:46:18.438581 [info ] [MainThread]: Connection:
[0m15:46:18.439332 [info ] [MainThread]:   host: db
[0m15:46:18.440052 [info ] [MainThread]:   port: 5432
[0m15:46:18.440784 [info ] [MainThread]:   user: postgres
[0m15:46:18.441456 [info ] [MainThread]:   database: spacex_db
[0m15:46:18.442188 [info ] [MainThread]:   schema: analytics
[0m15:46:18.442913 [info ] [MainThread]:   connect_timeout: 10
[0m15:46:18.443907 [info ] [MainThread]:   role: None
[0m15:46:18.444855 [info ] [MainThread]:   search_path: None
[0m15:46:18.445787 [info ] [MainThread]:   keepalives_idle: 0
[0m15:46:18.446609 [info ] [MainThread]:   sslmode: None
[0m15:46:18.447317 [info ] [MainThread]:   sslcert: None
[0m15:46:18.447999 [info ] [MainThread]:   sslkey: None
[0m15:46:18.448736 [info ] [MainThread]:   sslrootcert: None
[0m15:46:18.449408 [info ] [MainThread]:   application_name: dbt
[0m15:46:18.450106 [info ] [MainThread]:   retries: 1
[0m15:46:18.450957 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:46:18.607170 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:46:18.751147 [debug] [MainThread]: Using postgres connection "debug"
[0m15:46:18.755063 [debug] [MainThread]: On debug: select 1 as id
[0m15:46:18.756143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:18.791797 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m15:46:18.793626 [debug] [MainThread]: On debug: Close
[0m15:46:18.795559 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:46:18.798366 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:46:18.800990 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.98697644, "process_in_blocks": "96", "process_kernel_time": 0.946543, "process_mem_max_rss": "121688", "process_out_blocks": "0", "process_user_time": 7.815499}
[0m15:46:18.802040 [debug] [MainThread]: Command `dbt debug` succeeded at 15:46:18.801847 after 0.99 seconds
[0m15:46:18.802973 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:46:18.803909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b2845910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b2f42cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c36b22fe0f0>]}
[0m15:46:18.804894 [debug] [MainThread]: Flushing usage events
[0m15:46:19.481938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:25.809002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caec600140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caebee34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caeca1c500>]}


============================== 15:46:25.879703 | 800ae7e5-e792-4c91-9552-3b86f199e685 ==============================
[0m15:46:25.879703 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:46:25.880883 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True'}
[0m15:46:26.232301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caec0c0470>]}
[0m15:46:26.359823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caebcdd550>]}
[0m15:46:26.361432 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:46:26.528202 [debug] [MainThread]: checksum: c35ba6d374a0901ceb00688d5179d5550885e1756283b03e5e81c28e0d8d2248, vars: {}, profile: , target: , version: 1.10.19
[0m15:46:26.738498 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:46:26.739474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caea73f7a0>]}
[0m15:46:28.895425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m15:46:28.914348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae931bc20>]}
[0m15:46:29.052215 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:29.059763 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:29.152997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae8f66cf0>]}
[0m15:46:29.153951 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m15:46:29.154718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae9b41190>]}
[0m15:46:29.157750 [info ] [MainThread]: 
[0m15:46:29.158582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:29.159326 [info ] [MainThread]: 
[0m15:46:29.160332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:29.166810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:46:29.254504 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:46:29.255535 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:46:29.256295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:29.280685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m15:46:29.283072 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:46:29.284571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now create_spacex_db_analytics)
[0m15:46:29.285591 [debug] [ThreadPool]: Creating schema "database: "spacex_db"
schema: "analytics"
"
[0m15:46:29.293237 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics"
[0m15:46:29.294252 [debug] [ThreadPool]: On create_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "create_spacex_db_analytics"} */
create schema if not exists "analytics"
[0m15:46:29.295037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:29.312382 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.017 seconds
[0m15:46:29.314204 [debug] [ThreadPool]: On create_spacex_db_analytics: COMMIT
[0m15:46:29.314944 [debug] [ThreadPool]: Using postgres connection "create_spacex_db_analytics"
[0m15:46:29.315649 [debug] [ThreadPool]: On create_spacex_db_analytics: COMMIT
[0m15:46:29.318122 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:46:29.318841 [debug] [ThreadPool]: On create_spacex_db_analytics: Close
[0m15:46:29.321449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_spacex_db_analytics, now list_spacex_db_analytics)
[0m15:46:29.331449 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m15:46:29.332971 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:46:29.334909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:29.375139 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.040 seconds
[0m15:46:29.377354 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m15:46:29.378430 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m15:46:29.385179 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:29.386261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:46:29.387108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:29.421057 [debug] [MainThread]: SQL status: SELECT 2 in 0.034 seconds
[0m15:46:29.423312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae8f66750>]}
[0m15:46:29.424564 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:29.425794 [debug] [MainThread]: On master: COMMIT
[0m15:46:29.426630 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:29.427471 [debug] [MainThread]: On master: COMMIT
[0m15:46:29.428837 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:46:29.429639 [debug] [MainThread]: On master: Close
[0m15:46:29.442118 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m15:46:29.442928 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m15:46:29.443811 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m15:46:29.444940 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m15:46:29.446108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m15:46:29.447026 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m15:46:29.447833 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m15:46:29.448664 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m15:46:29.459316 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m15:46:29.463094 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m15:46:29.469309 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m15:46:29.476598 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m15:46:29.551123 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m15:46:29.552566 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m15:46:29.560704 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:46:29.561351 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:46:29.562234 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m15:46:29.563096 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m15:46:29.563920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:29.564803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:29.593600 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m15:46:29.594321 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m15:46:29.605559 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:46:29.610315 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:46:29.611724 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:46:29.612913 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m15:46:29.615556 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:29.652710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:29.700096 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m15:46:29.700975 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m15:46:29.704569 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:46:29.705633 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:46:29.706608 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m15:46:29.707610 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m15:46:29.712247 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:46:29.719598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:46:29.724773 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m15:46:29.728133 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m15:46:29.737108 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:46:29.738082 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:46:29.738971 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m15:46:29.740000 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m15:46:29.742604 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:46:29.743240 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:46:29.746673 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m15:46:29.748698 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m15:46:29.752002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caed960ad0>]}
[0m15:46:29.752588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae9382c60>]}
[0m15:46:29.755009 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m15:46:29.756121 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m15:46:29.757231 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m15:46:29.758229 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m15:46:29.760275 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m15:46:29.761227 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m15:46:29.762233 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m15:46:29.762915 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m15:46:29.767222 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m15:46:29.775433 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m15:46:29.806299 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m15:46:29.815179 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:46:29.815964 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m15:46:29.816658 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:46:29.846589 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:46:29.856959 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:46:29.857993 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:46:29.859632 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:29.861777 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m15:46:29.862606 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:46:29.863390 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m15:46:29.866501 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:29.870160 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m15:46:29.874954 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:46:29.875845 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m15:46:29.877255 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:46:29.879397 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m15:46:29.880834 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae831f4a0>]}
[0m15:46:29.882282 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 0[0m in 0.12s]
[0m15:46:29.883673 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m15:46:29.885539 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m15:46:29.886520 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m15:46:29.887440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m15:46:29.888244 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m15:46:29.892712 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m15:46:29.903013 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m15:46:29.910904 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m15:46:29.922631 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:46:29.923503 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m15:46:29.924231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:29.954380 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:46:29.959421 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:46:29.960272 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m15:46:29.961911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:29.964120 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m15:46:29.965262 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:46:29.966045 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m15:46:29.968526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:29.971880 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m15:46:29.973084 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:46:29.973866 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m15:46:29.975079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:46:29.977062 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m15:46:29.978439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae468d7c0>]}
[0m15:46:29.981170 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 0[0m in 0.09s]
[0m15:46:29.982661 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m15:46:29.984282 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m15:46:29.985354 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m15:46:29.986348 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m15:46:29.987128 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m15:46:29.991902 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.002198 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m15:46:30.006821 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.017330 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.018181 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m15:46:30.019001 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:30.046994 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m15:46:30.051758 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.053132 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m15:46:30.055100 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:46:30.057261 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m15:46:30.058211 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.059023 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m15:46:30.061988 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:46:30.065679 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m15:46:30.066950 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:46:30.067913 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m15:46:30.069809 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:46:30.072362 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m15:46:30.073899 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800ae7e5-e792-4c91-9552-3b86f199e685', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae6f487d0>]}
[0m15:46:30.075260 [info ] [Thread-3 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.09s]
[0m15:46:30.076500 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m15:46:30.079534 [debug] [MainThread]: On master: COMMIT
[0m15:46:30.080323 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:30.081038 [debug] [MainThread]: On master: COMMIT
[0m15:46:30.081703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:30.096935 [debug] [MainThread]: SQL status: COMMIT in 0.015 seconds
[0m15:46:30.098070 [debug] [MainThread]: On master: Close
[0m15:46:30.099038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:30.101892 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m15:46:30.102640 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m15:46:30.103324 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m15:46:30.104067 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m15:46:30.105035 [info ] [MainThread]: 
[0m15:46:30.105955 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m15:46:30.108311 [debug] [MainThread]: Command end result
[0m15:46:30.158156 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:30.165205 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:30.177916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:46:30.178711 [info ] [MainThread]: 
[0m15:46:30.179519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:30.180226 [info ] [MainThread]: 
[0m15:46:30.181007 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:46:30.183554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4952474, "process_in_blocks": "80", "process_kernel_time": 0.792028, "process_mem_max_rss": "135876", "process_out_blocks": "0", "process_user_time": 8.748685}
[0m15:46:30.184489 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:30.184317 after 4.50 seconds
[0m15:46:30.185274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caebcd1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71caeaa13440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cae936f920>]}
[0m15:46:30.186030 [debug] [MainThread]: Flushing usage events
[0m15:46:30.991496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:38.701041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715098e56420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715098a347d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715096fdc230>]}


============================== 15:46:38.767402 | 0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd ==============================
[0m15:46:38.767402 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:46:38.768480 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'None', 'introspect': 'True'}
[0m15:46:39.116798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715095a15df0>]}
[0m15:46:39.247541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715096f60b30>]}
[0m15:46:39.250537 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:46:39.420947 [debug] [MainThread]: checksum: c35ba6d374a0901ceb00688d5179d5550885e1756283b03e5e81c28e0d8d2248, vars: {}, profile: , target: , version: 1.10.19
[0m15:46:39.820351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:39.821320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:39.829938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m15:46:39.921226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715094bcb7d0>]}
[0m15:46:40.109401 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:40.117640 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:40.521318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715094ba56a0>]}
[0m15:46:40.522528 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m15:46:40.523563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715095b0dd60>]}
[0m15:46:40.526897 [info ] [MainThread]: 
[0m15:46:40.527751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:46:40.528399 [info ] [MainThread]: 
[0m15:46:40.529411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:40.535967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m15:46:40.627219 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m15:46:40.628192 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:46:40.628899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:40.659296 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m15:46:40.661615 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m15:46:40.662668 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m15:46:40.673323 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:40.674357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:46:40.675208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:40.702956 [debug] [MainThread]: SQL status: SELECT 6 in 0.028 seconds
[0m15:46:40.706272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab63e6e-81f9-44f0-89a7-10bc83f9e8cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715095b00500>]}
[0m15:46:40.707378 [debug] [MainThread]: On master: ROLLBACK
[0m15:46:40.708412 [debug] [MainThread]: On master: COMMIT
[0m15:46:40.709242 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:40.709870 [debug] [MainThread]: On master: COMMIT
[0m15:46:40.710890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:46:40.711563 [debug] [MainThread]: On master: Close
[0m15:46:40.718943 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:46:40.719993 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:46:40.720619 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:46:40.721247 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m15:46:40.721981 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:46:40.722550 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m15:46:40.723390 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m15:46:40.724242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m15:46:40.725101 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m15:46:40.725980 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m15:46:40.726890 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m15:46:40.727734 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:46:40.728824 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m15:46:40.729681 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:46:40.730480 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:46:40.747511 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:46:40.755179 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:46:40.763171 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:46:40.772591 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:46:40.777874 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:46:40.788552 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:46:40.801389 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:46:40.802275 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:46:40.821995 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:46:40.824098 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:46:40.824754 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:46:40.827977 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:46:40.832454 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:46:40.839232 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:46:40.840492 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m15:46:40.841246 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:46:40.841896 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:46:40.842501 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:40.843367 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m15:46:40.844306 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:46:40.845042 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:46:40.846028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:40.846779 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:46:40.847691 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:46:40.855438 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:40.869259 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.027 seconds
[0m15:46:40.876148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m15:46:40.877113 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m15:46:40.877956 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m15:46:40.880157 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m15:46:40.882688 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m15:46:40.884135 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m15:46:40.885348 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m15:46:40.886600 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.031 seconds
[0m15:46:40.887284 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m15:46:40.888336 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.16s]
[0m15:46:40.891462 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.17s]
[0m15:46:40.893821 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m15:46:40.895341 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.17s]
[0m15:46:40.896426 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:46:40.897683 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:46:40.899191 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:46:40.899824 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m15:46:40.903458 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.18s]
[0m15:46:40.904757 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:46:40.907858 [debug] [MainThread]: On master: COMMIT
[0m15:46:40.908591 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:40.909207 [debug] [MainThread]: On master: COMMIT
[0m15:46:40.909790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:40.924012 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:46:40.925024 [debug] [MainThread]: On master: Close
[0m15:46:40.926434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:40.927193 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m15:46:40.927794 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m15:46:40.928356 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m15:46:40.929279 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m15:46:40.930080 [info ] [MainThread]: 
[0m15:46:40.930836 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:46:40.933018 [debug] [MainThread]: Command end result
[0m15:46:40.991660 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:46:41.013446 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:46:41.158756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:46:41.159817 [info ] [MainThread]: 
[0m15:46:41.161684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:41.164593 [info ] [MainThread]: 
[0m15:46:41.173972 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:46:41.178136 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6191547, "process_in_blocks": "0", "process_kernel_time": 0.932583, "process_mem_max_rss": "158228", "process_out_blocks": "0", "process_user_time": 7.542118}
[0m15:46:41.179328 [debug] [MainThread]: Command `dbt test` succeeded at 15:46:41.179135 after 2.62 seconds
[0m15:46:41.180744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71509624cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715092c87c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715092c87fb0>]}
[0m15:46:41.181861 [debug] [MainThread]: Flushing usage events
[0m15:46:42.081277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:08.743777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee758da360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee74573a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee7514c830>]}


============================== 15:55:08.810308 | e1776053-da00-4781-8543-5a614ef9526a ==============================
[0m15:55:08.810308 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:55:08.811331 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'empty': 'None'}
[0m15:55:09.048235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1776053-da00-4781-8543-5a614ef9526a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee76ca72c0>]}
[0m15:55:09.115623 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:55:09.122564 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:55:09.124852 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.51315093, "process_in_blocks": "1560", "process_kernel_time": 0.566701, "process_mem_max_rss": "121800", "process_out_blocks": "0", "process_user_time": 5.092332}
[0m15:55:09.125713 [debug] [MainThread]: Command `dbt deps` succeeded at 15:55:09.125552 after 0.51 seconds
[0m15:55:09.126418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee74d2eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee74e76480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee73ce3e60>]}
[0m15:55:09.127139 [debug] [MainThread]: Flushing usage events
[0m15:55:09.832724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:15.476914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731212e896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312123bffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312131dc170>]}


============================== 15:55:15.544420 | 8d6a9137-ee62-43aa-942c-f3b9cc2ffcfc ==============================
[0m15:55:15.544420 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:55:15.545681 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': '/app/dbt/logs', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m15:55:15.598733 [info ] [MainThread]: dbt version: 1.10.19
[0m15:55:15.599703 [info ] [MainThread]: python version: 3.12.12
[0m15:55:15.600767 [info ] [MainThread]: python path: /usr/local/bin/python
[0m15:55:15.601570 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m15:55:15.708635 [info ] [MainThread]: Using profiles dir at /app/dbt
[0m15:55:15.709652 [info ] [MainThread]: Using profiles.yml file at /app/dbt/profiles.yml
[0m15:55:15.710429 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m15:55:15.711629 [info ] [MainThread]: adapter type: postgres
[0m15:55:15.712459 [info ] [MainThread]: adapter version: 1.10.0
[0m15:55:15.896976 [info ] [MainThread]: Configuration:
[0m15:55:15.898035 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:55:15.898818 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:55:15.899620 [info ] [MainThread]: Required dependencies:
[0m15:55:15.900496 [debug] [MainThread]: Executing "git --help"
[0m15:55:15.919520 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:55:15.920636 [debug] [MainThread]: STDERR: "b''"
[0m15:55:15.921298 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:55:15.922008 [info ] [MainThread]: Connection:
[0m15:55:15.922742 [info ] [MainThread]:   host: db
[0m15:55:15.923468 [info ] [MainThread]:   port: 5432
[0m15:55:15.924225 [info ] [MainThread]:   user: postgres
[0m15:55:15.924991 [info ] [MainThread]:   database: spacex_db
[0m15:55:15.925824 [info ] [MainThread]:   schema: analytics
[0m15:55:15.926507 [info ] [MainThread]:   connect_timeout: 10
[0m15:55:15.927192 [info ] [MainThread]:   role: None
[0m15:55:15.927873 [info ] [MainThread]:   search_path: None
[0m15:55:15.928648 [info ] [MainThread]:   keepalives_idle: 0
[0m15:55:15.929351 [info ] [MainThread]:   sslmode: None
[0m15:55:15.930032 [info ] [MainThread]:   sslcert: None
[0m15:55:15.930729 [info ] [MainThread]:   sslkey: None
[0m15:55:15.931408 [info ] [MainThread]:   sslrootcert: None
[0m15:55:15.932187 [info ] [MainThread]:   application_name: dbt
[0m15:55:15.932883 [info ] [MainThread]:   retries: 1
[0m15:55:15.933773 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:55:16.081917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:55:16.157515 [debug] [MainThread]: Using postgres connection "debug"
[0m15:55:16.158398 [debug] [MainThread]: On debug: select 1 as id
[0m15:55:16.159070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:16.178439 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m15:55:16.180093 [debug] [MainThread]: On debug: Close
[0m15:55:16.180839 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:55:16.181714 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:55:16.183894 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8252656, "process_in_blocks": "64", "process_kernel_time": 0.607093, "process_mem_max_rss": "121472", "process_out_blocks": "0", "process_user_time": 5.220204}
[0m15:55:16.184781 [debug] [MainThread]: Command `dbt debug` succeeded at 15:55:16.184627 after 0.83 seconds
[0m15:55:16.185420 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:55:16.186068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731212cf70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312115c3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731212ddda30>]}
[0m15:55:16.186826 [debug] [MainThread]: Flushing usage events
[0m15:55:16.823200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:22.649462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bfe901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bfc9eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bfe903e0>]}


============================== 15:55:22.715288 | 0cdaa663-9f44-4836-b048-d1d8f49c67b2 ==============================
[0m15:55:22.715288 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:55:22.716381 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m15:55:23.031359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bf3a3890>]}
[0m15:55:23.153458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bfc09d00>]}
[0m15:55:23.154971 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:55:23.320394 [debug] [MainThread]: checksum: c35ba6d374a0901ceb00688d5179d5550885e1756283b03e5e81c28e0d8d2248, vars: {}, profile: , target: , version: 1.10.19
[0m15:55:23.603597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:23.604401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:23.613191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m15:55:23.671528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bed244a0>]}
[0m15:55:23.807695 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:55:23.814162 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:55:23.902268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207be167e30>]}
[0m15:55:23.903117 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m15:55:23.903834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207be18c530>]}
[0m15:55:23.906682 [info ] [MainThread]: 
[0m15:55:23.907404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:23.908106 [info ] [MainThread]: 
[0m15:55:23.909068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:23.915288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db'
[0m15:55:23.999811 [debug] [ThreadPool]: Using postgres connection "list_spacex_db"
[0m15:55:24.000831 [debug] [ThreadPool]: On list_spacex_db: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db"} */

    select distinct nspname from pg_namespace
  
[0m15:55:24.001673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:24.023553 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m15:55:24.025736 [debug] [ThreadPool]: On list_spacex_db: Close
[0m15:55:24.028600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_spacex_db, now list_spacex_db_analytics)
[0m15:55:24.037368 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m15:55:24.038663 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:55:24.039786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:24.067295 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m15:55:24.069605 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m15:55:24.070608 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m15:55:24.078384 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:24.079449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:55:24.080495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:24.109555 [debug] [MainThread]: SQL status: SELECT 6 in 0.029 seconds
[0m15:55:24.112667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207be18ee70>]}
[0m15:55:24.113824 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:24.115036 [debug] [MainThread]: On master: COMMIT
[0m15:55:24.115853 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:24.116625 [debug] [MainThread]: On master: COMMIT
[0m15:55:24.117769 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:24.118470 [debug] [MainThread]: On master: Close
[0m15:55:24.126400 [debug] [Thread-1 (]: Began running node model.spacex_analytics.stg_launches
[0m15:55:24.127530 [debug] [Thread-2 (]: Began running node model.spacex_analytics.stg_rockets
[0m15:55:24.128498 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_launches ............................. [RUN]
[0m15:55:24.129831 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics.stg_rockets .............................. [RUN]
[0m15:55:24.131152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now model.spacex_analytics.stg_launches)
[0m15:55:24.132220 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.spacex_analytics.stg_rockets'
[0m15:55:24.133354 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.stg_launches
[0m15:55:24.134269 [debug] [Thread-2 (]: Began compiling node model.spacex_analytics.stg_rockets
[0m15:55:24.149906 [debug] [Thread-2 (]: Writing injected SQL for node "model.spacex_analytics.stg_rockets"
[0m15:55:24.150553 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.stg_launches"
[0m15:55:24.157966 [debug] [Thread-2 (]: Began executing node model.spacex_analytics.stg_rockets
[0m15:55:24.164347 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.stg_launches
[0m15:55:24.249625 [debug] [Thread-2 (]: Writing runtime sql for node "model.spacex_analytics.stg_rockets"
[0m15:55:24.248788 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.stg_launches"
[0m15:55:24.260157 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:55:24.261153 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */

  create view "spacex_db"."analytics"."stg_rockets__dbt_tmp"
    
    
  as (
    

SELECT
    rocket_id::text AS rocket_id,
    name AS rocket_name,
    active,
    cost_per_launch,
    success_rate_pct / 100.0 AS success_rate_decimal
FROM "spacex_db"."public"."silver_rockets"
  );
[0m15:55:24.261786 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:55:24.262350 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:55:24.263205 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */

  create view "spacex_db"."analytics"."stg_launches__dbt_tmp"
    
    
  as (
    

SELECT
    launch_id::text AS launch_id,
    name AS launch_name,
    date_utc,
    success AS is_success,
    rocket::text AS rocket_id
FROM "spacex_db"."public"."silver_launches"
  );
[0m15:55:24.264638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:24.289753 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m15:55:24.290543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m15:55:24.306276 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:55:24.299447 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:55:24.307390 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches" rename to "stg_launches__dbt_backup"
[0m15:55:24.308521 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets" rename to "stg_rockets__dbt_backup"
[0m15:55:24.311120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:55:24.311740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:55:24.315977 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:55:24.320256 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:55:24.321066 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
alter table "spacex_db"."analytics"."stg_launches__dbt_tmp" rename to "stg_launches"
[0m15:55:24.322066 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
alter table "spacex_db"."analytics"."stg_rockets__dbt_tmp" rename to "stg_rockets"
[0m15:55:24.323866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.324518 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.354483 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m15:55:24.355350 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m15:55:24.355916 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:55:24.356909 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:55:24.357806 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: COMMIT
[0m15:55:24.358654 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: COMMIT
[0m15:55:24.361996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:24.368599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m15:55:24.372588 [debug] [Thread-2 (]: Applying DROP to: "spacex_db"."analytics"."stg_rockets__dbt_backup"
[0m15:55:24.375760 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."stg_launches__dbt_backup"
[0m15:55:24.384856 [debug] [Thread-2 (]: Using postgres connection "model.spacex_analytics.stg_rockets"
[0m15:55:24.385858 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.stg_launches"
[0m15:55:24.386895 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_rockets"} */
drop view if exists "spacex_db"."analytics"."stg_rockets__dbt_backup" cascade
[0m15:55:24.387779 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.stg_launches"} */
drop view if exists "spacex_db"."analytics"."stg_launches__dbt_backup" cascade
[0m15:55:24.397879 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:55:24.399004 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m15:55:24.402502 [debug] [Thread-1 (]: On model.spacex_analytics.stg_launches: Close
[0m15:55:24.404954 [debug] [Thread-2 (]: On model.spacex_analytics.stg_rockets: Close
[0m15:55:24.408532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bd137920>]}
[0m15:55:24.409148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bcd10080>]}
[0m15:55:24.410152 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_launches ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m15:55:24.411456 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics.stg_rockets ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m15:55:24.412739 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.stg_launches
[0m15:55:24.413897 [debug] [Thread-2 (]: Finished running node model.spacex_analytics.stg_rockets
[0m15:55:24.416364 [debug] [Thread-4 (]: Began running node model.spacex_analytics.dim_rockets
[0m15:55:24.417337 [info ] [Thread-4 (]: 3 of 5 START sql table model analytics.dim_rockets ............................. [RUN]
[0m15:55:24.418337 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.spacex_analytics.dim_rockets'
[0m15:55:24.419076 [debug] [Thread-4 (]: Began compiling node model.spacex_analytics.dim_rockets
[0m15:55:24.423476 [debug] [Thread-4 (]: Writing injected SQL for node "model.spacex_analytics.dim_rockets"
[0m15:55:24.433922 [debug] [Thread-4 (]: Began executing node model.spacex_analytics.dim_rockets
[0m15:55:24.468370 [debug] [Thread-4 (]: Writing runtime sql for node "model.spacex_analytics.dim_rockets"
[0m15:55:24.480092 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:55:24.480939 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */

  
    

  create  table "spacex_db"."analytics"."dim_rockets__dbt_tmp"
  
  
    as
  
  (
    

SELECT DISTINCT
    rocket_id,
    rocket_name,
    cost_per_launch
FROM "spacex_db"."analytics"."stg_rockets"
  );
  
[0m15:55:24.481715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:55:24.510627 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.029 seconds
[0m15:55:24.519968 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:55:24.520941 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets" rename to "dim_rockets__dbt_backup"
[0m15:55:24.522756 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.527621 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:55:24.528546 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
alter table "spacex_db"."analytics"."dim_rockets__dbt_tmp" rename to "dim_rockets"
[0m15:55:24.530098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.532419 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m15:55:24.533223 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:55:24.534050 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: COMMIT
[0m15:55:24.536654 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:24.540358 [debug] [Thread-4 (]: Applying DROP to: "spacex_db"."analytics"."dim_rockets__dbt_backup"
[0m15:55:24.545279 [debug] [Thread-4 (]: Using postgres connection "model.spacex_analytics.dim_rockets"
[0m15:55:24.546115 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.dim_rockets"} */
drop table if exists "spacex_db"."analytics"."dim_rockets__dbt_backup" cascade
[0m15:55:24.557667 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m15:55:24.560261 [debug] [Thread-4 (]: On model.spacex_analytics.dim_rockets: Close
[0m15:55:24.561363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bcd5b170>]}
[0m15:55:24.564745 [info ] [Thread-4 (]: 3 of 5 OK created sql table model analytics.dim_rockets ........................ [[32mSELECT 0[0m in 0.14s]
[0m15:55:24.566036 [debug] [Thread-4 (]: Finished running node model.spacex_analytics.dim_rockets
[0m15:55:24.567631 [debug] [Thread-1 (]: Began running node model.spacex_analytics.fct_launches
[0m15:55:24.568649 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.fct_launches ............................ [RUN]
[0m15:55:24.569550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.spacex_analytics.stg_launches, now model.spacex_analytics.fct_launches)
[0m15:55:24.570364 [debug] [Thread-1 (]: Began compiling node model.spacex_analytics.fct_launches
[0m15:55:24.575424 [debug] [Thread-1 (]: Writing injected SQL for node "model.spacex_analytics.fct_launches"
[0m15:55:24.584275 [debug] [Thread-1 (]: Began executing node model.spacex_analytics.fct_launches
[0m15:55:24.589192 [debug] [Thread-1 (]: Writing runtime sql for node "model.spacex_analytics.fct_launches"
[0m15:55:24.597520 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:55:24.598301 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */

  
    

  create  table "spacex_db"."analytics"."fct_launches__dbt_tmp"
  
  
    as
  
  (
    

WITH launches AS (
    SELECT * FROM "spacex_db"."analytics"."stg_launches"
),
rockets AS (
    SELECT * FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    l.launch_id,
    l.launch_name,
    l.date_utc,
    l.is_success,
    r.rocket_id,
    r.cost_per_launch,
    CASE 
        WHEN l.is_success = TRUE THEN r.cost_per_launch 
        ELSE 0 
    END AS cost_of_success
FROM launches l
LEFT JOIN rockets r
    ON l.rocket_id = r.rocket_id
  );
  
[0m15:55:24.599005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:24.629579 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.030 seconds
[0m15:55:24.634658 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:55:24.635872 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches" rename to "fct_launches__dbt_backup"
[0m15:55:24.637971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.642806 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:55:24.644241 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
alter table "spacex_db"."analytics"."fct_launches__dbt_tmp" rename to "fct_launches"
[0m15:55:24.646299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.649035 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m15:55:24.650078 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:55:24.651037 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: COMMIT
[0m15:55:24.654754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:55:24.658369 [debug] [Thread-1 (]: Applying DROP to: "spacex_db"."analytics"."fct_launches__dbt_backup"
[0m15:55:24.659877 [debug] [Thread-1 (]: Using postgres connection "model.spacex_analytics.fct_launches"
[0m15:55:24.660914 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.fct_launches"} */
drop table if exists "spacex_db"."analytics"."fct_launches__dbt_backup" cascade
[0m15:55:24.667923 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:55:24.670330 [debug] [Thread-1 (]: On model.spacex_analytics.fct_launches: Close
[0m15:55:24.671496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bd10c470>]}
[0m15:55:24.672681 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.fct_launches ....................... [[32mSELECT 0[0m in 0.10s]
[0m15:55:24.673911 [debug] [Thread-1 (]: Finished running node model.spacex_analytics.fct_launches
[0m15:55:24.675810 [debug] [Thread-3 (]: Began running node model.spacex_analytics.gold_rocket_performance
[0m15:55:24.676978 [info ] [Thread-3 (]: 5 of 5 START sql view model analytics.gold_rocket_performance .................. [RUN]
[0m15:55:24.678147 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.spacex_analytics.gold_rocket_performance'
[0m15:55:24.679031 [debug] [Thread-3 (]: Began compiling node model.spacex_analytics.gold_rocket_performance
[0m15:55:24.684084 [debug] [Thread-3 (]: Writing injected SQL for node "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.692617 [debug] [Thread-3 (]: Began executing node model.spacex_analytics.gold_rocket_performance
[0m15:55:24.699070 [debug] [Thread-3 (]: Writing runtime sql for node "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.707040 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.707822 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */

  create view "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp"
    
    
  as (
    

WITH launches AS (
    SELECT * 
    FROM "spacex_db"."analytics"."fct_launches"
),
rockets AS (
    SELECT * 
    FROM "spacex_db"."analytics"."dim_rockets"
)

SELECT
    r.rocket_id,
    r.rocket_name,
    COUNT(l.launch_id) AS total_launches,
    COUNT(CASE WHEN l.is_success = TRUE THEN 1 END) AS successful_launches,
    SUM(l.cost_per_launch) AS total_cost,
    SUM(l.cost_of_success) AS total_cost_success,
    ROUND(
        CASE WHEN COUNT(l.launch_id) > 0 
            THEN COUNT(CASE WHEN l.is_success = TRUE THEN 1 END)::numeric / COUNT(l.launch_id)
            ELSE 0
        END, 2
    ) AS success_rate
FROM rockets r
LEFT JOIN launches l
    ON r.rocket_id = l.rocket_id
GROUP BY r.rocket_id, r.rocket_name
ORDER BY total_launches DESC
  );
[0m15:55:24.708692 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:55:24.738133 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m15:55:24.743154 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.744099 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
alter table "spacex_db"."analytics"."gold_rocket_performance__dbt_tmp" rename to "gold_rocket_performance"
[0m15:55:24.745994 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:55:24.748005 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m15:55:24.748826 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.749588 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: COMMIT
[0m15:55:24.752016 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:55:24.755509 [debug] [Thread-3 (]: Applying DROP to: "spacex_db"."analytics"."gold_rocket_performance__dbt_backup"
[0m15:55:24.756781 [debug] [Thread-3 (]: Using postgres connection "model.spacex_analytics.gold_rocket_performance"
[0m15:55:24.757600 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "model.spacex_analytics.gold_rocket_performance"} */
drop view if exists "spacex_db"."analytics"."gold_rocket_performance__dbt_backup" cascade
[0m15:55:24.758875 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:55:24.760953 [debug] [Thread-3 (]: On model.spacex_analytics.gold_rocket_performance: Close
[0m15:55:24.762040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cdaa663-9f44-4836-b048-d1d8f49c67b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bcdbe3f0>]}
[0m15:55:24.763221 [info ] [Thread-3 (]: 5 of 5 OK created sql view model analytics.gold_rocket_performance ............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:55:24.764549 [debug] [Thread-3 (]: Finished running node model.spacex_analytics.gold_rocket_performance
[0m15:55:24.767264 [debug] [MainThread]: On master: COMMIT
[0m15:55:24.767985 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:24.768704 [debug] [MainThread]: On master: COMMIT
[0m15:55:24.769327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:24.783157 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:55:24.784164 [debug] [MainThread]: On master: Close
[0m15:55:24.785392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:24.786180 [debug] [MainThread]: Connection 'model.spacex_analytics.fct_launches' was properly closed.
[0m15:55:24.786984 [debug] [MainThread]: Connection 'model.spacex_analytics.stg_rockets' was properly closed.
[0m15:55:24.787860 [debug] [MainThread]: Connection 'model.spacex_analytics.dim_rockets' was properly closed.
[0m15:55:24.788612 [debug] [MainThread]: Connection 'model.spacex_analytics.gold_rocket_performance' was properly closed.
[0m15:55:24.789455 [info ] [MainThread]: 
[0m15:55:24.790231 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m15:55:24.792620 [debug] [MainThread]: Command end result
[0m15:55:24.837321 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:55:24.843920 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:55:24.856047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:55:24.856749 [info ] [MainThread]: 
[0m15:55:24.857495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:24.858144 [info ] [MainThread]: 
[0m15:55:24.858834 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:55:24.860780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3259134, "process_in_blocks": "80", "process_kernel_time": 0.690584, "process_mem_max_rss": "130140", "process_out_blocks": "0", "process_user_time": 6.360649}
[0m15:55:24.861696 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:24.861523 after 2.33 seconds
[0m15:55:24.862400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207c00eb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bfb422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7207bef9b740>]}
[0m15:55:24.863074 [debug] [MainThread]: Flushing usage events
[0m15:55:25.542568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:31.564300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c71e0ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c72436180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c71e0c710>]}


============================== 15:55:31.631658 | b0801224-5fa6-40db-82ed-f3444e772917 ==============================
[0m15:55:31.631658 [info ] [MainThread]: Running with dbt=1.10.19
[0m15:55:31.632762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'quiet': 'False', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'warn_error': 'None'}
[0m15:55:31.977785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c7161c410>]}
[0m15:55:32.095569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c72979be0>]}
[0m15:55:32.097266 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m15:55:32.264024 [debug] [MainThread]: checksum: c35ba6d374a0901ceb00688d5179d5550885e1756283b03e5e81c28e0d8d2248, vars: {}, profile: , target: , version: 1.10.19
[0m15:55:32.550397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:32.551392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:32.559121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spacex_analytics.marts
[0m15:55:32.618204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c71522720>]}
[0m15:55:32.759536 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:55:32.766873 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:55:33.032280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c70795910>]}
[0m15:55:33.033224 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 464 macros
[0m15:55:33.033982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c707d49e0>]}
[0m15:55:33.036866 [info ] [MainThread]: 
[0m15:55:33.037798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:33.038559 [info ] [MainThread]: 
[0m15:55:33.039510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:33.045497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_spacex_db_analytics'
[0m15:55:33.125739 [debug] [ThreadPool]: Using postgres connection "list_spacex_db_analytics"
[0m15:55:33.126846 [debug] [ThreadPool]: On list_spacex_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "list_spacex_db_analytics"} */
select
      'spacex_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'spacex_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m15:55:33.127650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:33.154953 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m15:55:33.157309 [debug] [ThreadPool]: On list_spacex_db_analytics: ROLLBACK
[0m15:55:33.158622 [debug] [ThreadPool]: On list_spacex_db_analytics: Close
[0m15:55:33.166714 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:33.167816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:55:33.168677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:33.196619 [debug] [MainThread]: SQL status: SELECT 6 in 0.028 seconds
[0m15:55:33.199619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0801224-5fa6-40db-82ed-f3444e772917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c707d7bc0>]}
[0m15:55:33.200721 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:33.202059 [debug] [MainThread]: On master: COMMIT
[0m15:55:33.202879 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:33.203660 [debug] [MainThread]: On master: COMMIT
[0m15:55:33.204850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:33.205575 [debug] [MainThread]: On master: Close
[0m15:55:33.212428 [debug] [Thread-1 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:55:33.213212 [debug] [Thread-2 (]: Began running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:55:33.213845 [debug] [Thread-3 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:55:33.214982 [debug] [Thread-4 (]: Began running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:55:33.214459 [info ] [Thread-1 (]: 1 of 4 START test source_not_null_spacex_raw_silver_launches_launch_id ......... [RUN]
[0m15:55:33.215900 [info ] [Thread-2 (]: 2 of 4 START test source_not_null_spacex_raw_silver_rockets_rocket_id .......... [RUN]
[0m15:55:33.216914 [info ] [Thread-3 (]: 3 of 4 START test source_unique_spacex_raw_silver_launches_launch_id ........... [RUN]
[0m15:55:33.217783 [info ] [Thread-4 (]: 4 of 4 START test source_unique_spacex_raw_silver_rockets_rocket_id ............ [RUN]
[0m15:55:33.218695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_spacex_db_analytics, now test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187)
[0m15:55:33.219608 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52'
[0m15:55:33.220570 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680'
[0m15:55:33.221702 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c'
[0m15:55:33.222535 [debug] [Thread-1 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:55:33.223308 [debug] [Thread-2 (]: Began compiling node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:55:33.224085 [debug] [Thread-3 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:55:33.224910 [debug] [Thread-4 (]: Began compiling node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:55:33.261293 [debug] [Thread-2 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:55:33.267794 [debug] [Thread-1 (]: Writing injected SQL for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:55:33.272307 [debug] [Thread-3 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:55:33.277791 [debug] [Thread-4 (]: Writing injected SQL for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:55:33.285656 [debug] [Thread-2 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:55:33.286434 [debug] [Thread-1 (]: Began executing node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:55:33.292288 [debug] [Thread-3 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:55:33.324397 [debug] [Thread-4 (]: Began executing node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:55:33.335161 [debug] [Thread-3 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:55:33.338446 [debug] [Thread-4 (]: Writing runtime sql for node "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:55:33.340915 [debug] [Thread-2 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:55:33.342101 [debug] [Thread-1 (]: Writing runtime sql for node "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:55:33.350180 [debug] [Thread-3 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"
[0m15:55:33.350941 [debug] [Thread-4 (]: Using postgres connection "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"
[0m15:55:33.351659 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    launch_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_launches"
where launch_id is not null
group by launch_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:55:33.352877 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rocket_id as unique_field,
    count(*) as n_records

from "spacex_db"."public"."silver_rockets"
where rocket_id is not null
group by rocket_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:55:33.353590 [debug] [Thread-2 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"
[0m15:55:33.354285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:55:33.355046 [debug] [Thread-1 (]: Using postgres connection "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"
[0m15:55:33.355597 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:55:33.356427 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rocket_id
from "spacex_db"."public"."silver_rockets"
where rocket_id is null



  
  
      
    ) dbt_internal_test
[0m15:55:33.358190 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: /* {"app": "dbt", "dbt_version": "1.10.19", "profile_name": "spacex_profile", "target_name": "dev", "node_id": "test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select launch_id
from "spacex_db"."public"."silver_launches"
where launch_id is null



  
  
      
    ) dbt_internal_test
[0m15:55:33.359843 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:55:33.360986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:33.379621 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:55:33.380444 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:55:33.381079 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:55:33.387413 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: ROLLBACK
[0m15:55:33.389512 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: ROLLBACK
[0m15:55:33.391809 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: ROLLBACK
[0m15:55:33.392531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m15:55:33.393489 [debug] [Thread-3 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680: Close
[0m15:55:33.394372 [debug] [Thread-4 (]: On test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c: Close
[0m15:55:33.395140 [debug] [Thread-2 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52: Close
[0m15:55:33.402190 [info ] [Thread-4 (]: 4 of 4 PASS source_unique_spacex_raw_silver_rockets_rocket_id .................. [[32mPASS[0m in 0.18s]
[0m15:55:33.398362 [info ] [Thread-3 (]: 3 of 4 PASS source_unique_spacex_raw_silver_launches_launch_id ................. [[32mPASS[0m in 0.18s]
[0m15:55:33.403263 [info ] [Thread-2 (]: 2 of 4 PASS source_not_null_spacex_raw_silver_rockets_rocket_id ................ [[32mPASS[0m in 0.18s]
[0m15:55:33.404274 [debug] [Thread-4 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c
[0m15:55:33.397079 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: ROLLBACK
[0m15:55:33.405520 [debug] [Thread-3 (]: Finished running node test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680
[0m15:55:33.406720 [debug] [Thread-2 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52
[0m15:55:33.408453 [debug] [Thread-1 (]: On test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187: Close
[0m15:55:33.410674 [info ] [Thread-1 (]: 1 of 4 PASS source_not_null_spacex_raw_silver_launches_launch_id ............... [[32mPASS[0m in 0.19s]
[0m15:55:33.412198 [debug] [Thread-1 (]: Finished running node test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187
[0m15:55:33.415185 [debug] [MainThread]: On master: COMMIT
[0m15:55:33.415930 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:33.416548 [debug] [MainThread]: On master: COMMIT
[0m15:55:33.417150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:33.431099 [debug] [MainThread]: SQL status: COMMIT in 0.014 seconds
[0m15:55:33.433115 [debug] [MainThread]: On master: Close
[0m15:55:33.434156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:33.434932 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_launches_launch_id.f1cbe10187' was properly closed.
[0m15:55:33.435595 [debug] [MainThread]: Connection 'test.spacex_analytics.source_not_null_spacex_raw_silver_rockets_rocket_id.bc86f1cf52' was properly closed.
[0m15:55:33.436179 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_launches_launch_id.6371c99680' was properly closed.
[0m15:55:33.436745 [debug] [MainThread]: Connection 'test.spacex_analytics.source_unique_spacex_raw_silver_rockets_rocket_id.923544ec4c' was properly closed.
[0m15:55:33.437419 [info ] [MainThread]: 
[0m15:55:33.438143 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:55:33.440052 [debug] [MainThread]: Command end result
[0m15:55:33.487711 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:55:33.494650 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:55:33.509559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:55:33.510338 [info ] [MainThread]: 
[0m15:55:33.511130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:33.511949 [info ] [MainThread]: 
[0m15:55:33.512853 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:55:33.515383 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0702477, "process_in_blocks": "0", "process_kernel_time": 0.790213, "process_mem_max_rss": "158660", "process_out_blocks": "0", "process_user_time": 6.409953}
[0m15:55:33.517433 [debug] [MainThread]: Command `dbt test` succeeded at 15:55:33.517183 after 2.07 seconds
[0m15:55:33.518500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c71d997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c7299ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c6e88ab40>]}
[0m15:55:33.519541 [debug] [MainThread]: Flushing usage events
[0m15:55:34.165871 [debug] [MainThread]: An error was encountered while trying to flush usage events
